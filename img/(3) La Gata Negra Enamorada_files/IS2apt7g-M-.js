/*!CK:3622162003!*//*1427086848,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["26\/L8"]); }

__d("BlackbirdUpsellConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={ACTION_EDUCATE:"educate",ACTION_UPSELL:"upsell",CLICK_TYPE_DISMISS_PROMO:"dismiss_promo",CLICK_TYPE_ENABLE_CHAT:"enable_chat",CLICK_TYPE_OPEN_SETTINGS:"open_settings"};},null);
__d("GenderConst",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={NOT_A_PERSON:0,FEMALE_SINGULAR:1,MALE_SINGULAR:2,FEMALE_SINGULAR_GUESS:3,MALE_SINGULAR_GUESS:4,MIXED_SINGULAR:5,MIXED_PLURAL:5,NEUTER_SINGULAR:6,UNKNOWN_SINGULAR:7,FEMALE_PLURAL:8,MALE_PLURAL:9,NEUTER_PLURAL:10,UNKNOWN_PLURAL:11,UNKNOWN:0};},null);
__d("P2PTransferRiskResult",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={SUCCESS:"SUCCESS",UNDER_MANUAL_REVIEW:"UNDER_MANUAL_REVIEW",REQUIRE_VERIFICATION:"REQUIRE_VERIFICATION"};},null);
__d("BlackbirdUpsell",["Event","Arbiter","AsyncRequest","LegacyContextualDialog","DOM","LayerDestroyOnHide","LayerHideOnTransition","PresencePrivacy","copyProperties","BlackbirdUpsellConfig","BlackbirdUpsellConstants","BlackbirdUpsellTemplates"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();var s='/ajax/chat/blackbird/update_clicks.php',t='/ajax/chat/blackbird/update_impressions.php',u='/ajax/chat/blackbird/dismiss.php',v=235,w=null,x=null,y=false,z=false;function aa(){}o(aa,{shouldShow:function(){if(this._dialogDismissed)return false;if(this.isEducation()){return !p.EducationDismissed&&p.EducationImpressions<p.EducationImpressionLimit;}else return !!p.UpsellGK&&!p.UpsellDismissed&&p.UpsellImpressions<p.UpsellImpressionLimit&&p.FriendCount>=p.UpsellMinFriendCount;},isEducation:function(){return p.TimeOffline<=p.EducationTimeOfflineThresdhold;},getOfflineContent:function(){if(this.isEducation()){return this._getEducationContent();}else return this._getUpsellContent();},_getEducationContent:function(){ga();var ka=r[':fb:chat:blackbird:offline-educate'].build(),la=ka.getNode('chatSettingsButton');g.listen(la,'click',function(){h.inform('chat/advanced-settings-dialog-opened');ja(q.CLICK_TYPE_OPEN_SETTINGS);da();});return ka.getRoot();},_getUpsellContent:function(){fa();var ka=r[':fb:chat:blackbird:upsell'].build(),la=ka.getNode('chatSettingsButton');g.listen(la,'click',function(){h.inform('chat/advanced-settings-dialog-opened');ia(q.CLICK_TYPE_OPEN_SETTINGS);ca();});var ma=ka.getNode('enableChatButton');g.listen(ma,'click',function(){ia(q.CLICK_TYPE_ENABLE_CHAT);ca();});return ka.getRoot();},getBlackbirdContent:function(ka){ga();switch(ka){case n.ONLINE:return r[':fb:chat:blackbird:most-friends-educate'].build().getRoot();case n.OFFLINE:return r[':fb:chat:blackbird:some-friends-educate'].build().getRoot();}},showOfflineDialog:function(ka){this.showDialog(ka,this.getOfflineContent.bind(this));},showBlackbirdDialog:function(ka,la){this.showDialog(ka,this.getBlackbirdContent.bind(null,la));},showDialog:function(ka,la){!w&&this._constructDialog();k.setContent(x,la());w.setContext(ka);w.show();},hide:function(){if(w&&w.isShown())w.hide();},dismiss:function(){this.hide();if(this.isEducation()){da();}else ca();},registerDismissClick:function(){if(this.isEducation()){ja(q.CLICK_TYPE_DISMISS_PROMO);}else ia(q.CLICK_TYPE_DISMISS_PROMO);},isVisible:function(){return z&&!y;},_constructDialog:function(){var ka=r[':fb:chat:blackbird:dialog-frame'].build();x=ka.getNode('dialogContent');w=new j();w.init(ka.getRoot());w.setPosition('above').setWidth(v).setFixed(true).disableBehavior(l).disableBehavior(m);g.listen(ka.getNode('dialogCloseButton'),'click',this.dismiss.bind(this));g.listen(ka.getNode('dialogCloseButton'),'click',this.registerDismissClick.bind(this));}});function ba(ka,la){if(!y&&z){y=true;n.inform('privacy-user-presence-changed');var ma=new i(u);ma.setData({source:ka,impressions:la,time_offline:p.TimeOffline});ma.setErrorHandler(function(){y=false;});ma.send();}}function ca(){ba(q.ACTION_UPSELL,p.UpsellImpressions);}function da(){ba(q.ACTION_EDUCATE,p.EducationImpressions);}function ea(ka,la){if(!z){z=true;var ma=new i(t);ma.setData({action:ka,impressions:la,time_offline:p.TimeOffline});ma.setErrorHandler(function(){z=false;});ma.send();}}function fa(){ea(q.ACTION_UPSELL,p.UpsellImpressions);}function ga(){ea(q.ACTION_EDUCATE,p.EducationImpressions);}function ha(ka,la,ma,na){var oa=new i(s);oa.setData({action:ka,impressions:ma,source:la,time_offline:na});oa.send();}function ia(ka){ha(ka,q.ACTION_UPSELL,p.UpsellImpressions,p.TimeOffline);}function ja(ka){ha(ka,q.ACTION_EDUCATE,p.EducateImpressions,p.TimeOffline);}h.subscribe('chat/advanced-settings-dialog-opened',aa.dismiss.bind(aa));h.subscribe('chat-visibility/go-online',aa.dismiss.bind(aa));h.subscribe('chat-visibility/go-offline',aa.dismiss.bind(aa));e.exports=aa;},null);
__d("Chat",["Arbiter"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h={buddyListNub:'buddylist-nub/initialized',sidebar:'sidebar/initialized'};function i(k,l){g.subscribe(h[k],function(event,m){l(m);});}var j={openBuddyList:function(){i('buddyListNub',function(k){k.show();i('sidebar',function(l){l.enable();});});},closeBuddyList:function(){i('buddyListNub',function(k){k.hide();});},toggleSidebar:function(){i('sidebar',function(k){k.toggle();});}};e.exports=j;},null);
__d("ChatQuietLinks",["Event","DOM","UserAgent_DEPRECATED","DataStore","Parent"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l={},m={silenceLinks:function(q){n(q,this.removeEmptyHrefs.bind(this));},nukeLinks:function(q){n(q,this.removeAllHrefs.bind(this));},removeEmptyHrefs:function(q){o(q,function(r){return !r||r==='#';});},removeAllHrefs:function(q){o(q);}};function n(q,r){var s=!!i.chrome(),t=!!i.chrome()||i.ie()>=9||i.firefox()>=4;if(l[h.getID(q)])return;l[h.getID(q)]=true;if(!t)return;if(!s){r&&r(q);return;}g.listen(q,'mouseover',function u(v){var w=k.byTag(v.getTarget(),'a');if(w){var x=w.getAttribute('href');if(p(x)){j.set(w,'stashedHref',w.getAttribute('href'));w.removeAttribute('href');}}});g.listen(q,'mouseout',function u(v){var w=k.byTag(v.getTarget(),'a'),x=w&&j.remove(w,'stashedHref');if(p(x))w.setAttribute('href',x);});g.listen(q,'mousedown',function(u){if(!u.isDefaultRequested())return true;var v=k.byTag(u.getTarget(),'a'),w=v&&j.get(v,'stashedHref');if(p(w))v.setAttribute('href',w);});}function o(q,r){var s=h.scry(q,'a');if(r)s=s.filter(function(t){return r(t.getAttribute('href'));});s.forEach(function(t){t.removeAttribute('href');t.setAttribute('tabindex',0);});}function p(q){return q&&q!=='#';}e.exports=m;},null);
__d("ChatSidebarComposeLink.react",["ChatOpenTab","React","TooltipLink.react","URI","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=h,m=l.PropTypes,n=h.createClass({displayName:"ChatSidebarComposeLink",propTypes:{className:m.string.isRequired},componentDidMount:function(){g.listenOpenEmptyTab(h.findDOMNode(this),'sidebar');},render:function(){var o=k._("Nuevo mensaje");return (h.createElement(i,{ajaxify:new j('/ajax/messaging/composer.php'),className:this.props.className,tooltip:o,rel:"dialog"}));}});e.exports=n;},null);
__d("ChatSidebarConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={LITESTAND_CLASSIC_SIZE:32,IMAGE_SIZE:28};Object.assign(g,{getImageSize:function(h){if(h===false)return g.IMAGE_SIZE;return g.LITESTAND_CLASSIC_SIZE;},getItemHeight:function(h){if(h===false)return g.IMAGE_SIZE+4;return g.LITESTAND_CLASSIC_SIZE+4;}});e.exports=g;},null);
__d("ChatBehavior",["Arbiter","AvailableList","AvailableListConstants","copyProperties","MercuryConstants"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=b('MercuryConstants').ChatNotificationConstants,l=false,m=h.getWebChatNotification(),n=l,o=true,p=j(new g(),{ON_CHANGED:'changed',notifiesUserMessages:function(){return m!==k.NO_USER_MESSAGE_NOTIFICATION;},ignoresRemoteTabRaise:function(){return n;},showsTabUnreadUI:function(){return o;}});function q(){p.inform(p.ON_CHANGED);}h.subscribe(i.ON_CHAT_NOTIFICATION_CHANGED,function(){var r=m,s=h.getWebChatNotification();m=s;if(r!=s)q();});g.subscribe('chat/set_does_page_occlude_tabs',function(r,s){n=!!s;q();});g.subscribe('chat/set_show_tab_unread_ui',function(r,s){o=!!s;q();});e.exports=p;},null);
__d("ChatSidebarSheet",["ArbiterMixin","BlackbirdUpsell","ChannelConnection","ChannelConstants","ChatBehavior","ChatConfig","ChatVisibility","CSS","DOM","Event","JSLogger","PresencePrivacy","copyProperties","fbt","mixin","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();var w=q.create('sidebar_sheet');function x(da){switch(da){case j.HINT_AUTH:return t._("Tu sesi\u00f3n expir\u00f3. Por favor inicia sesi\u00f3n de nuevo.");case j.HINT_CONN:return t._("El {Chat} de Facebook no est\u00e1 disponible por el momento.",[t.param("Chat",t._("Chat"))]);case j.HINT_MAINT:return t._("El {Chat} de Facebook no est\u00e1 disponible por mantenimiento.",[t.param("Chat",t._("Chat"))]);default:return t._("El {Chat} de Facebook no est\u00e1 disponible por el momento.",[t.param("Chat",t._("Chat"))]);}}function y(da){var ea;if(da===null||false===navigator.onLine){ea=t._("No es posible conectar con el chat. Comprueba tu conexi\u00f3n a Internet.");}else if(da>l.get('warning_countdown_threshold_msec')){var fa=o.create('a',{href:'#',className:'fbChatReconnectLink'},t._("Int\u00e9ntalo de nuevo"));ea=t._("No es posible conectar con el chat. {try-again-link}",[t.param("try-again-link",fa)]);}else if(da>1000){ea=t._("No es posible conectar con el chat. Nuevo intento de conexi\u00f3n en {seconds} segundos...",[t.param("seconds",Math.floor(da/1000))]);}else ea=t._("No es posible conectar con el chat. Volviendo a conectar...");return ea;}var z=u(g);for(var aa in z)if(z.hasOwnProperty(aa))ca[aa]=z[aa];var ba=z===null?null:z.prototype;ca.prototype=Object.create(ba);ca.prototype.constructor=ca;ca.__superConstructor__=z;function ca(da){"use strict";this._root=da;this._message=o.find(da,'div.fbChatSidebarMessage div.message');i.subscribe([i.CONNECTED,i.SHUTDOWN,i.RECONNECTING],this._handleConnectionChange.bind(this));i.subscribe([i.MUTE_WARNING,i.UNMUTE_WARNING],this._render.bind(this));r.subscribe('privacy-user-presence-changed',this._render.bind(this));k.subscribe(k.ON_CHANGED,this._render.bind(this));this._render();}ca.prototype._handleConnectionChange=function(da,ea){"use strict";this._channelStatus=da;this._channelData=ea;this._render();};ca.prototype._renderChannelDisconnect=function(){"use strict";if(this._channelStatus===i.SHUTDOWN){return o.setContent(this._message,x(this._channelData));}else if(this._channelStatus===i.RECONNECTING){var da=this._channelData;o.setContent(this._message,y(da));if(da>1000){if(da>l.get('warning_countdown_threshold_msec'))this._warningMsgEventListener=p.listen(this._message,'click',function(event){if(n.hasClass(event.getTarget(),'fbChatReconnectLink')){i.reconnect();return false;}});this._showWarningTimeout=v(this._handleConnectionChange.bind(this,i.RECONNECTING,da-1000),1000);}}};ca.prototype._renderOffline=function(){"use strict";var da='fbChatGoOnlineLink',ea=t._("Activa el chat"),fa=o.create('a',{href:'#',className:da},ea),ga=t._("{=Go online} para ver qui\u00e9n est\u00e1 disponible.",[t.param("=Go online",fa)]);o.setContent(this._message,ga);this._goOnlineEventListener=p.listen(this._message,'click',function(event){if(n.hasClass(event.getTarget(),da)){w.log('sidebar_go_online');m.goOnline();return false;}});};ca.prototype._renderBlackbirdUpsell=function(){"use strict";o.setContent(this._message,h.getOfflineContent());};ca.prototype._renderBlackbird=function(da){"use strict";o.setContent(this._message,h.getBlackbirdContent(da));};ca.prototype._clear=function(){"use strict";if(this._showWarningTimeout){clearTimeout(this._showWarningTimeout);this._showWarningTimeout=null;}if(this._warningMsgEventListener){this._warningMsgEventListener.remove();this._warningMsgEventListener=null;}if(this._goOnlineEventListener){this._goOnlineEventListener.remove();this._goOnlineEventListener=null;}n.removeClass(this._root,'upsell');n.removeClass(this._root,'offline');n.removeClass(this._root,'blackbird');n.removeClass(this._root,'error');n.removeClass(this._root,'notice');o.empty(this._message);};ca.prototype._render=function(){"use strict";this._clear();if(h.shouldShow()){if(m.hasBlackbirdEnabled()){var da=m.isOnline()?'blackbird':'upsell';n.addClass(this._root,da);this._renderBlackbird(r.getVisibility());}else if(!m.isOnline()){n.addClass(this._root,'upsell');this._renderBlackbirdUpsell();}}else if(!m.isOnline()){n.addClass(this._root,'offline');this._renderOffline();}else if(i.disconnected()){n.addClass(this._root,'error');this._renderChannelDisconnect();}else if(!k.notifiesUserMessages()){n.addClass(this._root,'notice');var ea=t._("Las alertas est\u00e1n desactivadas mientras usas otro cliente para chatear.");o.setContent(this._message,ea);}this.inform('updated');};s(ca.prototype,{_channelStatus:null,_channelData:null,_showWarningTimeout:null,_warningMsgEventListener:null,_goOnlineEventListener:null});e.exports=ca;},null);
__d("SidebarFitWindowHeight",["Arbiter","ArbiterMixin","Event","Style","SubscriptionsHandler","TinyViewport","Vector","mixin","queryThenMutateDOM"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=n(h);for(var q in p)if(p.hasOwnProperty(q))s[q]=p[q];var r=p===null?null:p.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=p;function s(t){"use strict";this.$SidebarFitWindowHeight0=t;this.onViewportUpdate();l.subscribe('change',this.onViewportUpdate.bind(this));}s.prototype.onViewportUpdate=function(){"use strict";if(l.isTiny()){this.onScroll();var t=this.onScroll.bind(this);this.$SidebarFitWindowHeight1=new k();this.$SidebarFitWindowHeight1.addSubscriptions(i.listen(window,'scroll',t),g.subscribe('dom-scroll',t));}else{if(this.$SidebarFitWindowHeight2!==0){j.set(this.$SidebarFitWindowHeight0,'margin-top','0');this.$SidebarFitWindowHeight2=0;}this.$SidebarFitWindowHeight1&&this.$SidebarFitWindowHeight1.release();}};s.prototype.onScroll=function(){"use strict";o(this.updateScrollPosition.bind(this),this.resizeSidebar.bind(this),'SidebarFitWindowHeight/scroll');};s.prototype.updateScrollPosition=function(){"use strict";this.$SidebarFitWindowHeight3=m.getScrollPosition().y;this.$SidebarFitWindowHeight4||(this.$SidebarFitWindowHeight4=this.$SidebarFitWindowHeight0.offsetHeight);};s.prototype.resizeSidebar=function(){"use strict";var t=-Math.max(Math.min(this.$SidebarFitWindowHeight3,this.$SidebarFitWindowHeight4),0);j.set(this.$SidebarFitWindowHeight0,'margin-top',t+'px');if(t!=this.$SidebarFitWindowHeight2){this.$SidebarFitWindowHeight2=t;this.inform('resized',t);}};s.prototype.getOffset=function(){"use strict";return this.$SidebarFitWindowHeight2;};e.exports=s;},null);
__d("ChatSidebar",["Arbiter","ArbiterMixin","AsyncRequest","Banzai","BanzaiLogger","Bootloader","BootloaderConfig","ChatConfig","ChatImpressionLogger","ChatOptions","ChatSidebarComposeLink.react","ChatSidebarConstants","ChatSidebarSheet","CSS","DOM","DOMDimensions","Event","JSLogger","KeyEventController","LitestandClassicPlaceHolders","MercuryConfig","OrderedFriendsList","Parent","PresencePrivacy","React","ScrollableArea","SidebarFitWindowHeight","Style","ViewportBounds","copyProperties","createArrayFromMixed","csx","cx","debounce","emptyFunction","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa){b.__markCompiled&&b.__markCompiled();var qa,ra=null,sa,ta=false,ua=false,va=false,wa=false,xa=false,ya=false,za,ab,bb=false,cb,db,eb,fb,gb,hb,ib,jb=null,kb,lb=x.create('chat_sidebar'),mb='succeeded',nb=null;function ob(){t.removeClass(document.documentElement,'sidebarMode');if(!xa||(!zb.isVisible()&&!wa)){g.inform('reflow');return;}va=false;wa=false;jb=null;fb.hide();hb.getCore().reset();t.hide(db);if(bb){t.hide(ab);t.hide(cb);t.removeClass(document.documentElement,'miniSidebar');t.removeClass(db,"_51xq");za&&za.setProps({shown:false},function(){return ub(false);});lb.log('minisidebar_hide');}else lb.log('sidebar_hide');g.inform('sidebar/hide',zb);g.inform('reflow');}function pb(){var ac=zb.shouldShowSidebar(),bc=zb.shouldShowMiniSidebar();if(zb.isEnabled()&&(ac||bc)){if(ac){sb();tb();}else vb();}else ob();if(!xa){yb();xa=true;}jb=null;}function qb(){if(hb&&zb.isVisible())hb.getCore().getElement().focus();}function rb(ac){var bc=ib.height;ac.forEach(function(cc){if(cc&&cc!==qa)bc-=v.getElementDimensions(cc).height;});if(kb)bc-=kb.getOffset();if(gb)bc-=v.getElementDimensions(gb).height;return Math.max(0,bc);}function sb(){if(zb.isVisible())return;if(bb){t.hide(ab);t.show(cb);t.removeClass(document.documentElement,'miniSidebar');t.removeClass(db,"_51xq");za&&za.setProps({shown:false},function(){return ub(false);});}va=true;wa=false;jb=null;t.show(db);t.addClass(document.documentElement,'sidebarMode');fb.show();lb.log('sidebar_show');g.inform('sidebar/show',zb);z.destroy('sidebar');}function tb(){var ac=rb(ka(cb.childNodes)),bc=fb.getItemHeight(),cc=8,dc=Math.floor((ac-cc)/bc);ha.set(qa,'height',ac+'px');fb.setNumTopFriends(dc);var ec=Math.floor((ac-cc)/bc);ec=(ec-2)>0?ec-2:0;hb.getData().setMaxResults(ec);g.inform('sidebar/resized',zb);g.inform('reflow');}function ub(ac){if(db===null)return;t.conditionClass(db,"_2e4g",ac);}function vb(){t.hide(cb);t.show(ab);t.show(db);t.addClass(document.documentElement,'sidebarMode');t.addClass(document.documentElement,'miniSidebar');t.addClass(db,"_51xq");var ac=rb([]),bc=r.getItemHeight(true),cc=Math.floor(ac/bc)-4;if(!za){l.loadModules(["ChatMiniSidebar.react","ChatMiniSidebarSearchSource"],function(dc,ec){if(!sa)sa=new ec({queryRequests:[{uri:'/ajax/mercury/composer_query.php'}]});za=ea.render(ea.createElement(dc,{dataSource:sa,height:ac,maxEntries:Math.max(cc,0),onClickSearch:ub,onToggleSidebar:zb.toggle,shown:true}),ab);});}else za.setProps({height:ac,maxEntries:Math.max(cc,0),shown:true});va=false;wa=true;z.destroy('sidebar');lb.log('minisidebar_show');g.inform('minisidebar/show',zb);g.inform('reflow');}function wb(){p.setSetting('sidebar_mode',zb.isEnabled(),'sidebar');new i('/ajax/chat/settings.php').setHandler(oa).setErrorHandler(oa).setData({sidebar_mode:zb.isEnabled()}).setAllowCrossPageTransition(true).send();}function xb(){return ba.getActiveList().length<=n.get('sidebar.min_friends');}function yb(){var ac=true;if(!zb.isEnabled()){lb.log('state_not_enabled');ac=false;}if(!zb.isViewportCapable())if(!bb){lb.log('state_not_shown_viewport');ac=false;}else if(!zb.isViewportCapableForMiniSidebar()){lb.log('state_not_shown_viewport_mini');ac=false;}if(ua){lb.log('state_not_shown_hidden');ac=false;}if(xb()){lb.log('state_not_shown_num_friends');ac=false;}lb.log(ac?'state_shown':'state_not_shown');}var zb={init:function(ac,bc,cc,dc){zb.init=oa;ya=true;db=ac;fb=bc;hb=cc;eb=dc;qa=u.find(ac,'div.fbChatSidebarBody');ab=u.find(ac,"._51x-");cb=u.find(ac,"._51x_");gb=u.find(ac,"._5qqe");bb=n.get('www_mini_sidebar',false);var ec=u.find(ac,"._x1u");ec&&ea.render(ea.createElement(q,{className:"_3a-4 _5q85"}),ec);w.listen(window,'resize',pb);y.registerKey('q',function(event){if(va){if(!ra)ra=u.scry(ac,'.inputsearch')[0];if(ra){ra.focus();event.prevent();}}});var fc=new s(ac);fc.subscribe('updated',pb);fb.setScrollContainer(ca.byClass(fb.getRoot(),'uiScrollableAreaWrap'));fb.subscribe(['render','show','hide'],na(function(hc){var ic=fa.getInstance(fb.getRoot());ic&&ic.adjustGripper();}));g.subscribe('chat/option-changed',function(hc,ic){if(ic.name=="sidebar_mode"){ta=!!p.getSetting('sidebar_mode');pb();}if(ic.name==='hide_groups')pb();});cc.getCore().subscribe('sidebar/typeahead/active',zb.updateOnActiveTypeahead);if(aa.SidebarClearTypeaheadGK){cc.subscribe('blur',function(){if(!fb.isVisible())zb.updateOnActiveTypeahead(null,false);});cc.subscribe('focus',function(){if(fb.isVisible()&&cc.getCore().getValue())zb.updateOnActiveTypeahead(null,true);});}cc.subscribe('reset',function(){if(!cc.getCore().getValue()&&!fb.isVisible())zb.updateOnActiveTypeahead(null,false);});g.subscribe('buddylist-nub/initialized',function(hc,ic){w.listen(ic.getButton(),'click',function(event){var jc=ua;ua=false;zb.enable();var kc=zb.shouldShowSidebar()||zb.shouldShowMiniSidebar();ua=jc&&!kc;return !kc;});});ta=!!p.getSetting('sidebar_mode');da.subscribe('privacy-user-presence-changed',pb);pb();o.init(fb);ia.addPersistentRight(zb.getVisibleWidth);zb.inform('sidebar/initialized',zb,g.BEHAVIOR_PERSISTENT);g.inform('sidebar/initialized',zb,g.BEHAVIOR_PERSISTENT);kb=new ga(gb);kb.subscribe('resized',pb);if(n.get('chat_sidebar_load_log')){var gc={event:mb,session_token:dc.session_token,country_code:dc.viewer_country_code,buddylist_short:n.get('buddylist_short_group'),bootloader_retry:m.retry_on_timeout};if(!nb)nb=k.create(ja({retry:true},j.VITAL));nb.log('MessagesSidebarLoadLoggerConfig',gc);}},updateOnActiveTypeahead:function(ac,bc){if(!va)return;if(bc){fb.hide();}else{hb.getView().clearContent();fb.show();pb();}},isInitialized:function(){return xa;},disable:function(){if(!zb.isEnabled())return;ta=false;wb();ob();},enable:function(){if(zb.isEnabled())return;ta=true;wb();pb();setTimeout(qb,0);},ensureLoaded:function(){if(!ta)return;if(ya)return;if(pa('pagelet_sidebar'))return;d(['UIPagelet'],function(ac){var bc=u.create('div',{id:'pagelet_sidebar'});u.appendContent(document.body,bc);ac.loadFromEndpoint('SidebarPagelet','pagelet_sidebar');});ya=true;},hide:function(){if(ua)return;ua=true;ob();},unhide:function(){if(!ua)return;ua=false;pb();},getBody:function(){return qa;},getRoot:function(){return db;},getVisibleWidth:function(){if((!va&&!wa)||!db)return 0;if(jb===null){jb=db.offsetWidth;if(wa)jb=206;}return jb;},isEnabled:function(){return ta;},isViewportCapable:function(){ib=v.getViewportWithoutScrollbarDimensions();var ac=n.get('sidebar.minimum_width');return ib.width>ac;},shouldShowSidebar:function(){var ac=zb.isViewportCapable();return ac&&!ua&&!xb();},isViewportCapableForMiniSidebar:function(){ib=v.getViewportWithoutScrollbarDimensions();var ac=n.get('sidebar.minimum_width'),bc=n.get('minisidebar.minimum_width');return ib.width>bc&&ib.width<=ac;},shouldShowMiniSidebar:function(){if(!bb)return false;var ac=zb.isViewportCapableForMiniSidebar();return ac&&!ua&&!xb();},isVisible:function(){return va;},resize:pb,toggle:function(){zb.isEnabled()?zb.disable():zb.enable();}};ja(zb,h);e.exports=zb;},null);
__d("VideoCallingTour",["Arbiter","ArbiterMixin","Chat","ChatSidebar","ChatVisibility","CSS","DOM","PresencePrivacy","Run","Toggler","Vector","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();var s,t,u,v,w=[],x=function(){};function y(){if(j.isVisible()){z();}else if(u)aa();}function z(){s.setContext(t.getBody());ba();s.show();ca();}function aa(){if(!v)v=p.createInstance(u.getRoot());var fa=m.scry(u.getRoot(),'div.fbNubFlyout')[0];if(fa){s.setContext(fa);ba();s.show();ca();}}function ba(){var fa=q.getElementDimensions(s.getContext()).y;s.setOffsetY(fa*.6);s.updatePosition();}function ca(){if(u)w.push(u.subscribe('hide',function(){da();if(!j.isVisible())s.hide();}),u.subscribe('show',function(){s.show();}),u.subscribe('resize',function(){ba();s.updatePosition();}));w.push(g.subscribe('sidebar/show',z),g.subscribe('sidebar/hide',aa),g.subscribe('sidebar/resized',ba));}function da(){if(v){v.setSticky(false);v=null;}}function ea(){while(w.length)w.pop().unsubscribe();if(u)da();s.hide();l.show('fbVideoCallingGetStarted');}r(x,h,{start:function(fa){s=fa;l.hide('fbVideoCallingGetStarted');k.goOnline(function(){w.push(n.subscribe('privacy-user-presence-changed',ea));o.onLeave(ea);i.openBuddyList();var ga=null;w.push(j.subscribe('sidebar/initialized',function(ha,ia){t=ia;clearTimeout(ga);ga=setTimeout(y,0);}),x.subscribe('videocallingtour/end',ea));w.push(g.subscribe('buddylist-nub/initialized',function(ha,ia){u=ia;clearTimeout(ga);ga=setTimeout(y,0);}));});x.inform('videocallingtour/start');}});e.exports=x;},null);
__d("ChatTypeaheadBehavior",["ChatOpenTab","CSS","MercuryConfig","Parent","Rect","copyProperties","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();function n(p,q){var r=j.byClass(p,"_4oes");if(r)h.conditionClass(r,"_5q83",q);}function o(p){"use strict";this._typeahead=p;}o.prototype.enable=function(){"use strict";var p=this._typeahead;this._subscriptions=[p.subscribe('focus',function(){p.getData().refreshData();n(p.getElement(),true);}),p.subscribe('blur',function(q){if(!i.SidebarClearTypeaheadGK)p.getCore().reset();n(p.getElement(),false);}),p.subscribe('respond',function(q,r){if(r.value&&r.value===p.getCore().getValue()){if(!r.results.length){var s=r.value.toLowerCase(),t=p.getData().getQueryCache();if(!r.isAsync&&!t.hasOwnProperty(s))return;p.getView().showNoResults();}h.addClass(p.getElement(),'hasValue');}}),p.subscribe('reset',function(){h.removeClass(p.getElement(),'hasValue');}),p.subscribe('select',function(q,r){var s=r.selected.uid;if(r.selected.mercury_thread&&!r.selected.mercury_thread.is_canonical)s=r.selected.mercury_thread.thread_fbid;p.getView().hide();g.openTabByType(s,r.selected.type,'typeahead');}),p.subscribe('highlight',function(q,r){if(r.index>=0){var s=p.getView().getItems()[r.index];if(s){var t=new k(s),u=s.offsetParent,v=t.boundWithin(new k(u)).getPositionVector();t.getPositionVector().sub(v).scrollElementBy(u);}}})];};o.prototype.disable=function(){"use strict";this._subscriptions.forEach(function(p){this._typeahead.unsubscribe(p);},this);this._subscriptions=null;};l(o.prototype,{_subscriptions:null});e.exports=o;},null);
__d("getURLRanges",["URI","URLScraper"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();"use strict";function i(j,k){k=k||0;var l=h.match(j);if(!l)return [];var m=l;if(!(/^[a-z][a-z0-9\-+.]+:\/\//i.test(l)))m='http://'+l;if(!g.isValidURI(m))return [];k+=j.indexOf(l);var n=l.length,o=[{offset:k,length:l.length,entity:{url:m}}];return o.concat(i(j.substr(k+n),k+n));}e.exports=i;},null);
__d("MercuryMessageBody.react",["EmoticonsList","React","Link.react","ReactComponentWithPureRenderMixin","SupportedEmoji","TextWithEntities.react","URI","URLMatcher","cancelAnimationFrame","cx","fbt","getURLRanges","isFacebookURI","requestAnimationFrame"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();var u=h,v=u.PropTypes,w=function(y,z){if(z.entity&&z.entity.url){var aa=new m(z.entity.url);if(s(aa))z.entity.url=aa.addQueryData({__mref:'message_bubble'}).toString();}return (h.createElement(i,{target:"_blank",href:z.entity},y));},x=h.createClass({displayName:"MercuryMessageBody",mixins:[j],propTypes:{body:v.string,ranges:v.array},getInitialState:function(){return {richText:false};},componentDidMount:function(){this._raf=t(function(){delete this._raf;var y=this.props,z=y.body,aa=y.ranges;if((aa&&aa.length)||g.noncapturingRegexp.test(z)||k.findEmoji(z)||n.match(z))this.setState({richText:true});}.bind(this));},componentWillUnmount:function(){this._raf&&o(this._raf);},render:function(){var y=this.props.body||'';if(y.startsWith('?OTR'))return (h.createElement("span",{className:"_89h"},q._("[mensaje codificado]")));y=y.replace(/\s+$/,'');if(y.length===0)return null;if(!this.state.richText)return h.createElement("span",null,y);var z=this.props.ranges;if(z==undefined)z=r(y);return (h.createElement(l,{interpolator:w,text:y,ranges:z,renderEmoticons:true,renderEmoji:true}));}});e.exports=x;},null);
__d("Dock",["Event","shield","Arbiter","ArbiterMixin","ChatQuietLinks","CSS","DataStore","DOM","Parent","Style","Toggler","Vector","copyProperties","csx","emptyFunction","WebMessengerWidthControl"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b.__markCompiled&&b.__markCompiled();b('WebMessengerWidthControl');function v(){}s(v,j,{MIN_HEIGHT:140,INITIAL_FLYOUT_HEIGHT_OFFSET:10,init:function(w){this.init=u;this.rootEl=w;this.calculateViewportDimensions();this.calculateFlyoutHeightOffset();k.removeEmptyHrefs(this.rootEl);g.listen(w,'click',this._onClick.bind(this));g.listen(window,'resize',this._onWindowResize.bind(this));q.subscribe(['show','hide'],function(x,y){var z=y.getActive();if(!n.contains(w,z))return;if(l.hasClass(z,'fbNub')){this.notifyNub(z,x);if(x==='show')this._resizeNubFlyout(z);}else{var aa=o.byClass(z,'fbNubFlyout');if(aa)l.conditionClass(aa,'menuOpened',x==='show');}}.bind(this));this.inform('init',{},i.BEHAVIOR_PERSISTENT);},calculateViewportDimensions:function(){return (this.viewportDimensions=r.getViewportDimensions());},calculateFlyoutHeightOffset:function(){this.flyoutHeightOffset=this.INITIAL_FLYOUT_HEIGHT_OFFSET+r.getElementDimensions(this.rootEl).y;var w=n.scry(document,"div._4f7n")[0];if(w){var x=p.isFixed(w)?'viewport':'document';this.flyoutHeightOffset+=r.getElementPosition(w,x).y+r.getElementDimensions(w).y;}},toggle:function(w){var x=this._findFlyout(w);if(!x)return;this.subscribe('init',function(){q.toggle(w);});},show:function(w){this.subscribe('init',function(){q.show(w);});},showNub:function(w){l.show(w);},hide:function(w){this.subscribe('init',function(){var x=q.getInstance(w);n.contains(w,x.getActive())&&x.hide();});},hideNub:function(w){l.hide(w);this.hide(w);},setUseMaxHeight:function(w,x){l.conditionClass(w,'maxHeight',x!==false);this._resizeNubFlyout(w);},_resizeNubFlyout:function(w){var x=this._findFlyout(w);if(!x||!(l.hasClass(w,'openToggler')||l.hasClass(w,'opened')))return;var y=n.find(x,'div.fbNubFlyoutOuter'),z=n.find(y,'div.fbNubFlyoutInner'),aa=n.find(z,'div.fbNubFlyoutBody'),ba=aa.scrollTop,ca=aa.offsetHeight;p.set(aa,'height','auto');var da=r.getElementDimensions(x),ea=r.getElementDimensions(aa),fa=this.getMaxFlyoutHeight(w);p.set(x,'max-height',fa+'px');p.set(y,'max-height',fa+'px');da=r.getElementDimensions(x);var ga=r.getElementDimensions(z),ha=ga.y-ea.y,ia=da.y-ha,ja=parseInt(aa.style.height||aa.clientHeight,10),ka=ia!==ja;if(da.y>ha&&ka)p.set(aa,'height',ia+'px');l.removeClass(x,'swapDirection');var la=r.getElementPosition(x).x;l.conditionClass(x,'swapDirection',function(){if(la<0)return true;return (la+da.x>this.viewportDimensions.x);}.bind(this)());if(ka&&ba+ca>=ea.y){aa.scrollTop=aa.scrollHeight;}else aa.scrollTop=ba;this.notifyNub(w,'resize');},getMaxFlyoutHeight:function(w){var x=this._findFlyout(w),y=r.getElementPosition(x,'viewport'),z=r.getElementDimensions(x),aa=Math.max(this.MIN_HEIGHT,this.viewportDimensions.y-this.flyoutHeightOffset)-(this.viewportDimensions.y-y.y-z.y);return Math.max(aa,0);},resizeAllFlyouts:function(){var w=this._getAllNubs(),x=w.length;while(x--)this._resizeNubFlyout(w[x]);},hideAllFlyouts:function(){var w=this._getAllNubs(),x=w.length;while(x--)this.hide(w[x]);},_getAllNubs:function(){var w=n.scry(this.rootEl,"div._50-v.openToggler");return w.concat(n.scry(this.rootEl,"div._50-v.opened"));},_onClick:function(event){var w=event.getTarget(),x=o.byClass(w,'fbNub');if(x){if(o.byClass(w,'fbNubFlyoutTitlebar')){var y=o.byTag(w,'a'),z=w.nodeName=='INPUT'&&w.getAttribute('type')=='submit';if(!y&&!z){this.hide(x);return false;}}this.notifyNub(x,'click');}},_onWindowResize:function(event){this.calculateViewportDimensions();this.resizeAllFlyouts();},_findFlyout:function(w){return l.hasClass(w,'fbNubFlyout')?w:n.scry(w,'div.fbNubFlyout')[0]||null;},registerNubController:function(w,x){m.set(w,'dock:nub:controller',x);x.subscribe('nub/button/content-changed',h(this.inform,this,'resize',w));x.subscribe('nub/flyout/content-changed',h(this._resizeNubFlyout,this,w));},unregisterNubController:function(w){m.remove(w,'dock:nub:controller');},notifyNub:function(w,x,y){var z=m.get(w,'dock:nub:controller');z&&z.inform(x,y);}});e.exports=a.Dock||v;},null);
__d("DataViewPolyfill",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();"use strict";function g(h,i,j){if(i===(void 0)){this.$DataViewPolyfill0=new Uint8Array(h);}else if(j===(void 0)){this.$DataViewPolyfill0=new Uint8Array(h,i);}else this.$DataViewPolyfill0=new Uint8Array(h,i,j);this.byteLength=this.$DataViewPolyfill0.byteLength;}g.prototype.getUint8=function(h){if(h>=this.$DataViewPolyfill0.length)throw new Error('Trying to read beyond bounds of DataViewPolyfill');return this.$DataViewPolyfill0[h];};g.prototype.getUint16=function(h,i){var j=this.getUint8(h),k=this.getUint8(h+1);return i?(k*256)+j:(j*256)+k;};g.prototype.getUint32=function(h,i){var j=this.getUint8(h),k=this.getUint8(h+1),l=this.getUint8(h+2),m=this.getUint8(h+3);return i?(((m*256+l)*256+k)*256)+j:(((j*256+k)*256+l)*256)+m;};g.isSupported=function(){return !!a.Uint8Array;};e.exports=g;},null);
__d("DropdownContextualHelpLink",["DOM","ge"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i={set:function(j){var k=h('navHelpCenter');if(k!==null)g.replace(k,j);}};e.exports=i;},null);
__d("ChatCookieInterface",["ChatConfig","InitialServerTime","LogHistory","PresenceState","PresenceUtil"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=i.getInstance('chat_cookie'),m=h.serverTime,n=g.get('tab_max_load_age')||3600000,o=m-n,p={store:function(r,s){if(r.uct2==s.lastChangeTime)return r;var t=q(r,s),u={};if(!t){u.old_tabs=r&&r.t2&&JSON.stringify(r.t2);u.old_promoted=r&&r.lm2;u.old_time=r&&r.uct2;u.old_reason=r&&r.tr;u.old_window=r&&r.tw;var v=[];s.tabs.forEach(function(w){if(!w.fragile){var x={i:w.id,si:w.server_id};if(w.raised)x.r=1;v.push(x);}});r.t2=v;r.lm2=s.promotedTab;r.uct2=s.lastChangeTime;r.tr=s.lastChangeReason;r.tw=k.getSessionID();u.new_tabs=JSON.stringify(r.t2);u.new_promoted=r.lm2;u.new_time=r.uct2;u.new_reason=r.tr;u.new_window=r.tw;l.debug('store',u);}else{u.tabs=r&&r.t2&&JSON.stringify(r.t2);u.promoted=r&&r.lm2;u.time=r&&r.uct2;u.reason=r&&r.tr;u.window=r&&r.tw;u.last_change_time=s.lastChangeTime;u.last_change_reason=s.lastChangeReason;u.min_change_time=o;l.warn('store_bad_state',u);}return r;}};function q(r,s){var t=j.verifyNumber(r.uct2);if(!t||typeof t!=='number'){l.warn('bad_cookie_version',r);return null;}if(t<s.lastChangeTime||t<o)return null;return t;}e.exports=p;},null);
__d("ChatTabModel",["Arbiter","ArbiterMixin","ChatBehavior","ChatDispatcher","ChatConfig","ChatCookieInterface","ChatTabActions","InitialServerTime","LogHistory","JSLogger","MercuryAssert","MercuryLocalIDs","PresenceState","PresenceUtil","areJSONRepresentationsEqual","copyProperties","MercuryServerRequests","MercuryThreads","MercuryTimestampTracker"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();var w=b('MercuryServerRequests').get(),x=b('MercuryThreads').get(),y=b('MercuryTimestampTracker').get(),z=[],aa=null,ba=null,ca=null,da=n.serverTime,ea=k.get('tab_max_load_age')||3600000,fa=da-ea,ga=0,ha=20,ia=o.getInstance('chat_tab_model'),ja=false;function ka(hb){var ib=s.verifyNumber(hb.uct2);if(!ib||typeof ib!=='number'){ia.warn('bad_cookie_version',hb);return null;}if(ib<ga||ib<fa)return null;return ib;}function la(hb){if(hb){var ib=ka(hb);if(ib&&ib!==ga){var jb={};jb.old_tabs=JSON.stringify(z);jb.old_promoted=aa;jb.old_time=ga;jb.old_reason=ca;jb.window_id=t.getSessionID();jb.cookie_tabs=hb&&hb.t2&&JSON.stringify(hb.t2);jb.cookie_promoted=hb&&hb.lm2;jb.cookie_time=hb&&hb.uct2;jb.cookie_reason=hb&&hb.tr;jb.cookie_window=hb&&hb.tw;ga=ib;ca='load';var kb=ma(hb.t2,hb.lm2||null);jb.load_result=kb;jb.new_tabs=JSON.stringify(z);jb.new_promoted=aa;jb.new_time=ga;jb.new_reason=ca;var event='load';if(!ja)event+='_init';ia.log(event,jb);return kb;}}else ia.warn('load_bad_state',hb);return false;}function ma(hb,ib){if(na(hb,ib)){var jb=z.filter(function(mb){return mb.fragile;}),kb={};aa=null;z=hb.map(function(mb){var nb={id:mb.i,server_id:mb.si};if(nb.id==ib)aa=nb.id;if(mb.r)nb.raised=true;kb[nb.id]=nb;return nb;});z=z.filter(function(mb){return mb!=null;});if(ba)for(var lb in ba)if(!kb[lb]||!kb[lb].raised)delete ba[lb];jb=jb.filter(function(mb){return !kb[mb.id];});z=z.concat(jb);ra();return true;}return false;}function na(hb,ib){if(ib!=aa)return true;var jb=z.filter(function(mb){return !mb.fragile;});if(hb.length!=jb.length)return true;for(var kb=0,lb=hb.length;kb<lb;kb++)if(!u(hb[kb],jb[kb]))return true;return false;}function oa(hb,ib,jb){var kb=la(s.get());if(ib===(void 0)||ib>ga){if(hb()){kb=true;ca=jb||null;qa(ib);}}else ia.error('rejected',{change_time:ib,state_time:ga});kb&&pa();}function pa(){if(ja)fb.inform('chat/tabs-changed',fb.get());}function qa(hb){if(hb===(void 0))hb=Math.max(y.getLastUserMessageTimestamp()||1,ga+1);ga=hb;s.doSync();}function ra(hb){var ib=z.length-ha;if(ib>0)z=z.filter(function(jb){return jb.raised||jb.id==hb||ib--<=0;});if(ib>0)z=z.filter(function(jb){return jb.id==aa||jb.id==hb||ib--<=0;});}function sa(hb){for(var ib=0;ib<z.length;ib++)if(z[ib].id==hb)return ib;return -1;}function ta(hb,ib){var jb=x.getThreadMetaNow(hb);if(!jb)return false;if(jb.is_canonical_user){return va(hb,ib);}else{var kb=ua(hb);if(kb)w.getServerThreadID(hb,function(lb){if(ya(hb,lb)){qa();pa();}});return kb;}}function ua(hb){if(sa(hb)===-1){z.push({id:hb,fragile:true});ia.log('open_fragile_tab',{tabs:JSON.stringify(z),opened:hb,window_id:t.getSessionID()});return true;}return false;}function va(hb,ib){var jb=sa(hb);if(jb!=-1)if(z[jb].fragile){z.splice(jb,1);}else{ib&&(z[jb].signatureID=ib);return true;}for(var kb=0;kb<=z.length;kb++)if(kb==z.length||z[kb].fragile){z.splice(kb,0,{id:hb,signatureID:ib});ra(hb);ia.log('open_tab',{tabs:JSON.stringify(z),opened:hb,window_id:t.getSessionID()});return true;}}function wa(hb,ib,jb){q.isThreadID(hb);var kb=false;if(ba&&ib){ba[hb]=true;kb=true;}oa(function(){if(ta(hb,jb))kb=true;var lb=sa(hb);if(lb!=-1&&!z[lb].raised){z[lb].raised=true;kb=true;ia.log('raise_tab',{tabs:JSON.stringify(z),raised:hb,window_id:t.getSessionID()});}return kb;});}function xa(hb){var ib=sa(hb);if(ib!=-1&&(!z[ib].raised||aa!==hb)){z[ib].raised=true;aa=hb;return true;}return false;}function ya(hb,ib){var jb=sa(hb);if(jb!=-1&&z[jb].fragile){var kb=z[jb];kb.fragile=false;kb.server_id=ib;var lb=[];z.forEach(function(mb){if(mb.id!=hb){if(kb&&mb.fragile){lb.push(kb);kb=null;}lb.push(mb);}});if(kb)lb.push(kb);z=lb;ia.log('make_permanent',{tabs:JSON.stringify(z),tab_id:hb,window_id:t.getSessionID()});return true;}return false;}function za(hb,ib){q.isThreadID(hb);var jb=false;if(ba){delete ba[hb];jb=true;}oa(function(){if(ab(hb))jb=true;return jb;},(void 0),ib);}function ab(hb){var ib=sa(hb);if(hb==aa)aa=null;if(ib!=-1){z.splice(ib,1);ia.log('close_tab',{tabs:JSON.stringify(z),closed:hb,window_id:t.getSessionID()});return true;}return false;}function bb(){if(z.length){ia.log('close_all_tabs',{closed_tabs:JSON.stringify(z),window_id:t.getSessionID()});z=[];aa=null;if(ba)ba={};qa();pa();}}function cb(){var hb=[];for(var ib=0;ib<z.length;ib++)if(z[ib].fragile&&!x.isNewEmptyLocalThread(z[ib].id)){hb.push(z[ib]);z.splice(ib);pa();break;}ia.log('close_fragile_tabs',{tabs:JSON.stringify(z),fragile_closed:hb,window_id:t.getSessionID()});}function db(hb){q.isThreadID(hb);var ib=false;if(ba){delete ba[hb];ib=true;}oa(function(){var jb=sa(hb);if(jb!=-1&&z[jb].raised){delete z[jb].raised;ia.log('lower_tab',{tabs:JSON.stringify(z),lowered:hb,window_id:t.getSessionID()});ib=true;}return ib;});}function eb(){if(ba){oa(function(){var hb=false;z.forEach(function(ib){if(ib.raised!=ba[ib.id]){hb=true;if(ba[ib.id]){ib.raised=true;}else delete ib.raised;}});return hb;});ia.log('persist_local_raise',{tabs:JSON.stringify(z),window_id:t.getSessionID()});}}s.registerStateStorer(function(hb){return l.store(hb,{tabs:z,promotedTab:aa,lastChangeTime:ga,lastChangeReason:ca});});s.registerStateLoader(function(hb){if(la(hb))pa();});function fb(){}v(fb,h,{isTabPromoted:function(hb){if(hb)return hb==aa;return false;},indexOf:function(hb){return sa(hb);},getTab:function(hb){q.isThreadID(hb);var ib=this.indexOf(hb);if(ib>-1){var jb=z[ib];return v({},jb);}return null;},getEmptyTab:function(){var hb;for(var ib=0;ib<z.length;ib++){hb=z[ib].id;if(x.isNewEmptyLocalThread(hb))return hb;}hb=r.generateThreadID();x.createNewLocalThread(hb,[]);return hb;},get:function(){var hb=z.map(function(ib){var jb=v({},ib);delete jb.fragile;if(ba)jb.raised=ba[jb.id];return jb;});return {tabs:hb,promoted:aa};},openFragileTab:function(hb){q.isThreadID(hb);if(ua(hb))pa();},openTab:function(hb){q.isThreadID(hb);oa(ta.bind(null,hb));},raiseAndPromoteTab:function(hb,ib,jb,kb,lb){q.isThreadID(hb);var mb=false;if(ba&&ib){ba[hb]=true;mb=true;}oa(function(){if(ta(hb,jb))mb=true;if(xa(hb)){mb=true;ia.log('raise_and_promote_tab',{tabs:JSON.stringify(z),promoted:hb,window_id:t.getSessionID()});}return mb;},kb,lb);},promoteThreadInPlaceOfThread:function(hb,ib,jb,kb){q.isThreadID(hb);q.isThreadID(ib);oa(function(){var lb=sa(hb),mb=sa(ib);if(kb){aa=hb;}else if(aa===ib)return true;var nb=z[lb];if(jb){q.isThreadID(jb);var ob=sa(jb),pb=z[mb];z[mb]=nb;z.splice(lb,1);z.splice(ob,0,pb);}else{z[lb]=z[mb];z[mb]=nb;}return true;});}});g.subscribe(p.DUMP_EVENT,function(hb,ib){ib.chat_tabs={promoted:aa,tabs:z.map(function(jb){return v({},jb);}),time:ga,max_load_age:ea};});function gb(){var hb=i.ignoresRemoteTabRaise();if(hb&&!ba){ia.log('start_ignore_remote_raise');ba={};pa();}else if(!hb&&ba){ia.log('stop_ignore_remote_raise');ba=null;pa();}}j.register(function(hb){switch(hb.actionType){case m.Types.CLOSE_TAB:za(hb.threadID,hb.reason);break;case m.Types.CLOSE_ALL_TABS:bb();break;case m.Types.CLOSE_FRAGILE_TABS:cb();break;case m.Types.LOWER_TAB:db(hb.threadID);break;case m.Types.PERSIST_LOCAL_STATE:eb();break;case m.Types.PROMOTE_TAB:q.isThreadID(hb.threadID);oa(xa.bind(null,hb.threadID));break;case m.Types.RAISE_TAB:wa(hb.threadID,hb.userAction,hb.signatureID);break;}});i.subscribe(i.ON_CHANGED,gb);gb();la(s.getInitial(),true);if(ga===0)ga=da-600000;ja=true;e.exports=fb;},null);
__d("ChatTabPresence",["AvailableList","ChatTabModel","MercuryIDs"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j={};function k(l){var m=i.getUserIDFromThreadID(l);if(m)g.updateForID(m);}h.subscribe('chat/tabs-changed',function(event,l){l.tabs.forEach(function(m){if(m.raised&&!j[m.id])k(m.id);});j={};l.tabs.forEach(function(m){if(m.raised)j[m.id]=true;});});e.exports={};},null);
__d("ChatMentionsNotifications",["fbt","CurrentUser","MercuryParticipants"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j={notifyIfMessageToMe:function(k){var l='fbid:'+h.getID(),m=k.body;i.get(l,function(n){var o=new RegExp(n.short_name,"i");if(o.test(m))j._notify(k);});},_notify:function(k){var l=48,m=k.body;if(m.length>l)m=m.substr(0,l-3)+"...";new Notification(g._("You were tagged in a message!"),{body:m,icon:"http://facebook.com//images/icons-large/fb-xl.png"});}};e.exports=j;},null);
__d("ChatAddToThreadButton.react",["Link.react","ReactComponentWithPureRenderMixin","React","TrackingNodes","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=i,n=m.PropTypes,o=i.createClass({displayName:"ChatAddToThreadButton",mixins:[h],propTypes:{isFBAtWork:n.bool,onClick:n.func,shown:n.bool},render:function(){var p=this.props.isFBAtWork?l._("Agrega m\u00e1s compa\u00f1eros de trabajo para chatear"):l._("Agregar m\u00e1s amigos a la conversaci\u00f3n"),q=j.getTrackingInfo(j.types.ADD_TO_THREAD);return (i.createElement(g,{"aria-label":p,className:(("addToThread")+(' '+"button")+(!this.props.shown?' '+"hidden_elem":'')),"data-ft":q,"data-hover":"tooltip","data-tooltip-alignv":"top",onClick:this.props.onClick}));}});e.exports=o;},null);
__d("ChatArchiveWarning.react",["Image.react","ReactComponentWithPureRenderMixin","React","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=i,m=l.PropTypes,n=i.createClass({displayName:"ChatArchiveWarning",mixins:[h],propTypes:{isFBAtWork:m.bool,shown:m.bool},render:function(){var o=this.props.isFBAtWork?k('images/chat/tab/archive-grey.png'):k('images/chat/tab/archive.png');return (i.createElement(g,{src:o,className:(("titanArchiveWarning")+(' '+"button")+(!this.props.shown?' '+"hidden_elem":'')),"data-hover":"tooltip","data-tooltip-alignh":"center","aria-label":"All employee-to-employee conversations will be archived"}));}});e.exports=n;},null);
__d("ChatCloseButton.react",["Link.react","ReactComponentWithPureRenderMixin","React","TrackingNodes","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=i,m=l.PropTypes,n=i.createClass({displayName:"ChatCloseButton",mixins:[h],propTypes:{onClick:m.func,onKeyUp:m.func,onMouseDown:m.func,active:m.bool},getDefaultProps:function(){return {active:false};},render:function(){var o=j.getTrackingInfo(j.types.CLOSE_BUTTON),p=k._("Presiona Esc para cerrar"),q=k._("Cerrar pesta\u00f1a");return (i.createElement(g,{"aria-label":this.props.active?p:q,className:"close button","data-ft":o,"data-hover":"tooltip","data-tooltip-position":"above",onClick:this.props.onClick,onKeyUp:this.props.onKeyUp,onMouseDown:this.props.onMouseDown}));}});e.exports=n;},null);
__d("VideoCallTourDialog",["ArbiterMixin","LegacyContextualDialog","CSS","MercuryIDs","ChatTabTemplates","VideoCallCore","VideoCallingTour","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();function o(){this._dialog=null;}n(o.prototype,g);n(o.prototype,{render:function(p,q){var r=j.getUserIDFromThreadID(q);if(!r||!l.availableForCall(r))return;var s=k[':fb:mercury:call:tour'].build();this._dialog=new h();this._dialog.init(s.getRoot()).setWidth(250).setAlignH('center').setContext(p).show();i.addClass(this._dialog.getRoot(),'uiContextualDialogWithFooterArrowBottom');i.addClass(p,'video_call_tour');this.inform('chat/dialog-rendered',{dialog:this,thread_id:q});m.inform('videocallingtour/end');},updatePosition:function(){if(this._dialog&&this._dialog.isShown())this._dialog.updatePosition();},hide:function(){if(this._dialog&&this._dialog.isShown()){this._dialog.hide();this._dialog=null;}}});e.exports=o;},null);
__d("ChatContextualDialogController",["Event","ArbiterMixin","ChatTabModel","VideoCallingTour","VideoCallTourDialog","copyProperties","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n=60000,o=false,p=function(w,x){this._videoCallTour=new k();this._threadID=w;this._tabMainElement=x;this._openDialog=null;this._subscriptionTokens=[];this._scrollListener=null;this._timeout=null;};function q(w,event,x){if(w._openDialog)w._openDialog.updatePosition();}function r(w){if(w._openDialog)w._openDialog.updatePosition();}function s(w){if(w._openDialog){w._openDialog.hide();w._openDialog=null;}if(w._timeout){clearTimeout(w._timeout);w._timeout=null;}while(w._subscriptionTokens.length)w._subscriptionTokens.pop().unsubscribe();if(w._scrollListener){w._scrollListener.remove();w._scrollListener=null;}}function t(w,event,x){if(x.thread_id===w._threadID){w._openDialog=x.dialog;v(w);w._timeout=m(w.destroy.bind(w,w._threadID),n);w._scrollListener=g.listen(window,'scroll',r.bind(null,w));}}function u(w,x){if(!w._openDialog){w._subscriptionTokens.push(x.subscribe('chat/dialog-rendered',t.bind(null,w)));x.render(w._tabMainElement,w._threadID);}}function v(w){w._subscriptionTokens.push(i.subscribe('chat/tabs-changed',q.bind(null,w)),p.subscribe('dialog/close-all',s.bind(null,w)));}l(p,h);l(p.prototype,{destroy:function(){s(this);},tabFocused:function(){if(o){u(this,this._videoCallTour);return;}},tabNotActive:function(){s(this);},hideVideoCallouts:function(){s(this);}});j.subscribe('videocallingtour/start',function(){o=true;p.inform('dialog/close-all');});j.subscribe('videocallingtour/end',function(){o=false;});e.exports=p;},null);
__d("getImageSize",["DataViewPolyfill"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=a.DataView||g;function i(m){return {width:m.getUint16(6,true),height:m.getUint16(8,true)};}function j(m){return {width:m.getUint32(16,false),height:m.getUint32(20,false)};}function k(m){var n=m.byteLength,o=2;while(o<n){var p=m.getUint16(o,false);o+=2;if(p==65472||p==65474){return {width:m.getUint16(o+5,false),height:m.getUint16(o+3,false)};}else o+=m.getUint16(o,false);}return null;}function l(m){var n=new h(m);if(n.getUint8(0)==255&&n.getUint8(1)==216)return k(n);if(n.getUint8(0)==71&&n.getUint8(1)==73&&n.getUint8(2)==70)return i(n);if(n.getUint8(0)==137&&n.getUint8(1)==80&&n.getUint8(2)==78&&n.getUint8(3)==71)return j(n);return null;}e.exports=l;l.gif=i;l.png=j;l.jpeg=k;},null);
__d("ChatAutoSendPhotoUploader",["ArbiterMixin","AsyncUploadRequest","DOM","Event","FileForm","FileFormResetOnSubmit","FileInput","FormSubmitOnChange","JpegResizer","MercuryAttachmentType","PhotosMimeType","PhotosUploadID","SubscriptionsHandler","arrayContains","csx","getImageSize","getObjectValues","invariant","isEmpty","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){b.__markCompiled&&b.__markCompiled();"use strict";function aa(){return 'upload_'+r.getNewID();}var ba=z(g);for(var ca in ba)if(ba.hasOwnProperty(ca))ea[ca]=ba[ca];var da=ba===null?null:ba.prototype;ea.prototype=Object.create(da);ea.prototype.constructor=ea;ea.__superConstructor__=ba;function ea(fa,ga,ha){this.$ChatAutoSendPhotoUploader0=ha;this.$ChatAutoSendPhotoUploader1=ga;this.$ChatAutoSendPhotoUploader2=new s();this.$ChatAutoSendPhotoUploader3={};this.$ChatAutoSendPhotoUploader4={};this.$ChatAutoSendPhotoUploader5=fa.getAttribute('action');this.$ChatAutoSendPhotoUploader6=new k(fa,[n,l]);this.$ChatAutoSendPhotoUploader6.setAllowCrossOrigin(true);this.$ChatAutoSendPhotoUploader6.setUploadInParallel(true);var ia=i.find(fa,"._4q60"),ja=i.find(ia,"._4q61");this.$ChatAutoSendPhotoUploader7=new m(ia,ja,ga);this.$ChatAutoSendPhotoUploader2.addSubscriptions(this.$ChatAutoSendPhotoUploader6.subscribe('submit',this.$ChatAutoSendPhotoUploader8.bind(this)),this.$ChatAutoSendPhotoUploader6.subscribe('success',this.$ChatAutoSendPhotoUploader9.bind(this)),this.$ChatAutoSendPhotoUploader6.subscribe('failure',this.$ChatAutoSendPhotoUploadera.bind(this)),this.$ChatAutoSendPhotoUploader6.subscribe('progress',this.$ChatAutoSendPhotoUploaderb.bind(this)),j.listen(ja,'click',function(){if(this.$ChatAutoSendPhotoUploaderc)if(o.prepareResource)o.prepareResource();this.inform('open');}.bind(this)));this.$ChatAutoSendPhotoUploaderc=o.isSupported();if(this.$ChatAutoSendPhotoUploaderc)this.$ChatAutoSendPhotoUploader6.setPreprocessHandler(this.$ChatAutoSendPhotoUploaderd.bind(this));}ea.prototype.isUploading=function(){return !y(this.$ChatAutoSendPhotoUploader3);};ea.prototype.destroy=function(){this.$ChatAutoSendPhotoUploader2.release();this.$ChatAutoSendPhotoUploader6.destroy();this.$ChatAutoSendPhotoUploader3={};this.$ChatAutoSendPhotoUploader4={};};ea.prototype.$ChatAutoSendPhotoUploadere=function(fa,ga){var ha=this.$ChatAutoSendPhotoUploaderf(fa);if(ga){ha.preview_width=ga.width;ha.preview_height=ga.height;}return ha;};ea.prototype.$ChatAutoSendPhotoUploaderf=function(fa){var ga={upload_id:fa,on_progress:function(ha){this.$ChatAutoSendPhotoUploader2.addSubscriptions(this.subscribe('progress',ha));}.bind(this),on_resizing_progress:function(ha){this.$ChatAutoSendPhotoUploader2.addSubscriptions(this.subscribe('resize_progress',ha));}.bind(this),on_success:function(ha){this.$ChatAutoSendPhotoUploader2.addSubscriptions(this.subscribe('success',ha));}.bind(this),upload_canceled:this.$ChatAutoSendPhotoUploaderg.bind(this),attach_type:p.PHOTO,preview_uploading:true};return ga;};ea.prototype.$ChatAutoSendPhotoUploaderd=function(fa,ga){var ha=fa.getFile();if(!q(ha.type).isJpeg())return ga(fa);o.getSingleton().resizeBlob(ha,function(ia,ja,ka){if(ja)fa.setFile(ja);ga(fa);},this.$ChatAutoSendPhotoUploaderh.bind(this,fa));};ea.prototype.$ChatAutoSendPhotoUploader8=function(){var fa=aa();this.$ChatAutoSendPhotoUploaderi(fa,this.$ChatAutoSendPhotoUploader1.files);};ea.prototype.$ChatAutoSendPhotoUploaderi=function(fa,ga){var ha={};if(typeof FileReader!=='undefined'&&FileReader.prototype.readAsArrayBuffer&&ga&&ga.length===1){this.$ChatAutoSendPhotoUploader3[fa]=fa;ha[fa]=ga[0];var ia=new FileReader();ia.onload=function(){this.inform('submit',{upload_id:fa,preview_attachments:[this.$ChatAutoSendPhotoUploadere(fa,v(ia.result))]});}.bind(this);ia.onerror=function(){this.inform('submit',{upload_id:fa,preview_attachments:[this.$ChatAutoSendPhotoUploaderf(fa)]});}.bind(this);ia.readAsArrayBuffer(ga[0]);}else{var ja=[];if(!ga){this.$ChatAutoSendPhotoUploader3[fa]=fa;this.$ChatAutoSendPhotoUploader0.value=fa;ja.push(this.$ChatAutoSendPhotoUploaderf(fa));}else for(var ka=0;ka<ga.length;++ka){var la=aa();ha[la]=ga[ka];this.$ChatAutoSendPhotoUploader3[la]=fa;ja.push(this.$ChatAutoSendPhotoUploaderf(la));}this.inform('submit',{upload_id:fa,preview_attachments:ja});}if(Object.keys(ha).length>0)this.$ChatAutoSendPhotoUploader6.setFiles(ha);};ea.prototype.$ChatAutoSendPhotoUploader9=function(event,fa){var ga=this.$ChatAutoSendPhotoUploaderj(fa);if(this.$ChatAutoSendPhotoUploader3[ga]){var ha=this.$ChatAutoSendPhotoUploader3[ga];delete this.$ChatAutoSendPhotoUploader3[ga];var ia=fa.response.getPayload();if(!this.$ChatAutoSendPhotoUploader4[ha])this.$ChatAutoSendPhotoUploader4[ha]=[];this.$ChatAutoSendPhotoUploader4[ha].push({id:ga,image_id:ia.metadata[0].image_id,file_id:ia.metadata[0].file_id,gif_id:ia.metadata[0].gif_id});this.inform('success',{upload_id:ga});if(!this.$ChatAutoSendPhotoUploaderk(ha))this.$ChatAutoSendPhotoUploaderl(ha);this.$ChatAutoSendPhotoUploader7.clear();}};ea.prototype.$ChatAutoSendPhotoUploaderl=function(fa){x(!this.$ChatAutoSendPhotoUploaderk(fa));this.$ChatAutoSendPhotoUploader4[fa].sort(function(ga,ha){return ga.id<ha.id?-1:1;});this.inform('all-uploads-completed',{upload_id:fa,image_ids:this.$ChatAutoSendPhotoUploader4[fa].map(function(ga){return ga.image_id;}),file_ids:this.$ChatAutoSendPhotoUploader4[fa].map(function(ga){return ga.file_id;}),gif_ids:this.$ChatAutoSendPhotoUploader4[fa].map(function(ga){return ga.gif_id;})});delete this.$ChatAutoSendPhotoUploader4[fa];};ea.prototype.$ChatAutoSendPhotoUploaderb=function(event,fa){this.inform('progress',{upload_id:fa.upload.getName(),event:fa.event});};ea.prototype.$ChatAutoSendPhotoUploaderh=function(fa,event){this.inform('resize_progress',{upload_id:fa.getName(),event:event});};ea.prototype.$ChatAutoSendPhotoUploaderk=function(fa){return t(w(this.$ChatAutoSendPhotoUploader3),fa);};ea.prototype.$ChatAutoSendPhotoUploadera=function(event,fa){var ga=this.$ChatAutoSendPhotoUploaderj(fa);this.$ChatAutoSendPhotoUploaderm(ga,'last-upload-failed');this.$ChatAutoSendPhotoUploader7.clear();return false;};ea.prototype.$ChatAutoSendPhotoUploaderg=function(fa){this.$ChatAutoSendPhotoUploaderm(fa,'last-upload-canceled');};ea.prototype.$ChatAutoSendPhotoUploaderm=function(fa,ga){if(!this.$ChatAutoSendPhotoUploader3[fa])return;var ha=this.$ChatAutoSendPhotoUploader3[fa];delete this.$ChatAutoSendPhotoUploader3[fa];if(!this.$ChatAutoSendPhotoUploaderk(ha))if(this.$ChatAutoSendPhotoUploader4[ha]){this.$ChatAutoSendPhotoUploaderl(ha);}else this.inform(ga,{upload_id:ha});};ea.prototype.$ChatAutoSendPhotoUploaderj=function(fa){if(fa.upload){return fa.upload.getName();}else return fa.response.getPayload().uploadID;};ea.prototype.uploadFile=function(fa){var ga=aa(),ha={};ha[ga]=fa;var ia=new h(this.$ChatAutoSendPhotoUploader5).setAllowCrossOrigin(true).setRelativeTo(this.$ChatAutoSendPhotoUploader6.getRoot()).setFiles(ha);this.$ChatAutoSendPhotoUploader2.addSubscriptions(ia.subscribe('success',function(event,ja){this.$ChatAutoSendPhotoUploader9(event,{upload:ja,response:ja.getResponse()});}.bind(this)),ia.subscribe('failure',this.$ChatAutoSendPhotoUploadera.bind(this)));ia.send();this.$ChatAutoSendPhotoUploaderi(ga,[fa]);};e.exports=ea;},null);
__d("ChatPhotoUploader.react",["ChatAutoSendPhotoUploader","Image.react","InlineBlock.react","Link.react","MercuryConfig","React","SubscriptionsHandler","cx","emptyFunction","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();'use strict';var r=l,s=r.PropTypes,t=l.createClass({displayName:"ChatPhotoUploader",propTypes:{actionURI:s.string,imageClassName:s.string,imagesOnly:s.bool,onSubmit:s.func,onAllUploadsComplete:s.func,onLastUploadFail:s.func,onLastUploadCancel:s.func},getDefaultProps:function(){return {actionURI:k.upload_url,imageClassName:"_509w",imagesOnly:true,onSubmit:o,onAllUploadsComplete:o,onLastUploadFail:o,onLastUploadCancel:o};},componentDidMount:function(){this._uploader=new g(l.findDOMNode(this.refs.form),l.findDOMNode(this.refs.input),l.findDOMNode(this.refs.attachID));this._subscriptions=new m();this._subscriptions.addSubscriptions(this._uploader.subscribe('submit',this._handleSubmit),this._uploader.subscribe('all-uploads-completed',this._handleAllUploadsCompleted),this._uploader.subscribe('last-upload-failed',this._handleLastUploadFailed),this._uploader.subscribe('last-upload-canceled',this._handleLastUploadCanceled));},shouldComponentUpdate:function(u,v){return u.actionURI!=this.props.actionURI;},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();this._uploader&&this._uploader.destroy();},render:function(){return (l.createElement("form",{action:this.props.actionURI,method:"post",ref:"form"},l.createElement("input",{type:"hidden",name:"attach_id",ref:"attachID"}),l.createElement("input",{type:"hidden",name:"images_only",value:this.props.imagesOnly}),l.createElement(i,{className:"_m _4q60 _3rzn"},l.createElement(j,{className:"_4q61 _509v"},l.createElement(h,{className:this.props.imageClassName,src:q('/images/chat/chat_camera_icon.png'),alt:p._("C\u00e1mara")})),l.createElement("input",{type:"file",className:"_n",name:"attachment[]",multiple:"true",accept:this.props.imagesOnly?'image/*':'*',ref:"input"}))));},_handleSubmit:function(u,v){this.props.onSubmit(u,v);},_handleAllUploadsCompleted:function(u,v){this.props.onAllUploadsComplete(u,v);},_handleLastUploadFailed:function(u,v){this.props.onLastUploadFail(u,v);},_handleLastUploadCanceled:function(u,v){this.props.onLastUploadCancel(u,v);},isUploading:function(){return this._uploader&&this._uploader.isUploading();},uploadFile:function(u){this._uploader.uploadFile(u);}});e.exports=t;},null);
__d("ChatPrivacyActionController",["ChatVisibility","JSLogger","PresencePrivacy","copyProperties"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=function(l,m){this._userID=l;this._logger=h.create('blackbird');this._getState=function(){if(g.isOnline())return i.allows(this._userID)?k.NORMAL:k.BLOCKED;return k.OFFLINE;};this._togglePrivacy=function(){var n=this._getState();switch(this._getState()){case k.OFFLINE:if(g.isOnline()){this._logger.error('tabs_already_online');break;}this._logger.log('tabs_go_online',{tab_id:this._userID});g.goOnline(function(){if(!i.allows(this._userID)){if(this._getState()!==k.BLOCKED)this._logger.error('privacy_action_controller_blocked_inconsistency');this._togglePrivacy();}}.bind(this));break;case k.BLOCKED:i.allow(this._userID);this._logger.log('tabs_unblock',{tab_id:this._userID});break;case k.NORMAL:i.disallow(this._userID);this._logger.log('tabs_block',{tab_id:this._userID});break;}};setTimeout(function(){var n=function(){m&&m(this._getState());}.bind(this);n();this._subscribeToken=i.subscribe('privacy-changed',n);}.bind(this),0);};k.OFFLINE='offline';k.BLOCKED='blocked';k.NORMAL='normal';j(k.prototype,{togglePrivacy:function(){this._logger.log('gear_menu_toggle_privacy',{tab_id:this._userID});this._togglePrivacy();},destroy:function(){this._subscribeToken&&i.unsubscribe(this._subscribeToken);}});e.exports=k;},null);
__d("ChatShareLinkUploader",["AsyncRequest","CSS","DOM","URLScraper","MercuryShareLinkUploader","MercuryAttachmentTemplates","Event"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();for(var n in k)if(k.hasOwnProperty(n))p[n]=k[n];var o=k===null?null:k.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=k;function p(q,r,s,t,u){"use strict";this.$ChatShareLinkUploader0=q;this.$ChatShareLinkUploader1=r;this.$ChatShareLinkUploader2=s;this.$ChatShareLinkUploader3=false;this.$ChatShareLinkUploader4=null;this.$ChatShareLinkUploader5=t;this.$ChatShareLinkUploader6=u;this.$ChatShareLinkUploader7=false;m.listen(r,'keyup',function(){!this.getInputValue().length&&this.$ChatShareLinkUploader8.enable();}.bind(this));this.$ChatShareLinkUploader8=new j(r,t);this.$ChatShareLinkUploader8.subscribe('match',function(v,w){this.loadShare(w&&w.url);}.bind(this));this.$ChatShareLinkUploader9=1337;this.$ChatShareLinkUploadera=null;}p.prototype.getInputValue=function(){"use strict";return this.$ChatShareLinkUploader5?this.$ChatShareLinkUploader5():this.$ChatShareLinkUploader1.value;};p.prototype.getAttachData=function(){"use strict";return this.loadAttachData(this.$ChatShareLinkUploader3,this.$ChatShareLinkUploader0,this.$ChatShareLinkUploader1,this.$ChatShareLinkUploader5);};p.prototype.getShareData=function(){"use strict";if(!this.$ChatShareLinkUploader3)return null;return this.getShareDataFromStage(this.$ChatShareLinkUploader3,this.$ChatShareLinkUploader0);};p.prototype.close=function(){"use strict";this.$ChatShareLinkUploaderb();this.$ChatShareLinkUploader8.disable();this.inform('closed');};p.prototype.clear=function(){"use strict";this.$ChatShareLinkUploaderb();this.$ChatShareLinkUploader8.enable();};p.prototype.$ChatShareLinkUploaderb=function(){"use strict";var q=this.$ChatShareLinkUploadera;delete this.$ChatShareLinkUploadera;if(q){i.remove(q);this.inform('dom-updated');}this.$ChatShareLinkUploaderc();this.$ChatShareLinkUploader3=false;this.$ChatShareLinkUploader7=false;this.$ChatShareLinkUploader4&&this.$ChatShareLinkUploader4.abort();this.$ChatShareLinkUploader4=null;this.$ChatShareLinkUploader8&&this.$ChatShareLinkUploader8.reset();};p.prototype.loadShareFromParams=function(q,r){"use strict";this.$ChatShareLinkUploader7=true;this.$ChatShareLinkUploaderd(new g().setMethod('POST').setURI('/ajax/share_params.php').setData({chat:true,share_type:q,share_params:r}));};p.prototype.loadShare=function(q,r){"use strict";this.$ChatShareLinkUploaderd(new g().setMethod('POST').setURI('/ajax/share_scrape.php').setData({chat:true,extra_params:JSON.stringify(r),u:q}),q);};p.prototype.loadedFromFeed=function(){"use strict";return this.$ChatShareLinkUploader7;};p.prototype.$ChatShareLinkUploaderc=function(){"use strict";return (++this.$ChatShareLinkUploader9);};p.prototype.$ChatShareLinkUploadere=function(){"use strict";return this.$ChatShareLinkUploader9;};p.prototype.$ChatShareLinkUploaderd=function(q,r){"use strict";this.$ChatShareLinkUploader4&&this.$ChatShareLinkUploader4.abort();var s=l[':fb:mercury:share-link-row'].build();if(this.$ChatShareLinkUploadera)i.remove(this.$ChatShareLinkUploadera);this.$ChatShareLinkUploadera=s.getRoot();m.listen(s.getNode('closeFileUpload'),'click',function(event){this.close();event.kill();}.bind(this));i.appendContent(this.$ChatShareLinkUploader0,this.$ChatShareLinkUploadera);h.show(this.$ChatShareLinkUploader0);this.inform('dom-updated');var t=this.$ChatShareLinkUploaderc();this.$ChatShareLinkUploader4=q.setHandler(function(u){return this.$ChatShareLinkUploaderf(t,u,r);}.bind(this));this.$ChatShareLinkUploader4.send();this.inform('link-detected');};p.prototype.$ChatShareLinkUploaderf=function(q,r,s){"use strict";if(this.$ChatShareLinkUploadere()!==q)return;this.$ChatShareLinkUploader4=null;i.appendContent(this.$ChatShareLinkUploadera,r.payload);this.$ChatShareLinkUploader2();this.$ChatShareLinkUploader3=true;if(!this.getAttachData()){this.close();if(s&&this.getInputValue().indexOf(s)===-1)this.$ChatShareLinkUploader6(s);return;}h.addClass(this.$ChatShareLinkUploadera,'done');};e.exports=p;},null);
__d("StickerContextualDialog.react",["ReactAbstractContextualDialog","ReactLayer","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=47,k=h.createClass(g.createSpec({displayName:'StickerXUIContextualDialog',theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:j,length:16}}}));k.WIDTH={NORMAL:312,WIDE:400};e.exports=k;},null);
__d("ChatStickerButton.react",["BanzaiODS","React","ReactLayeredComponentMixin","StickerContextualDialog.react","StickersFlyout.react","StickerState","cx","emptyFunction","fbt","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();'use strict';var q=h,r=q.PropTypes,s=278,t=h.createClass({displayName:"ChatStickerButton",propTypes:{className:r.string,flyoutClassName:r.string,flyoutWidth:r.number,wrapperClass:r.func,onStickerSelect:r.func,onEmoticonSelect:r.func,onFlyoutShown:r.func,onFlyoutHidden:r.func},getInitialState:function(){return {shown:false,packID:l.getTrayPackID()};},mixins:[i],getDefaultProps:function(){return {flyoutWidth:s,onStickerSelect:n,onEmoticonSelect:n};},componentDidMount:function(){g.bumpEntityKey('chat.web','sticker_button.mounted');this._subscription=l.addListener(l.PACK_SELECTED,function(u){return this.setState({packID:u});}.bind(this));},shouldComponentUpdate:function(u,v){return (v.packID!=this.state.packID||v.shown!=this.state.shown);},componentWillUnmount:function(){this._subscription&&this._subscription.remove();},render:function(){return (h.createElement("a",{onClick:this.showFlyout,onMouseDown:this._prepareForClick,title:o._("Elige un sticker o un emotic\u00f3n"),ref:"link"},h.createElement("span",{className:p(this.props.className,((this.state.shown?"open":'')))})));},renderLayers:function(){var u=this.props.wrapperClass||j;return {contextualDialog:h.createElement(u,{alignment:this.props.flyoutAlignment,className:"_5e-r",contextRef:"link",onBlur:this._hideFlyout,position:"above",shown:this.state.shown,width:this.props.flyoutWidth},h.createElement("div",null,h.createElement(k,{className:this.props.flyoutClassName,onShown:function(v){return this.props.onFlyoutShown&&this.props.onFlyoutShown(v);}.bind(this),onHidden:function(){return this.props.onFlyoutHidden&&this.props.onFlyoutHidden();}.bind(this),onEscKeyDown:this._hideFlyout,onStickerSelect:this._handleStickerSelected,onEmoticonSelect:this._handleEmoticonSelected,packID:this.state.packID,shown:this.state.shown})))};},_prepareForClick:function(){this._clickGuard=this.state.shown;},showFlyout:function(){!this._clickGuard&&this.setState({shown:true});},_hideFlyout:function(){this.setState({shown:false});},_handleStickerSelected:function(u){this.props.onStickerSelect(u);},_handleEmoticonSelected:function(u){this._hideFlyout();this.props.onEmoticonSelect(u);}});e.exports=t;},null);
__d("StickersFlyoutTriggerSelector.react",["React","Sticker.react","StickerConstants","StickerUtils","XUIContextualDialog.react","XUICloseButton.react","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=g,o=n.PropTypes,p=84,q=g.createClass({displayName:"StickersFlyoutTriggerSelector",getDefaultProps:function(){return {stickers:[]};},propTypes:{context:o.object.isRequired,stickers:o.array,onStickerSelect:o.func.isRequired},shouldComponentUpdate:function(r){if(this.props.stickers.length!==r.stickers.length)return true;for(var s=0;s<Math.min(this.props.stickers.length,5);s++)if(this.props.stickers[s].id!==r.stickers[s].id)return true;return false;},_renderStickers:function(){if(!this.props.stickers||this.props.stickers.length===0)return null;var r=Math.floor(Math.random()*Math.min(this.props.stickers.length,5)),s=this.props.stickers[r],t=j.getScaledDimensions(s.height,s.width,i.TRAY_SIZE);return (g.createElement("div",null,g.createElement(l,{size:"small",className:"_2ohj",onClick:this.props.onDismissTrigger}),g.createElement("div",{className:"_5r8h _onc","data-id":s.id,onClick:function(){return this.props.onStickerSelect(s.id);}.bind(this)},g.createElement(h,{animationTrigger:"hover",className:"_5r8i",frameCount:s.frameCount,frameRate:s.frameRate||83,framesPerCol:s.framesPerCol,framesPerRow:s.framesPerRow,sourceHeight:t.height,sourceURI:s.sourceURI,sourceWidth:t.width,spriteURI:s.spriteURI,paddedSpriteURI:s.paddedSpriteURI,stickerID:s.id,style:{cursor:'pointer',height:'64px'}}))));},render:function(){return (g.createElement(k,{alignment:"left",autoFocus:false,context:this.props.context,onBlur:this._resetFlyout,offsetY:11,position:"above",shown:this.props.stickers&&this.props.stickers.length>0,width:p},this._renderStickers()));}});e.exports=q;},null);
__d("StickerTrigger",["EmoticonsList","Map","StickerConfig","StickerSearch","StickerServerRequests"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=new h(),m={findTriggerForInput:function(n,o){if(n===null){o([],null);return;}j.prepareTagsData().then(function(){return this.findTagForInput(n,function(p,q){return o(p,q);});}.bind(this));},findTagForInput:function(n,o){var p=this.findTriggeredWord(n);if(p){if(l.has(p)){o(l.get(p),p);}else k.getStickersForQuery(p,function(q){var r=q.getPayload();l.set(p,r);o(r,p);});}else o([],null);},_getRegex:function(){if(i.TriggerConfidence==='emoji_only'){return g.noncapturingRegexp;}else if(i.TriggerConfidence==='high')return (/^(?:\w+\s?){1,4}$/);return null;},findTriggeredWord:function(n){var o=j.getTagsIndex();if(!o)return null;n=n.toLowerCase();var p=n.match(this._getRegex()),q=null;for(var r=0;p!==null&&r<p.length;r++)if(o[p[r]])q=p[r];return q;}};e.exports=m;},null);
__d("StickerTriggerIndicator.react",["React","cx"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i=g,j=i.PropTypes,k=g.createClass({displayName:"StickerTriggerIndicator",getDefaultProps:function(){return {stickers:[]};},propTypes:{stickers:j.array},shouldComponentUpdate:function(l){var m=this.props.stickers.length>0,n=l.stickers.length>0;return m!==n;},render:function(){var l=this.props.stickers&&this.props.stickers.length>0;return g.createElement("span",{className:((l?"emoticonIndicator":''))});}});e.exports=k;},null);
__d("ChatStickerTriggerController",["BanzaiLogger","React","StickerConfig","StickersFlyoutTriggerSelector.react","StickerTrigger","StickerTriggerIndicator.react"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';function m(n,o,p,q,r){this.$ChatStickerTriggerController0=null;this.$ChatStickerTriggerController1=null;this.$ChatStickerTriggerController2=null;this.$ChatStickerTriggerController3=r;this.$ChatStickerTriggerController4=q;this.$ChatStickerTriggerController5=null;if(i.TriggerInterface==='one_tap'){this.$ChatStickerTriggerController1=h.render(h.createElement(j,{context:p,onStickerSelect:this.$ChatStickerTriggerController6.bind(this),onDismissTrigger:this.$ChatStickerTriggerController7.bind(this)}),n);this.$ChatStickerTriggerController2=n;}else if(i.TriggerInterface==='hyperlink'){this.$ChatStickerTriggerController1=h.render(h.createElement(l,null),o);this.$ChatStickerTriggerController2=o;}}m.prototype.setInput=function(n){this.$ChatStickerTriggerController8=n;};m.prototype.activateAfterparty=function(){this.$ChatStickerTriggerController9=true;clearTimeout(this.$ChatStickerTriggerControllera);this.$ChatStickerTriggerControllera=setTimeout(this.$ChatStickerTriggerControllerb.bind(this),5000);};m.prototype.updateInput=function(n){if(this.$ChatStickerTriggerController9)this.$ChatStickerTriggerControllerb();this.$ChatStickerTriggerControllerc(n);};m.prototype.onFlyoutShown=function(n){if(this.$ChatStickerTriggerController0&&!this.$ChatStickerTriggerControllerd){this.$ChatStickerTriggerControllerd=true;this.$ChatStickerTriggerController3(this.$ChatStickerTriggerController0,n);this.$ChatStickerTriggerController1.isMounted()&&this.$ChatStickerTriggerController1.setProps({stickers:[]});}else n();};m.prototype.getTriggeredWord=function(){return this.$ChatStickerTriggerController0;};m.prototype.$ChatStickerTriggerController6=function(n){this.$ChatStickerTriggerController4(n);this.$ChatStickerTriggerController7();};m.prototype.$ChatStickerTriggerController7=function(){this.$ChatStickerTriggerControllerd=true;this.$ChatStickerTriggerController1.isMounted()&&this.$ChatStickerTriggerController1.setProps({stickers:[]});};m.prototype.$ChatStickerTriggerControllere=function(n,o){if(this.$ChatStickerTriggerController5===null||this.$ChatStickerTriggerController5&&this.$ChatStickerTriggerController5.toLowerCase().indexOf(o)===-1){this.$ChatStickerTriggerController8.isMounted()&&this.$ChatStickerTriggerController8.setProps({triggeredWord:null});this.$ChatStickerTriggerController1.isMounted()&&this.$ChatStickerTriggerController1.setProps({stickers:[]});return;}if(o)g.log('StickersLoggerConfig',{event:'sticker_trigger_activated',numsearchresults:n.length,triggeredword:o,triggerused:false});this.$ChatStickerTriggerController0=o;this.$ChatStickerTriggerController8.isMounted()&&this.$ChatStickerTriggerController8.setProps({triggeredWord:o});if(!this.$ChatStickerTriggerControllerd)this.$ChatStickerTriggerController1.isMounted()&&this.$ChatStickerTriggerController1.setProps({stickers:n});};m.prototype.$ChatStickerTriggerControllerb=function(){clearTimeout(this.$ChatStickerTriggerControllera);this.$ChatStickerTriggerController9=false;this.$ChatStickerTriggerControllerd=false;this.$ChatStickerTriggerController0=null;this.$ChatStickerTriggerControllerc(null);};m.prototype.$ChatStickerTriggerControllerc=function(n){if(this.$ChatStickerTriggerController5!==n){this.$ChatStickerTriggerController5=n;k.findTriggerForInput(this.$ChatStickerTriggerController5,this.$ChatStickerTriggerControllere.bind(this));}};m.prototype.destroy=function(){h.unmountComponentAtNode(this.$ChatStickerTriggerController2);clearTimeout(this.$ChatStickerTriggerControllera);};e.exports=m;},null);
__d("ChatFileUploaderMixin",["SubscriptionsHandler","React"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=h,j=i.PropTypes,k={propTypes:{attachmentsShelf:j.object,onFileUploaderMounted:j.func,onUploadFinished:j.func,onUpdateAttachmentsShelf:j.func,onSubmit:j.func},setUpSubscriptionsHandler:function(l){this._uploader=l;this._subscriptions=new g();this._subscriptions.addSubscriptions(this._uploader.subscribe(['all-uploads-completed','upload-canceled'],this._handleUploadFinished),this._uploader.subscribe('dom-updated',this._handleUpdateAttachmentsShelf),this._uploader.subscribe('submit',this._handleSubmit));this.props.onFileUploaderMounted(this._uploader);},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();if(!this.props.uploaderIsFromHigherLevel)this._uploader&&this._uploader.destroy();},isUploading:function(){return this._uploader.isUploading();},getAttachments:function(){return this._uploader.getAttachments();},getImageFiles:function(){return this._uploader.getImageFiles();},getVideoFiles:function(){return this._uploader.getVideoFiles();},getAudioFiles:function(){return this._uploader.getAudioFiles();},getFiles:function(){return this._uploader.getFiles();},removeAttachments:function(){return this._uploader.removeAttachments();},_handleUploadFinished:function(){if(this.props.onUploadFinished)this.props.onUploadFinished();},_handleUpdateAttachmentsShelf:function(){if(this.props.onUpdateAttachmentsShelf)this.props.onUpdateAttachmentsShelf();},_handleSubmit:function(){if(this.props.onSubmit)this.props.onSubmit();}};e.exports=k;},null);
__d("ChatFileUploader.react",["ChatFileUploaderMixin","InlineBlock.react","MercuryConfig","React","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=j.createClass({displayName:"ChatFileUploader",mixins:[g],getDefaultProps:function(){return {uploaderIsFromHigherLevel:true};},shouldComponentUpdate:function(){return false;},componentDidMount:function(){var n=this.props.initFileUploaderFn(j.findDOMNode(this.refs.form),j.findDOMNode(this.refs.input),j.findDOMNode(this.refs.attachID));this.setUpSubscriptionsHandler(n);},render:function(){return (j.createElement("form",{ref:"form",action:i.upload_url,method:"post"},j.createElement("input",{type:"hidden",ref:"attachID",name:"attach_id"}),j.createElement(h,{className:"_m _4q60 itemLabel"},j.createElement("input",{type:"file",className:"_n",name:"attachment[]",multiple:"true",ref:"input"}),j.createElement("span",{className:"_4q61 itemAnchor"},l._("Agregar archivos...")))));}});e.exports=m;},null);
__d("ChatTabMenu.react",["ChatFileUploader.react","ChatPrivacyActionController","MercuryConfig","MercuryIDs","MercuryFileUploader","MercuryThreadMuter","ReactComponentWithPureRenderMixin","React","PopoverMenu.react","ReactMenu","MenuSeparator.react","Toggler","TrackingNodes","WebMessengerThreadPermalinks","cx","fbt","goURI","MercuryThreadActions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){b.__markCompiled&&b.__markCompiled();'use strict';var x=b('MercuryThreadActions').get(),y=p.Item,z=n,aa=z.PropTypes,ba=n.createClass({displayName:"ChatTabMenu",mixins:[m],propTypes:{onFileUploaderMounted:aa.func,updatePrivacyLinkFunc:aa.func,nameConversationFunc:aa.func,leaveConversationFunc:aa.func,showParticipantsFunc:aa.func,clearHistoryFunc:aa.func,reportSpamFunc:aa.func,createGroupFunc:aa.func,switchToWorkFunc:aa.func,isMultichat:aa.bool,isEmptyChat:aa.bool,hasSwitchToWork:aa.bool,showAddFriend:aa.func,threadID:aa.string,attachmentsShelf:aa.object,onUploadFinished:aa.func,onUpdateAttachmentsShelf:aa.func,onSubmit:aa.func,enableDesktopNotif:aa.func},getInitialState:function(){return {url:null};},getDefaultProps:function(){return {show:true};},componentDidMount:function(){t.getThreadURI(this.props.threadID,function(ca){this.isMounted()&&this.setState({url:ca});}.bind(this));if(!this.props.isMultiChat)this._privacyActionController=new h(j.getUserIDFromThreadID(this.props.threadID),this.props.updatePrivacyLinkFunc);},_initFileUploader:function(ca,da,ea){if(this._fileUploader){this._fileUploader.updateElements(ca,da,ea);}else this._fileUploader=new k(this.props.attachmentsShelf,ca,da,ea);return this._fileUploader;},componentWillUnmount:function(){this._privacyActionController&&this._privacyActionController.destroy();this._fileUploader&&this._fileUploader.destroy();},_unmuteThread:function(){x.unmute(this.props.threadID);r.hide();},_togglePrivacyFunc:function(){this._privacyActionController.togglePrivacy();},getURL:function(){return this.state.url;},_renderFileUploader:function(){return (n.createElement(y,{className:"_37_x"},n.createElement(g,{onFileUploaderMounted:this.props.onFileUploaderMounted,attachmentsShelf:this.props.attachmentsShelf,initFileUploaderFn:this._initFileUploader,onUploadFinished:this.props.onUploadFinished,onUpdateAttachmentsShelf:this.props.onUpdateAttachmentsShelf,onSubmit:this.props.onSubmit})));},_renderOpenFullConversation:function(){if(this.state.url)return (n.createElement(y,{onclick:function(){return w(this.state.url);}.bind(this)},v._("Ver la conversaci\u00f3n completa")));return null;},_renderAddFriend:function(){if(!this.props.showAddFriend)return null;return (n.createElement(y,{onclick:this.props.showAddFriend},v._("Agregar amigos al chat...")));},_renderTogglePrivacy:function(){if(!this.props.isMultichat)return (n.createElement(y,{onclick:this._togglePrivacyFunc},this.props.privacyText));return null;},_renderMuteConversation:function(){if(!this.props.isMuted){var ca=l.showMuteChangeDialog.bind(null,this.props.threadID,null);return (n.createElement(y,{onclick:ca},v._("Silenciar conversaci\u00f3n...")));}else return (n.createElement(y,{onclick:this._unmuteThread},v._("Reactivar conversaci\u00f3n")));},_renderClearConversation:function(){if(!this.props.isMultichat)return (n.createElement(y,{onclick:this.props.clearHistoryFunc},v._("Borrar contenido de la ventana")));return null;},_renderReportSpam:function(){if(!this.props.isMultichat)return (n.createElement(y,{onclick:this.props.reportSpamFunc},v._("Reportar como spam o abuso...")));return null;},_renderCreateGroup:function(){if(this.props.isMultichat)return (n.createElement(y,{onclick:this.props.createGroupFunc},v._("Crear grupo")));return null;},_renderSwitchToWork:function(){if(this.props.hasSwitchToWork)return (n.createElement(y,{onclick:this.props.switchToWorkFunc},v._("Mover a cuenta laboral")));},_renderConversationName:function(){if(this.props.isMultichat&&this.state.url)return (n.createElement(y,{onclick:this.props.nameConversationFunc},v._("Editar el nombre de la conversaci\u00f3n")));return null;},_renderLeaveConversation:function(){if(this.props.isMultichat)return (n.createElement(y,{onclick:this.props.leaveConversationFunc},v._("Abandonar la conversaci\u00f3n...")));return null;},_renderEnableDesktopNotifications:function(){if(i.DesktopNotificationsGK&&"Notification" in window&&Notification.permission!=="granted")return (n.createElement(y,{onclick:this.props.enableDesktopNotif},v._("Enable Desktop Notifications")));return null;},_renderPeopleList:function(){if(this.props.isMultichat&&this.state.url)return (n.createElement(y,{onclick:this.props.showParticipantsFunc},v._("Editar participantes...")));return null;},render:function(){var ca=this._renderReportSpam(),da=this._renderCreateGroup(),ea=n.createElement(p,{className:(("chatReact")+(!this.props.show?' '+"hidden_elem":''))},this._renderOpenFullConversation(),this._renderFileUploader(),this._renderAddFriend(),this._renderTogglePrivacy(),this._renderConversationName(),this._renderPeopleList(),n.createElement(q,null),this._renderSwitchToWork(),this._renderMuteConversation(),this._renderClearConversation(),this._renderLeaveConversation(),ca?(n.createElement(q,null)):null,ca,da?(n.createElement(q,null)):null,da,this._renderEnableDesktopNotifications()),fa=v._("Opciones"),ga=s.getTrackingInfo(s.types.DROPDOWN_BUTTON);return (n.createElement(o,{menu:ea},n.createElement("a",{"data-ft":ga,"data-hover":"tooltip","aria-label":fa,"data-tooltip-alignh":"center",className:(("button")+(this.props.isEmptyChat?' '+"hidden_elem":''))})));}});e.exports=ba;},null);
__d("ChatDateBreak.react",["React","Timestamp.react","cx","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=g,m=l.PropTypes,n=g.createClass({displayName:"ChatDateBreak",propTypes:{date:m.instanceOf(Date).isRequired},shouldComponentUpdate:function(o){return this.props.date.getTime()!==o.date.getTime();},render:function(){var o=this.props.date,p=j(o,{today:'g:ia',withinWeek:'l g:ia',thisYear:'F jS, g:ia',older:'F j, Y g:i a'}),q=Math.round(o.getTime()/1000);return (g.createElement("div",g.__spread({},this.props,{className:k(this.props.className,"_5w-5")}),g.createElement("div",{className:"_5w-6"},g.createElement(h,{time:q,verbose:p,text:p}))));}});e.exports=n;},null);
__d("ChatAuthorPhotoBlock.react",["MercuryParticipants","React","cx","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=h,m=l.PropTypes,n=86400000,o=h.createClass({displayName:"ChatAuthorPhotoBlock",propTypes:{authorID:m.string.isRequired,hideName:m.bool,hidePhoto:m.bool,timestamp:m.number},getInitialState:function(){return {author:{id:null,name:'',href:'#',image_src:''}};},componentDidMount:function(){this.updateAuthor(this.props.authorID);},componentWillReceiveProps:function(p){if(p.authorID!=this.state.author.id)this.updateAuthor(p.authorID);},render:function(){return (h.createElement("div",h.__spread({},this.props,{className:k(this.props.className,"_5yt9")}),this.renderAuthorName(),this.renderAuthorPhoto(),this.props.children));},renderAuthorName:function(){if(!this.props.hideName)return (h.createElement("div",{className:"_5ys-",ref:"name"},this.state.author.name));},renderAuthorPhoto:function(){if(!this.props.hidePhoto){var p=null;if(this.props.timestamp){var q=(Date.now()-this.props.timestamp>n)?'M jS, g:ia':'g:ia';p=j(new Date(this.props.timestamp),q);}return (h.createElement("a",{"aria-label":p,className:"_5ys_","data-hover":"tooltip","data-tooltip-position":"left",href:this.state.author.href,ref:"link"},h.createElement("img",{src:this.state.author.image_src,ref:"image"})));}},updateAuthor:function(p){g.get(p,function(q){this.isMounted()&&this.setState({author:q});}.bind(this));}});e.exports=o;},null);
__d("MessageBubbleMixin",["DOMDimensions","MercuryConfig","React"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=2,k={getInitialState:function(){return {bubbleWidth:null};},componentDidMount:function(){this._restyleBubble(this.props);},componentDidUpdate:function(l){if(l.maxWidth!==this.props.maxWidth||l.body!==this.props.body)this._restyleBubble(l);},_restyleBubble:function(l){if(this.props.attachments)return;var m=i.findDOMNode(this.refs.bubble);if(l.maxWidth!==this.props.maxWidth||g.getElementDimensions(m).width>this.props.maxWidth){var n=this.props.maxWidth;this.setState({bubbleWidth:n},this._shrinkBubble);return;}this._shrinkBubble();},_shrinkBubble:function(){var l=i.findDOMNode(this.refs.bubble),m=g.getElementDimensions(l).width,n=0,o=i.findDOMNode(this.refs.content);if(o){n=g.getElementDimensions(o).width;if(h.MercuryStoryAttachmentsGK||h.WWWMessengerComerceGK)n+=g.measureElementBox(i.findDOMNode(this.refs.contentWrapper),'width',true,false,false);}var p=n+j;if(n>0&&p<this.props.maxWidth&&m-p-this.getBoxWidth()>0)this.setState({bubbleWidth:p});}};e.exports=k;},null);
__d("ChatBubble.react",["DOMDimensions","MercuryConfig","MercuryMessageBody.react","MessageBubbleMixin","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=k,o=n.PropTypes,p=null,q=h.MercuryStoryAttachmentsGK||h.WWWMessengerComerceGK,r=k.createClass({displayName:"ChatBubble",mixins:[j],propTypes:{attachments:o.node,body:o.string,maxWidth:o.number.isRequired},_renderContent:function(){if(!this.props.body)return null;return (k.createElement("div",{className:((q?"_d97":'')),ref:"contentWrapper"},k.createElement("span",{className:"_5yl5",ref:"content"},k.createElement(i,{body:this.props.body,ranges:this.props.ranges}))));},render:function(){return (k.createElement("div",k.__spread({},this.props,{className:m((("_5w1r")+(!q?' '+"_d98":'')),this.props.className),ref:"bubble",style:{maxWidth:this.props.maxWidth,width:this.state.bubbleWidth}}),this._renderContent(),this.props.attachments));},contentWraps:function(){var s=k.findDOMNode(this.refs.content),t=s.getClientRects(),u=g.getElementDimensions(s).height;return (t&&t.length>1&&t[0].height<u);},getBoxWidth:function(){if(!p)p=g.measureElementBox(k.findDOMNode(this.refs.bubble),'width',true,true,false);return p;}});e.exports=r;},null);
__d("MercuryAttachments.react",["MercuryAttachmentRenderer","DOM","Event","ImmutableObject","React","SubscriptionsHandler","cx","emptyFunction","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';var p=k,q=p.PropTypes,r=176,s=4,t=k.createClass({displayName:"MercuryAttachments",propTypes:{attachments:q.array.isRequired,customPhotoWidth:q.number,maxWidth:q.number,message:q.instanceOf(j).isRequired,isChat:q.bool,onImageLoad:q.func,onStickerClick:q.func},getDefaultProps:function(){return {isChat:false,onImageLoad:n,onStickerClick:n};},componentDidMount:function(){this._subscriptionsHandler=new l();this.renderAttachments();},componentDidUpdate:function(){this.renderAttachments();},componentWillUnmount:function(){this._subscriptionsHandler.release();},render:function(){var u=this.props.attachments.filter(g.isPhotoAttachment).length>0;return (k.createElement("div",k.__spread({},this.props,{className:o(this.props.className,(("_5h9y")+(u?' '+"_zl6":'')))})));},renderAttachments:function(){var u=k.findDOMNode(this);h.empty(u);var v=this.props.message,w=g.sortAttachmentsStablyByType(this.props.attachments),x=this.props.customPhotoWidth||r,y=g.renderPhotoAttachments(w.filter(g.isPhotoAttachment),v,x,s,this.props.isChat);y&&h.appendContent(u,y);for(var z=0;z<w.length;z++){var aa=w[z];if(g.isPhotoAttachment(aa))continue;var ba=g.renderAttachment(this.props.isChat,aa,v,this.props.maxWidth,null,this.props.onStickerClick);ba.error&&h.appendContent(u,ba.error);ba.content&&h.appendContent(u,ba.content);}h.scry(u,'img').forEach(function(ca){this._subscriptionsHandler.addSubscriptions(i.listen(ca,'load',function(){this.props.onImageLoad(ca);}.bind(this)));}.bind(this));}});e.exports=t;},null);
__d("ChatMessage.react",["Bootloader","BootloadedComponent.react","ChatAnimatedGifs","ChatAuthorPhotoBlock.react","ChatBubble.react","ChatConfig","CSS","ImmutableObject","MercuryAttachment","MercuryAttachments.react","MercuryAttachmentRenderer","MercuryConfig","MercuryErrorInfo","MercuryIDs","MercuryMessageError.react","MercuryMessageInfo","React","cx","fbt","formatDate","isRTL","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba){b.__markCompiled&&b.__markCompiled();'use strict';var ca=w,da=ca.PropTypes,ea=w.createClass({displayName:"ChatMessage",propTypes:{message:da.instanceOf(n).isRequired,maxBubbleWidth:da.number.isRequired,onImageLoad:da.func,onStickerClick:da.func},componentDidMount:function(){m.conditionClass(w.findDOMNode(this),"_2cnu",this.isOneLine());},isOneLine:function(){var fa=this.props.message;return (v.isInbound(fa)&&!this.refs.attachmentsInside&&this.refs.bubble&&!this.refs.bubble.contentWraps());},shouldComponentUpdate:function(fa,ga){return fa.message!==this.props.message;},render:function(){var fa=this.props.message,ga=v.isInbound(fa),ha=t.isMultichat(fa.thread_id),ia=aa(fa.body),ja=l.get('chat_fading_bubbles')&&!ga&&v.isSending(fa),ka=s.hasErrorStatus(fa),la=(("_5wd4")+(ga?' '+"_1nc7":'')+(!ga?' '+"_1nc6":'')+(ga&&ha?' '+"_5ysy":'')+(ja?' '+"_4oe5":'')+(ka?' '+"_1zcs":'')+(ia?' '+"direction_rtl":'')+(!ia?' '+"direction_ltr":'')),ma=new Date(fa.timestamp);return (w.createElement(j,w.__spread({},this.props,{authorID:fa.author,className:ba(this.props.className,la),hideName:!ga||!ha,hidePhoto:!ga,timestamp:fa.timestamp,title:ga?null:z(ma,'g:ia')}),this._renderInner(),this._renderUndertext()));},_renderInner:function(){if(this.props.message.is_filtered_content)return (w.createElement("div",{className:"_5wd9",ref:"inner"},this._renderFilteredContent()));return (w.createElement("div",{className:"_5wd9",ref:"inner"},this._renderBubble(),this._renderAttachments('outside')));},_renderUndertext:function(){if(this.props.message.is_filtered_content)return null;return (w.createElement("div",{className:"_3ry4",ref:"undertext"},w.createElement(u,{className:"_5wda clearfix",message:this.props.message,ref:"status"}),this._renderSpoofWarning()));},_renderSpoofWarning:function(){return (this.props.message.is_spoof_warning?w.createElement(h,{bootloadPlaceholder:w.createElement("span",null),bootloadComponent:function(fa){g.loadModules(["MercurySpoofWarning.react"],fa);},authorID:this.props.message.author,className:"_5wdb"}):null);},_renderFilteredContent:function(){return w.createElement("div",{className:"_5wdc uiBoxYellow clearfix"},y._("Este mensaje ya no est\u00e1 disponible porque se identific\u00f3 como abusivo o se marc\u00f3 como spam."));},_renderAttachments:function(fa){var ga=this.props.message,ha=fa=='inside'?'attachmentsInside':'attachmentsOutside',ia=o.get(ga).filter(function(ja){var ka=q.isBubblePreferred(ja)&&!(r.MercuryImageBubblesGK&&(q.isPhotoAttachment(ja)||q.isVideoAttachment(ja))&&!ga.body);return (ka&&fa==='inside')||(!ka&&fa==='outside');});if(ia.length>0)return w.createElement(p,{className:"_5wdd clearfix",isChat:true,message:ga,attachments:ia,ref:ha,onImageLoad:this.props.onImageLoad,onStickerClick:this.props.onStickerClick,maxWidth:this.props.maxBubbleWidth});},_renderBubble:function(){var fa=this.props.message,ga=fa.body,ha=this._renderAttachments('inside'),ia=v.isInbound(fa);if(i.shouldHideBody(fa))ga='';if(ga||ha)return (w.createElement("div",{className:"_5wde"},w.createElement(k,{attachments:ha,body:ga,className:(("_5wdf")+(o.hasBubbleTail(fa,ia)?' '+"_3okg":'')),maxWidth:this.props.maxBubbleWidth,ranges:fa.ranges,ref:"bubble"})));}});e.exports=ea;},null);
__d("ChatVideoCallLink.react",["Arbiter","ChatVisibility","MercuryViewer","PresencePrivacy","React","SubscriptionsHandler","VideoCallCore","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=k,q=p.PropTypes,r=k.createClass({displayName:"ChatVideoCallLink",propTypes:{message:q.object.isRequired,onClick:q.func.isRequired},componentDidMount:function(){this._subscriptions=new l();this._subscriptions.addSubscriptions(g.subscribe(['buddylist/availability-changed'],this.availabilityChanged),j.subscribe(['privacy-changed','privacy-availability-changed'],this.availabilityChanged));},componentWillUnmount:function(){this._subscriptions.release();},render:function(){return (k.createElement("a",{className:(("callBackLink")+(this.shouldHideLink()?' '+"hidden_elem":'')),"data-gt":JSON.stringify({videochat:'clicked_callback_link'}),href:"#",onClick:this.linkClicked},this.renderLinkText()));},renderLinkText:function(){if(this.props.message.log_message_data.event_name=='install_canceled'){return (o._("Intenta instalar nuevamente y vuelve a llamar."));}else if(!this.props.message.log_message_data.event_name&&this.props.message.log_message_data.callee==i.getID()&&!this.props.message.log_message_data.answered)return (o._("Volver a llamar."));},shouldHideLink:function(){return !h.isOnline()||!m.availableForCall(this.props.message.log_message_data.to);},linkClicked:function(){var s;if(this.props.message.log_message_data.event_name=='install_canceled'){s='callback_cancelinstall_link';}else if(!this.props.message.log_message_data.event_name&&this.props.message.log_message_data.callee==i.getID()&&!this.props.message.log_message_data.answered)s='callback_link';this.props.onClick(this.props.message.log_message_data.to,this.props.message.thread_id,s);},availabilityChanged:function(){this.forceUpdate();}});e.exports=r;},null);
__d("MercuryLogMessage.react",["DOM","Event","ChatVideoCallLink.react","ImmutableObject","MercuryLogMessageRenderer","MercuryLogMessageType","React","VideoCallSupport","cx","emptyFunction","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();'use strict';var s=m,t=s.PropTypes,u=m.createClass({displayName:"MercuryLogMessage",propTypes:{maxWidth:t.number,message:t.instanceOf(j).isRequired,onImageLoad:t.func,onVideoCallLinkClick:t.func},getDefaultProps:function(){return {onImageLoad:p};},getInitialState:function(){return {messageText:null};},componentDidMount:function(){this.componentWillReceiveProps(this.props);},componentWillReceiveProps:function(v){k.renderText(v.message,function(w){this.setState({messageText:w});}.bind(this));},shouldComponentUpdate:function(v,w){return (this.state.messageText!=w.messageText||v.maxWidth!==this.props.maxWidth);},componentDidUpdate:function(){var v=m.findDOMNode(this.refs.attachment);k.renderAttachmentLegacy(v,this.props.message);g.scry(v,'img').forEach(function(w){var x=h.listen(w,'load',function(){this.props.onImageLoad(w);x.remove();}.bind(this));}.bind(this));},render:function(){return (m.createElement("div",m.__spread({},this.props,{className:r(this.props.className,"_5ye6"),style:Object.assign({},this.props.style,this._getStyle()),title:q(new Date(this.props.message.timestamp),'g:ia')}),k.renderIcon(this.props.message),m.createElement("div",{className:"_5ye7"},this.state.messageText,this.renderVideoCallLink()),m.createElement("div",{className:"_5ye8",ref:"attachment"})));},renderVideoCallLink:function(){if(this.props.message.log_message_type!==l.VIDEO_CALL||!this.props.onVideoCallLinkClick||!n.isVideoCallSupported())return null;return (m.createElement(i,{message:this.props.message,onClick:this.props.onVideoCallLinkClick}));},_getStyle:function(){return this.props.maxWidth?{maxWidth:this.props.maxWidth}:null;}});e.exports=u;},null);
__d("ChatConversation.react",["ChatDateBreak.react","ChatMessage.react","ImmutableObject","MercuryActionType","MercuryLogMessage.react","P2PNUXRenderer.react","P2PGKValues","React","cx","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();'use strict';var q=n,r=q.PropTypes,s=1000*60*60,t=n.createClass({displayName:"ChatConversation",propTypes:{maxBubbleWidth:r.number.isRequired,messages:r.arrayOf(r.instanceOf(i)).isRequired,onCallLinkClick:r.func,onImageLoad:r.func,onStickerClick:r.func},componentWillReceiveProps:function(u){p(u.maxBubbleWidth===this.props.maxBubbleWidth);},render:function(){var u=this.props.messages,v=[];for(var w=0;w<u.length;w++){var x=u[w],y=(w>0)?u[w-1]:null;if(x.is_cleared)continue;if(!y||y.is_cleared||x.timestamp-y.timestamp>s)v.push(n.createElement(g,{date:new Date(x.timestamp),key:'db:'+x.message_id}));if(x.action_type==j.LOG_MESSAGE){v.push(n.createElement(k,{className:"_5w0o",key:x.message_id,message:x,onImageLoad:this.props.onImageLoad,onCallLinkClick:this.props.onCallLinkClick}));}else{v.push(n.createElement(h,{key:x.message_id,message:x,maxBubbleWidth:this.props.maxBubbleWidth,onImageLoad:this.props.onImageLoad,onStickerClick:this.props.onStickerClick}));if(!m.WebBubbleV2&&l.isValidNUXMessage(x))v.push(n.createElement(l,{key:'onr_c:'+x.message_id,message:x,onImageLoad:this.props.onImageLoad,type:"chat"}));}}return n.createElement("div",null,v);}});e.exports=t;},null);
__d("MercuryMessageList",["immutable","LogHistory","Map","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=h.getInstance('mercury_message_list');function l(n){this.$MercuryMessageList0=g.List(n||[]);this.$MercuryMessageList1();}l.prototype.append=function(n){var o;this.$MercuryMessageList0=(o=this.$MercuryMessageList0).push.apply(o,n);this.$MercuryMessageList1();m('append',n);};l.prototype.prepend=function(n){var o;this.$MercuryMessageList0=(o=this.$MercuryMessageList0).unshift.apply(o,n);this.$MercuryMessageList1();m('prepend',n);};l.prototype.update=function(n){var o=n.filter(function(p){return this.contains(p);}.bind(this));if(o.length===0)return;this.$MercuryMessageList0=this.$MercuryMessageList0.withMutations(function(p){o.forEach(function(q){var r=this.$MercuryMessageList2.get(q.message_id);if(r!==(void 0))p.set(r,q);}.bind(this));}.bind(this));m('update',o);};l.prototype.reorder=function(n){this.$MercuryMessageList0=g.List(n);this.$MercuryMessageList1();m('reorder',n);};l.prototype.hasReachedClearedMessages=function(){var n=this.$MercuryMessageList0.first();return !!(n&&n.is_cleared);};l.prototype.at=function(n){return this.$MercuryMessageList0.get(n);};l.prototype.contains=function(n){return this.$MercuryMessageList2.has(n.message_id);};l.prototype.toArray=function(){return this.$MercuryMessageList0.toArray();};l.prototype.toMap=function(){return new i(g.Seq(this.$MercuryMessageList0).map(function(n){return [n.message_id,n];}));};l.prototype.$MercuryMessageList1=function(){this.$MercuryMessageList2=new i(g.Seq(this.$MercuryMessageList0).map(function(n,o){return [n.message_id,o];}));};function m(event,n){j(function(){k.debug(event,{messageIDs:n.map(function(o){return o.message_id;})});},0);}e.exports=l;},null);
__d("MercuryMessageStore",["MercuryAPIArgsSource","LogHistory","MercuryViewer","MercuryMessageList","SubscriptionsHandler","MercuryThreadlistConstants","copyProperties","merge","mixInEventEmitter","setTimeoutAcrossTransitions","MercuryMessages","MercuryThreadInformer","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();'use strict';var q=b('MercuryMessages').get(),r=b('MercuryThreadInformer').get(),s=b('MercuryThreads').get(),t=h.getInstance('mercury_message_store');function u(w,x){this.$MercuryMessageStore0=w;this.$MercuryMessageStore1=new j();this.$MercuryMessageStore2=1;this.$MercuryMessageStore3=null;this.$MercuryMessageStore4=0;this.$MercuryMessageStore5=x||l.RECENT_MESSAGES_LIMIT;this.$MercuryMessageStore6=new k();this.$MercuryMessageStore6.addSubscriptions(r.subscribe('messages-received',function(y,z){return this.$MercuryMessageStore8(z);}.bind(this)),r.subscribe('messages-updated',function(y,z){return z[this.$MercuryMessageStore0]&&this.$MercuryMessageStore9(z[this.$MercuryMessageStore0]);}.bind(this)),r.subscribe('messages-reordered',function(y,z){return z[this.$MercuryMessageStore0]&&this.$MercuryMessageStorea();}.bind(this)));t.debug('constructed',{threadID:this.$MercuryMessageStore0});this.$MercuryMessageStoreb();}u.prototype.setNewThreadID=function(w){this.$MercuryMessageStorec=w;};u.prototype.destroy=function(){this.$MercuryMessageStore6&&this.$MercuryMessageStore6.release();t.debug('destroyed',{threadID:this.$MercuryMessageStore0});};u.prototype.subscribe=function(w){return this.addRetroactiveListener('updated',w);};u.prototype.fetchMoreMessages=function(){if(q.hasLoadedExactlyNMessages(this.$MercuryMessageStore0,this.$MercuryMessageStore4)&&q.hasLoadedAllMessages(this.$MercuryMessageStore0))return false;if(s.isNewEmptyLocalThread(this.$MercuryMessageStore0))return false;if(this.$MercuryMessageStore1.hasReachedClearedMessages())return false;return this.$MercuryMessageStoreb();};u.prototype.$MercuryMessageStoreb=function(){var w=this.$MercuryMessageStore4+this.$MercuryMessageStore5*this.$MercuryMessageStore2;t.debug('fetching',{threadID:this.$MercuryMessageStore0,limit:w});q.getThreadMessagesRange(this.$MercuryMessageStore0,0,w,this.$MercuryMessageStored.bind(this),null,g.MERCURY);if(this.$MercuryMessageStore2<10)this.$MercuryMessageStore2+=1;if(q.hasLoadedNMessages(this.$MercuryMessageStore0,w)){this.$MercuryMessageStorea();return false;}return true;};u.prototype.$MercuryMessageStored=function(w){if(w&&w.length){this.$MercuryMessageStore3=w[0].timestamp;this.$MercuryMessageStore4=w.length;t.debug('fetched',{threadID:this.$MercuryMessageStore0,earliestMessageTimestamp:this.$MercuryMessageStore3,count:this.$MercuryMessageStore4});}else if(w&&!w.length&&!this.$MercuryMessageStore4)this.$MercuryMessageStoree(u.THREAD_IS_EMPTY);};u.prototype.$MercuryMessageStore8=function(w){var x=[],y=w[this.$MercuryMessageStore0];if(y&&y.length)x=x.concat(y);if(this.$MercuryMessageStorec){var z=w[this.$MercuryMessageStorec];if(z&&z.length){x=x.concat(z);this.$MercuryMessageStorec=null;}}if(x.length){this.$MercuryMessageStore1.append(x);this.$MercuryMessageStore4+=x.length;var aa=x.every(function(ba){return ba.author!=i.getID();});this.$MercuryMessageStoree(u.MESSAGES_RECEIVED,{allFromOthers:aa});}};u.prototype.$MercuryMessageStore9=function(w){this.$MercuryMessageStore1.update(q.getMessagesFromIDs(Object.keys(w)));this.$MercuryMessageStoref();this.$MercuryMessageStoree(u.MESSAGES_CHANGED);};u.prototype.$MercuryMessageStorea=function(){if(!this.$MercuryMessageStore3)return;this.$MercuryMessageStore1.reorder(q.getThreadMessagesSinceTimestamp(this.$MercuryMessageStore0,this.$MercuryMessageStore3));this.$MercuryMessageStoref();this.$MercuryMessageStoree(u.MESSAGES_REORDERED);};u.prototype.$MercuryMessageStoree=function(w,x){var y=this.$MercuryMessageStore1.toArray();this.releaseHeldEventType('updated');this.emitAndHold('updated',n({messages:y,eventType:w},x));v(this.$MercuryMessageStore0,w,y);};u.prototype.$MercuryMessageStoref=function(){var w=this.$MercuryMessageStore1.at(0);if(w)this.$MercuryMessageStore3=w.timestamp;};function v(w,x,y){p(function(){t.debug('update:'+x,{threadID:w,messageIDs:y.map(function(z){return z.message_id;})});},0);}m(u,{MESSAGES_FETCHED:'fetched',MESSAGES_CHANGED:'changed',MESSAGES_RECEIVED:'received',MESSAGES_REORDERED:'reordered',THREAD_IS_EMPTY:'thread-is-empty'});o(u,{updated:true});e.exports=u;},null);
__d("ChatTabMessagesView",["Animation","Arbiter","ArbiterMixin","BanzaiLogger","BootloadedComponent.react","Bootloader","ChatConfig","ChatConversation.react","ChatWelcomeMessage","CSS","DOM","Event","MercuryLastMessageIndicator.react","LiveTimer","MercuryViewer","MercuryMessageStore","React","ServerTime","StickerActions","StickerState","StickerStoreController","Style","SubscriptionsHandler","UserAgent_DEPRECATED","arrayContains","copyProperties","getElementPosition","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha){b.__markCompiled&&b.__markCompiled();'use strict';var ia=70,ja=null,ka=20;function la(na){if(ja===null){var oa=na.childNodes[0];ba.set(na,'overflow','scroll');ja=oa.clientWidth-ia;ba.set(na,'overflow','');}return ja;}function ma(na,oa,pa,qa,ra,sa,ta,ua){this.loadingIcon=ra;this.threadID=na;this.sheetController=oa;this.scrollContainer=pa;this.conversationElem=qa;this.tabView=ua;t.restart(x.get()/1000);this._loadingMoreMessages=false;function va(){ma.inform('interaction-with-tab',na);}this._subscriptions=new ca();this._subscriptions.addSubscriptions(h.subscribe('overflow-applied-to-body',this.scrollToBottom.bind(this)),r.listen(this.scrollContainer,'mousedown',va));if(da.firefox()){var wa=('WheelEvent' in window)?'wheel':'DOMMouseScroll';this.scrollContainer.addEventListener(wa,va,false);}else this._subscriptions.addSubscriptions(r.listen(this.scrollContainer,'mousewheel',va));this._subscriptions.addSubscriptions(r.listen(this.scrollContainer,'scroll',ha(this.scrolling,50,this)));if(m.get('chat_react')){var xa;w.render(w.createElement(k,{bootloadPlaceholder:w.createElement("span",null),bootloadComponent:function(za){l.loadModules(["ChatTypingIndicators.react"],za);},threadID:this.threadID,indicatorsWillShow:function(){return xa=this.isScrolledToBottom();}.bind(this),indicatorsDidShow:function(){return xa&&this.scrollToBottom(true);}.bind(this)}),ta);}else l.loadModules(["MercuryTypingIndicator"],function(za){this.typingIndicator=new za(this.threadID,ta,this);}.bind(this));var ya;this.lastMessageIndicatorNode=sa;this.lastMessageIndicator=w.render(w.createElement(s,{threadID:this.threadID,hideTyping:true,indicatorWillShow:function(){return ya=this.isScrolledToBottom();}.bind(this),indicatorDidShow:function(){return ya&&this.scrollToBottom(true);}.bind(this)}),this.lastMessageIndicatorNode);this.initializeConversation();}fa(ma,i);fa(ma.prototype,{initializeConversation:function(){this._store=new v(this.threadID);this._conversation=w.render(w.createElement(n,{maxBubbleWidth:la(this.scrollContainer),messages:[],onImageLoad:function(na){var oa=this.scrollContainer,pa=oa.scrollTop+oa.clientHeight;if(pa+na.offsetHeight>=oa.scrollHeight)this.scrollToBottom();}.bind(this),onStickerClick:this._onStickerClick.bind(this),onCallLinkClick:function(na,oa,pa){ma.inform('video-call-clicked',{userID:na,threadID:oa,clickSource:pa});}}),this.conversationElem);this._subscriptions.addSubscriptions(this._store.subscribe(function(na){if(na.eventType==v.MESSAGES_RECEIVED&&na.allFromOthers&&!this.isScrolledToBottom()){this.sheetController.openNewMessagesSheet();this._newMessagesSheetOpened=true;}if(na.eventType==v.MESSAGES_REORDERED){this._loadingMoreMessages=false;p.hide(this.loadingIcon);}var oa=this.isScrolledToBottom(),pa=this._getLoadingHeight(),qa=this.scrollContainer.scrollHeight,ra=this.scrollContainer.scrollTop,sa=na.messages,ta=o.getWelcomeMessage(this.threadID);if(ta)sa.push(ta);this._conversation.setProps({messages:sa},function(){if(oa||this._shouldScrollToBottom){this.scrollToBottom();this.setShouldScrollToBottom(false);}else if(na.eventType==v.MESSAGES_REORDERED)this.scrollToPosition(this.scrollContainer.scrollHeight-qa-pa+ra);}.bind(this));this.lastMessageIndicator.setProps({lastMessage:sa.length>0?sa[sa.length-1]:null});if(na.eventType==v.MESSAGES_RECEIVED&&this._shouldShowStickerReplyNUX(sa)&&this.tabView&&this.tabView.isFocused())this.tabView.showStickerReplyNUX();if(na.eventType==v.MESSAGES_CHANGED)this._checkToAnimateSticker();}.bind(this)));},setShouldScrollToBottom:function(na){this._shouldScrollToBottom=na;},scrolling:function(){this._checkToAnimateSticker();if(this.isScrolledNearTop()&&!this._loadingMoreMessages&&!this.isScrolledToBottom()&&!this.tabView._isDragDropActive)if(this._store.fetchMoreMessages()){p.show(this.loadingIcon);this._loadingMoreMessages=true;}if(!this._newMessagesSheetOpened)return;if(this.isScrolledToBottom()){this.sheetController.closeNewMessagesSheet();this._newMessagesSheetOpened=false;}},getScrollTop:function(){return this.scrollContainer&&this.scrollContainer.scrollTop;},destroy:function(){q.scry(this.conversationElem,'.stickerContainer').forEach(function(na){return w.unmountComponentAtNode(na);});w.unmountComponentAtNode(this.conversationElem);this._subscriptions&&this._subscriptions.release();w.unmountComponentAtNode(this.lastMessageIndicatorNode);delete this.lastMessageIndicator;this._store&&this._store.destroy();this.destroyed=true;},_getLoadingHeight:function(){return this.loadingHeight||this.loadingIcon.clientHeight;},_shouldShowStickerReplyNUX:function(na){if(!z.shouldShowStickerReplyNUX()||!na.length)return false;var oa=na[na.length-1];if(oa.author===u.getID())return false;if(oa.has_attachment)return oa.attachments.some(function(pa){return pa.attach_type==='sticker';});return false;},isScrolledToBottom:function(na){var oa=this.scrollContainer;na=na||ka;return oa.scrollTop+oa.clientHeight>=oa.scrollHeight-na;},isScrolledNearTop:function(){return this.scrollContainer.scrollTop<this.scrollContainer.clientHeight;},scrollToBottom:function(na){this.scrollToPosition(this.scrollContainer.scrollHeight,na);},scrollToPosition:function(na,oa){this._scrollTopAnimation&&this._scrollTopAnimation.stop();if(oa===true){this._scrollTopAnimation=(new g(this.scrollContainer)).to('scrollTop',na).ease(g.ease.end).duration(400).go();}else this.scrollContainer.scrollTop=na;},_onStickerClick:function(na,oa){if(!na)return;j.log('StickersLoggerConfig',{event:'click_sticker',packid:na,stickerid:oa});var pa=this.tabView;z.onTrayDataReady(function(){if(ea(z.getPackIDsInTray(),na)){var qa=z.getPack(na);if(qa&&qa.isPromoted)y.addPack(na);pa.setStickersFlyoutPackID(na);}else aa.showStore(na);});},_checkToAnimateSticker:function(){var na=ga(this.scrollContainer);h.inform('chatScrolled/'+this.threadID,{scrollTop:this.scrollContainer.scrollTop,top:na.y,viewHeight:na.height});},setNewThreadID:function(na){this._store.setNewThreadID(na);}});e.exports=ma;},null);
__d("ChatTabOfficeStatus",["fbt","formatDate","CSS"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=1,k=2,l=3,m={update:function(n,o){if(!n||!o||!o.officeStatus)return;this._updateIcon(n,o);this._updateTooltip(n,o);},_updateIcon:function(n,o){i.removeClass(n,'officeStatusNone');i.removeClass(n,'officeStatusAvailable');i.removeClass(n,'officeStatusSporadic');i.removeClass(n,'officeStatusOutOfOffice');switch(o.officeStatus){case j:i.addClass(n,'officeStatusAvailable');break;case k:i.addClass(n,'officeStatusSporadic');break;case l:i.addClass(n,'officeStatusOutOfOffice');break;default:i.addClass(n,'officeStatusNone');break;}},_updateTooltip:function(n,o){var p='';switch(o.officeStatus){case j:p+=g._("DISPONIBLE");p+='\n';break;case k:p+=g._("ESPOR\u00c1DICO");p+='\n';break;case l:p+=g._("NO DISPONIBLE");p+='\n';break;default:p+=g._("DESCONOCIDO");p+='\n';break;}if(o.officeStatusComment)p+=o.officeStatusComment;if(o.officeStatusLocation)p+=' ('+o.officeStatusLocation+')';if(o.officeStatusComment||o.officeStatusLocation)p+='\n';if(o.officeStatusEndDate){var q=h(o.officeStatusEndDate,'M d, Y');p+=g._("Hasta el {date}",[g.param("date",q)]);}n.setAttribute('aria-label',p);n.setAttribute('data-hover','tooltip');}};e.exports=m;},null);
__d("ChatAddFriendsTabSheetRawRenderer",["ChatConfig","ChatTabTypeaheadRenderer","ContextualTypeaheadView","DOM","Event","MercuryConfig","MercuryDataSourceWrapper","MercuryTypeahead","ChatTabTemplates","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();var q={render:function(r,s,t,u,v,w){var x=w?o[':fb:mercury:chat:tab-sheet:add-friends-empty-tab'].build():o[':fb:mercury:chat:tab-sheet:add-friends'].build(),y={};if(l.MercuryDataSourceProcessor){y=w?m.chat_typeahead_source:m.chat_add_people_source;y.setShowThreads(w);}else if(w){y=m.source;}else y=m.add_people_source;var z=new n(y,i);z.setViewOption('renderer',h);z.setExcludedParticipantsFromThreadMeta(u);if(!w){var aa=g.get('IsWorkUser',false)?p._("Agregar compa\u00f1eros de trabajo a este chat"):p._("Agregar amigos a este chat");z.setPlaceholder(aa);}z.build();j.replace(x.getNode('participantsTypeahead'),z.getElement());j.setContent(t,x.getRoot());z.getTokenizer().adjustWidth();var ba=x.getNode('participantsTypeahead').getAttribute('data-labelid'),ca=j.scry(z.getElement(),'input[type="text"]')[0];if(ca)if(ba){ca.setAttribute('aria-labelledby',ba);}else ca.setAttribute('aria-label',p._("Para"));z.focus();if(!w){var da=function(){var ea=z.getSelectedParticipantIDs();if(ea.length)v(ea);s.close(r);};k.listen(x.getNode('doneButton'),'click',da);z.subscribe('tokens-return',function(){if(z.getTokens().length)da();});}return z;}};e.exports=q;},null);
__d("MultiChatController",["AsyncSignal","ChatOpenTab","copyProperties","Form","MercuryIDs","MercuryLocalIDs","MercuryServerRequests","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=b('MercuryServerRequests').get(),n=b('MercuryThreads').get();function o(){}i(o,{subscribe:function(p,q){p.subscribe('confirm',function(){this.createGroupThreadFromChooserDialog(p,q);}.bind(this));},createGroupThreadFromChooserDialog:function(p,q){var r=j.serialize(p.getRoot()),s=JSON.parse(r.profileChooserItems),t=[];for(var u in s)if(s[u])t.push(u);var v=o.createThreadForFBIDs(t);m.subscribe('update-thread-ids',function(w,x){for(var y in x)if(x[y]==v)new g('/ajax/groups/chat/log',{group_id:q,message_id:y}).send();});p.hide();},createThreadForTokens:function(p){if(!p.length)return;var q=p.length===1?k.getThreadIDFromUserID(p[0].split(':')[1]):l.generateThreadID();n.createNewLocalThread(q,p);h.openThread(q,'MultiChatController');},createThreadForFBIDs:function(p){var q=[];for(var r=0;r<p.length;r++)q.push("fbid:"+p[r]);return o.createThreadForTokens(q);}});e.exports=o;},null);
__d("ChatAddFriendsTabSheet",["ArbiterMixin","BanzaiLogger","ChatAddFriendsTabSheetRawRenderer","ChatConfig","ChatOpenTab","ChatTabActions","MercuryConfig","MercuryLogMessageType","MercurySourceType","MercuryTypeaheadConstants","MultiChatController","Style","copyProperties","MercuryMessageObject","MercuryMessageActions","MercuryThreadActions","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();var t=b('MercuryMessageObject').get(),u=b('MercuryMessageActions').get(),v=b('MercuryThreadActions').get(),w=b('MercuryThreads').get();function x(ba,ca,da,ea){this._threadID=ba;this._rootElement=ca;this._sheetView=da;this._typeahead=null;this._chatTabView=ea;}s(x.prototype,g,{render:function(){w.getThreadMeta(this._threadID,function(ba){var ca=ba.is_canonical_user?y:z,da=w.isNewEmptyLocalThread(this._threadID);this._typeahead=i.render(this,this._sheetView,this._rootElement,ba,ca.bind(null,ba),da);this._typeahead.subscribe('tokens-changed',function(){if(m.MercuryDataSourceProcessor){if(da)aa(this,this._typeahead,this._threadID,this._chatTabView);}else this.inform('chat/tokens-changed',{token_count:this._typeahead.getTokens().length});}.bind(this));this._typeahead.subscribe('resize',function(){this._sheetView.resize();}.bind(this));}.bind(this));},getParticipants:function(){if(!this._typeahead)return null;return this._typeahead.getSelectedParticipantIDs();},isPermanent:function(){return true;},isSheetWithInput:function(){return true;},getType:function(){return 'add_friends_type';},open:function(){this._sheetView.open(this);},close:function(){this._sheetView.close(this);},getHeight:function(){return r.get(this._rootElement,'height');}});function y(ba,ca){var da=ba.participants;q.createThreadForTokens(da.concat(ca));}function z(ba,ca){var da=ba.thread_id;if(w.isEmptyLocalThread(da)){v.addParticipants(da,ca);}else u.send(t.constructLogMessageObject(o.CHAT_WEB,da,n.SUBSCRIBE,{added_participants:ca}));k.openThread(da,'ChatAddFriendsTabSheet');}function aa(ba,ca,da,ea){var fa=ca.getTypeahead().getData(),ga=ca.getTokens(),ha=ca.getTypeahead().getCore();ha.getElement().removeAttribute('disabled');fa.setShowThreads(ga.length===0);var ia=ga.length==1&&ga[0].getInfo().render_type===p.THREAD_TYPE;if(ia){var ja=ga[0].getInfo().mercury_thread;if(ja){var ka=j.get('chat_react_share_uploader')?ea._sharePreview.getShareData():ea._shareLinkUploader.getShareData();if(ka)var la=j.get('chat_react_share_uploader')?function(ma){return ma.loadShareFromParams(ka.share_type,ka.share_params);}:function(ma){return ma.loadShareFromParams(ka.type,ka.params);};k.openThread(ja.thread_fbid,'openGroupChat','',la);}h.log('MercuryQueryResultsLoggerConfig',{event:'chat_tab_group_thread_click'});l.closeTab(da,'open_group_chat');}else{if(ga.length==1&&ga[0].getInfo().render_type===p.PAGE_TYPE)ha.getElement().setAttribute('disabled','disabled');h.log('MercuryQueryResultsLoggerConfig',{event:'chat_tab_tokens_changed',chat_tab_tokens:ga.map(function(ma){return ma.info.uid;})});ba.inform('chat/tokens-changed',{token_count:ga.length});}}e.exports=x;},null);
__d("ChatNameConversationTabSheetRawRenderer",["DOM","Event","Input","Keys","ChatTabTemplates","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();"use strict";var m={render:function(n,o,p,q,r,s){var t=k[':fb:mercury:chat:tab-sheet:name-conversation'].build(),u=t.getNode('nameInput'),v=t.getNode('doneButton'),w=l._("Aceptar"),x=l._("Ocultar"),y=q.name;if(y){i.setValue(u,y);}else g.setContent(v,x);var z=function(){var aa=i.getValue(u);if(aa)r(aa);s();o.close(n);};h.listen(u,'input',function(){g.setContent(v,i.getValue(u).length===0?x:w);});h.listen(v,'click',z);h.listen(u,'keyup',function(aa){if(aa.keyCode===j.RETURN){z();return false;}});g.setContent(p,t.getRoot());!n.isAutomatic()&&u.focus();}};e.exports=m;},null);
__d("ChatNameConversationTabSheet",["AsyncRequest","ChatNameConversationTabSheetRawRenderer","MercuryAPIArgsSource","MercuryLogMessageType","MercurySourceType","MercuryMessageObject","MercuryMessageActions","MercuryServerRequests","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=b('MercuryMessageObject').get(),m=b('MercuryMessageActions').get(),n=b('MercuryServerRequests').get(),o=b('MercuryThreads').get(),p='/ajax/chat/multichat/name_conversation/dismiss.php',q={};function r(s,t,u){"use strict";this.$ChatNameConversationTabSheet0=s;this.$ChatNameConversationTabSheet1=t;this.$ChatNameConversationTabSheet2=u;this.$ChatNameConversationTabSheet3=false;}r.prototype.render=function(){"use strict";o.getThreadMeta(this.$ChatNameConversationTabSheet0,function(s){h.render(this,this.$ChatNameConversationTabSheet2,this.$ChatNameConversationTabSheet1,s,this.$ChatNameConversationTabSheet4.bind(null,s),this.$ChatNameConversationTabSheet5.bind(this,s));this.$ChatNameConversationTabSheet2.resize();}.bind(this));};r.prototype.isPermanent=function(){"use strict";return true;};r.prototype.isSheetWithInput=function(){"use strict";return true;};r.prototype.getType=function(){"use strict";return 'name_conversation_type';};r.prototype.open=function(s){"use strict";this.$ChatNameConversationTabSheet3=s;if(!(this.$ChatNameConversationTabSheet3&&this.$ChatNameConversationTabSheet6()))this.$ChatNameConversationTabSheet2.open(this);};r.prototype.close=function(){"use strict";this.$ChatNameConversationTabSheet2.close(this);};r.prototype.isAutomatic=function(){"use strict";return this.$ChatNameConversationTabSheet3;};r.prototype.$ChatNameConversationTabSheet6=function(){"use strict";return !!q[this.$ChatNameConversationTabSheet0];};r.prototype.$ChatNameConversationTabSheet7=function(){"use strict";q[this.$ChatNameConversationTabSheet0]=true;};r.prototype.$ChatNameConversationTabSheet5=function(s){"use strict";if(!s.name_conversation_sheet_dismissed||!this.$ChatNameConversationTabSheet6()){this.$ChatNameConversationTabSheet7();n.getServerThreadID(s.thread_id,function(t){new g(p).setData({thread_fbid:t}).send();});}};r.prototype.$ChatNameConversationTabSheet4=function(s,t){"use strict";var u=s.name;if((t||u)&&(t!=u))m.send(l.constructLogMessageObject(k.CHAT_WEB,s.thread_id,j.THREAD_NAME,{name:t}),null,i.CHAT);};e.exports=r;},null);
__d("ChatNewMessagesTabSheet",["Event","ArbiterMixin","DOM","ChatTabTemplates","copyProperties","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();function m(n,o,p){this._threadID=n;this._rootElement=o;this._sheetView=p;}k(m.prototype,h,{render:function(){var n=j[':fb:mercury:chat:tab-sheet:clickable-message-icon-sheet'].build();i.setContent(n.getNode('text'),l._("Despl\u00e1zate hacia abajo para ver los mensajes nuevos."));i.setContent(this._rootElement,n.getRoot());g.listen(n.getRoot(),'click',function(){this.inform('clicked',this._threadID);}.bind(this));},isPermanent:function(){return true;},isSheetWithInput:function(){return true;},getType:function(){return 'new_messages_type';},open:function(){this._sheetView.open(this);},close:function(){this._sheetView.close(this);}});e.exports=m;},null);
__d("ChatNoRecipientsTabSheet",["DOM","MercuryViewer","ChatTabTemplates","copyProperties","fbt","MercuryThreads","MercuryThreadInformer"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=b('MercuryThreads').get(),m=b('MercuryThreadInformer').get();function n(o,p,q){this._threadID=o;this._rootElement=p;this._sheetView=q;m.subscribe('threads-updated',this._handleThreadsUpdated.bind(this));}j(n.prototype,{render:function(){var o=i[':fb:mercury:chat:tab-sheet:message-icon-sheet'].build();g.setContent(o.getNode('text'),k._("Todos salieron de la conversaci\u00f3n."));g.setContent(this._rootElement,o.getRoot());},isPermanent:function(){return true;},getType:function(){return 'no_recipients_type';},_handleThreadsUpdated:function(){l.getThreadMeta(this._threadID,function(o){var p=h.getID(),q=o.participants.filter(function(r){return r!=p;});if(q.length<1&&!l.isNewEmptyLocalThread(this._threadID)){this._sheetView.open(this);}else this._sheetView.close(this);}.bind(this));}});e.exports=n;},null);
__d("ChatOfflineTabSheet",["ChatPrivacyActionController","ChatVisibility","CSS","DOM","JSXDOM","Event","JSLogger","MercuryIDs","MercuryParticipants","ChatTabTemplates","WorkModeConfig","copyProperties","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();function u(v,w,x){this._rootElement=w;this._sheetView=x;this._logger=m.create('blackbird');this._canonicalUser=n.getUserIDFromThreadID(v);if(this._canonicalUser)this._privacyActionController=new g(this._canonicalUser,this._handlePrivacyChange.bind(this));}r(u.prototype,{render:function(){if(!this._canonicalUser){this._logger.error('offline_sheet_open_with_non_friend');return;}var v=p[':fb:mercury:chat:tab-sheet:message-icon-sheet'].build(),w='fbid:'+this._canonicalUser;o.get(w,function(x){var y='fbChatGoOnlineLink',z=k.a({href:"#",className:y},t._("activa el chat")),aa;if(q.is_work_user){aa=t._("Para chatear con {name} y otros compa\u00f1eros de trabajo, {link}.",[t.param("name",x.short_name),t.param("link",z)]);}else aa=t._("Para chatear con {name} y otros amigos, {link}",[t.param("name",x.short_name),t.param("link",z)]);j.setContent(v.getNode('text'),aa);i.addClass(v.getRoot(),"_1sk1");j.setContent(this._rootElement,v.getRoot());l.listen(this._rootElement,'click',function(event){if(i.hasClass(event.getTarget(),y)){if(h.isOnline())this._logger.error('tab_sheet_already_online');this._privacyActionController.togglePrivacy();this._logger.log('tab_sheet_go_online',{tab_id:this._canonicalUser});return false;}}.bind(this));this._sheetView.resize();}.bind(this));},_handlePrivacyChange:function(v){if(!this._canonicalUser)this._logger.error('user_blocked_sheet_privacy_changed_non_friend');switch(v){case g.OFFLINE:this._sheetView.open(this);break;case g.NORMAL:case g.BLOCKED:this._sheetView.close(this);break;}},isPermanent:function(){return true;},getType:function(){return 'offline_type';},destroy:function(){this._privacyActionController&&this._privacyActionController.destroy();}});e.exports=u;},null);
__d("ChatUploadWarningTabSheet",["DOM","ChatTabTemplates","fbt","copyProperties"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();function k(l,m,n){this._threadID=l;this._rootElement=m;this._sheetView=n;}j(k.prototype,{render:function(){var l=h[':fb:mercury:chat:tab-sheet:message-icon-sheet'].build();g.setContent(l.getNode('text'),i._("Por favor, espera a que se complete la subida antes de enviar tu mensaje."));g.setContent(this._rootElement,l.getRoot());},isPermanent:function(){return false;},getType:function(){return 'upload_warning_type';},open:function(){this._sheetView.open(this);},close:function(){this._sheetView.close(this);}});e.exports=k;},null);
__d("ChatReadOnlyTabSheet",["React","MercuryReadOnlyReason","cx","MercuryThreads"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=b('MercuryThreads').get();function k(l,m,n){"use strict";this.$ChatReadOnlyTabSheet0=l;this.$ChatReadOnlyTabSheet1=m;this.$ChatReadOnlyTabSheet2=n;}k.prototype.render=function(){"use strict";var l=h.getReason(j.getThreadMetaNow(this.$ChatReadOnlyTabSheet0));g.render(g.createElement("div",{className:"_87-"},l),this.$ChatReadOnlyTabSheet1);};k.prototype.isPermanent=function(){"use strict";return false;};k.prototype.getType=function(){"use strict";return 'chat-thread-is-read-only';};k.prototype.open=function(){"use strict";this.$ChatReadOnlyTabSheet2.open(this);};k.prototype.close=function(){"use strict";this.$ChatReadOnlyTabSheet2.open(this);};e.exports=k;},null);
__d("ChatEmployeeAwaySheet",["ArbiterMixin","DOM","mixin","ChatTabTemplates"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=i(g);for(var l in k)if(k.hasOwnProperty(l))n[l]=k[l];var m=k===null?null:k.prototype;n.prototype=Object.create(m);n.prototype.constructor=n;n.__superConstructor__=k;function n(o,p,q){"use strict";this.$ChatEmployeeAwaySheet0=o;this.$ChatEmployeeAwaySheet1=p;this.$ChatEmployeeAwaySheet2=q;}n.prototype.render=function(){"use strict";var o=j[':fb:mercury:employee-away-sheet'].build();h.setContent(this.$ChatEmployeeAwaySheet1,o.getRoot());};n.prototype.isPermanent=function(){"use strict";return true;};n.prototype.getType=function(){"use strict";return 'employee-away';};n.prototype.open=function(){"use strict";this.$ChatEmployeeAwaySheet2.open(this);};n.prototype.close=function(){"use strict";this.$ChatEmployeeAwaySheet2.close(this);};e.exports=n;},null);
__d("ChatUserBlockedTabSheet",["CSS","ChatPrivacyActionController","DOM","Event","GenderConst","JSLogger","MercuryIDs","MercuryParticipants","ChatTabTemplates","copyProperties","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();function s(t,u,v){this._rootElement=u;this._sheetView=v;this._logger=l.create('blackbird');this._canonicalUser=m.getUserIDFromThreadID(t);if(this._canonicalUser)this._privacyActionController=new h(this._canonicalUser,this._handlePrivacyChange.bind(this));}p(s.prototype,{render:function(){if(!this._canonicalUser){this._logger.error('user_blocked_sheet_open_with_non_friend');return;}var t=o[':fb:mercury:chat:tab-sheet:user-blocked'].build(),u='fbid:'+this._canonicalUser;n.get(u,function(v){var w=null;switch(v.gender){case k.FEMALE_SINGULAR:case k.FEMALE_SINGULAR_GUESS:w=r._("Desactivaste el chat para {name} pero igual puedes enviarle un mensaje.",[r.param("name",v.short_name)]);break;case k.MALE_SINGULAR:case k.MALE_SINGULAR_GUESS:w=r._("Desactivaste el chat para {name} pero igual puedes enviarle un mensaje.",[r.param("name",v.short_name)]);break;default:w=r._("Desactivaste el chat para {name} pero igual puedes enviarle un mensaje.",[r.param("name",v.short_name)]);}i.setContent(t.getNode('text'),w+' ');var x=r._("\u00bfActivar el chat para {name}?",[r.param("name",v.short_name)]);i.setContent(t.getNode('actionLink'),x);g.addClass(t.getRoot(),"_1sk0");i.setContent(this._rootElement,t.getRoot());j.listen(t.getNode('actionLink'),'click',this._privacyActionController.togglePrivacy.bind(this._privacyActionController));this._sheetView.resize();}.bind(this));},_handlePrivacyChange:function(t){if(!this._canonicalUser)this._logger.error('user_blocked_sheet_privacy_changed_non_friend');if(t==h.BLOCKED){var u='fbid:'+this._canonicalUser;n.get(u,function(v){if(v.is_friend){this._sheetView.open(this);}else this._sheetView.close(this);}.bind(this));return;}this._sheetView.close(this);},isPermanent:function(){return true;},getType:function(){return 'user_blocked_type';},destroy:function(){this._privacyActionController&&this._privacyActionController.destroy();}});e.exports=s;},null);
__d("ChatTabSheetController",["ChatAddFriendsTabSheet","ChatNameConversationTabSheet","ChatNewMessagesTabSheet","ChatNoRecipientsTabSheet","ChatOfflineTabSheet","ChatUploadWarningTabSheet","ChatReadOnlyTabSheet","ChatThreadIsMutedTabSheet","ChatEmployeeAwaySheet","ChatUserBlockedTabSheet","MercuryIDs","MercurySheetView","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();var t=function(u,v,w,x){this._sheetView=new r(u,v,w);this._addFriendsTabSheet=new g(u,v,this._sheetView,x);this._nameConversationTabSheet=new h(u,v,this._sheetView);this._userBlockedTabSheet=new p(u,v,this._sheetView);this._offlineTabSheet=new k(u,v,this._sheetView);this._newMessagesTabSheet=new i(u,v,this._sheetView);this._uploadWarningTabSheet=new l(u,v,this._sheetView);this._threadIsMutedTabSheet=new n(u,v,this._sheetView);this._employeeAwaySheet=new o(u,v,this._sheetView);this._readOnlyTabSheet=new m(u,v,this._sheetView);if(!q.getUserIDFromThreadID(u))this._noRecipientsTabSheet=new j(u,v,this._sheetView);};s(t.prototype,{openAddFriendsSheet:function(){this._addFriendsTabSheet.open();},getAddFriendsTabSheet:function(){return this._addFriendsTabSheet;},getAddFriendsParticipants:function(){var u=this._addFriendsTabSheet.getParticipants();this._addFriendsTabSheet.close();return u;},openNameConversationSheet:function(u){this._nameConversationTabSheet.open(u);},openReadOnlySheet:function(){this._readOnlyTabSheet.open();},openNewMessagesSheet:function(){this._newMessagesTabSheet.open();},openUploadWarningTabSheet:function(){this._uploadWarningTabSheet.open();},openThreadIsMutedTabSheet:function(){this._threadIsMutedTabSheet.open();},openEmployeeAwaySheet:function(){this._employeeAwaySheet.open();},closeAutomaticNameConversationSheet:function(){if(this._nameConversationTabSheet.isAutomatic())this._nameConversationTabSheet.close();},closeThreadIsMutedTabSheet:function(){this._threadIsMutedTabSheet.close();},closeNewMessagesSheet:function(){this._newMessagesTabSheet.close();},closeUploadWarningTabSheet:function(){this._uploadWarningTabSheet.close();},onClickNewMessagesSheet:function(u){this._newMessageClickSub=this._newMessagesTabSheet.subscribe('clicked',u);},onClickThreadIsMutedSheet:function(u){this._threadIsMutedClickSub=this._threadIsMutedTabSheet.subscribe('clicked',u);},onResize:function(u){this._sheetView.subscribe('resize',u);},onTokensChanged:function(u){this._addFriendsTabSheet.subscribe('chat/tokens-changed',u);},destroy:function(){this._sheetView&&this._sheetView.destroy();this._offlineTabSheet&&this._offlineTabSheet.destroy();this._userBlockedTabSheet&&this._userBlockedTabSheet.destroy();this._newMessageClickSub&&this._newMessageClickSub.unsubscribe();this._threadIsMutedClickSub&&this._threadIsMutedClickSub.unsubscribe();}});e.exports=t;},null);
__d("ChatTitleLink.react",["Link.react","MercuryThreadTitle.react","React","TrackingNodes","cx"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();"use strict";var l=i,m=l.PropTypes,n=i.createClass({displayName:"ChatTitleLink",propTypes:{href:m.string,isNewThread:m.bool,thread:m.object,viewer:m.string},getDefaultProps:function(){return {href:null};},getTitle:function(){return this.refs.threadTitle.getTitle();},render:function(){if(!this.props.thread)return null;return (i.createElement(g,{"aria-level":"3",className:(("titlebarText")+(this.props.href===null?' '+"noLink":'')),"data-ft":j.getTrackingInfo(j.types.TITLE),"data-hover":"tooltip",href:this.props.href},i.createElement(h,{ref:"threadTitle",isNewThread:this.props.isNewThread,thread:this.props.thread,useAndSeparator:true,useShortName:!this.props.thread.is_canonical,viewer:this.props.viewer})));}});e.exports=n;},null);
__d("ChatVideoCallButton.react",["Link.react","ReactComponentWithPureRenderMixin","React","TrackingNodes","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();"use strict";var m=i,n=m.PropTypes,o=i.createClass({displayName:"ChatVideoCallButton",mixins:[h],propTypes:{onClick:n.func,onKeyUp:n.func,shown:n.bool,tooltipLabel:n.string},getDefaultProps:function(){return {tooltipLabel:(l._("Iniciar una videollamada"))};},render:function(){var p=j.getTrackingInfo(j.types.VIDEOCHAT),q=JSON.stringify({videochat:'call_clicked_bhat_tab'});return (i.createElement(g,{"aria-label":this.props.tooltipLabel,className:(("videoicon")+(' '+"button")+(!this.props.shown?' '+"hidden_elem":'')),"data-ft":p,"data-gt":q,"data-hover":"tooltip","data-tooltip-position":"above",onClick:this.props.onClick,onKeyUp:this.props.onKeyUp}));}});e.exports=o;},null);
__d("EmoticonUtils",["EmoticonsList","Parent"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i='emoticon_',j=g.symbols,k={getEmoteFromTarget:function(l){var m=h.byClass(l,'emoticon');if(!m)return null;var n=null;m.className.split(' ').forEach(function(o){if(o.startsWith(i))n=o.substring(i.length);});return j[n]||null;},insertEmoticon:function(l,m,n){var o=m.substring(0,n.start),p=m.substring(n.end);if(n.start>0&&!o.endsWith(' '))l=' '+l;if(!p.startsWith(' '))l+=' ';var q=o+l+p;n.start+=l.length;n.end=n.start;return {result:q,start:n.start,end:n.end};}};e.exports=k;},null);
__d("MercurySharePreview.react",["AsyncRequest","LeftRight.react","LoadingIndicator.react","MercuryFallbackShareAttachment.react","MercuryShareAttachmentRenderLocations","React","XUICloseButton.react","cx","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=l,q=p.PropTypes,r=l.createClass({displayName:"MercurySharePreview",propTypes:{imageSize:q.shape({width:q.number.isRequired,height:q.number.isRequired}).isRequired,location:q.oneOf(k.getValues()).isRequired,share:q.shape({params:q.array,type:q.number}),uri:q.string,onClose:q.func,onUpdate:q.func},getInitialState:function(){return {attachmentData:null,loading:false};},componentWillMount:function(){this._requestID=1337;this._currentRequest=null;},componentWillUnmount:function(){this._reset();},componentWillReceiveProps:function(s){o(!(s.share&&s.uri));if(!s.share&&!s.uri)return this._reset();var t=this.state.attachmentData||this.state.loading;if(s.share&&!t){this._loadFromShare(s.share);}else if(s.uri&&!(t&&this.props.uri==s.uri))this._loadFromURI(s.uri);},componentDidUpdate:function(s,t){this.props.onUpdate&&this.props.onUpdate(this);},getShareData:function(){return this.state.attachmentData&&this.state.attachmentData.share_data;},isLoading:function(){return this.state.loading;},_loadFromShare:function(s){this._currentRequest=new g().setURI('/message_share_attachment/fromParams/').setData({image_height:this.props.imageSize.height,image_width:this.props.imageSize.width,share_params:s.params,share_type:s.type}).setHandler(this._onShareLoaded.bind(this,this._getNextRequestID()));this._currentRequest.send();this.setState({loading:true,attachmentData:null});},_loadFromURI:function(s){this._currentRequest=new g().setURI('/message_share_attachment/fromURI/').setData({image_height:this.props.imageSize.height,image_width:this.props.imageSize.width,uri:s}).setHandler(this._onShareLoaded.bind(this,this._getNextRequestID()));this._currentRequest.send();this.setState({loading:true,attachmentData:null});},_getNextRequestID:function(){return (++this._requestID);},_getCurrentRequestID:function(){return this._requestID;},_onShareLoaded:function(s,t){if(this._getCurrentRequestID()!==s)return;this.setState({loading:false,attachmentData:t.payload});},_close:function(){this._reset();this.props.onClose&&this.props.onClose();},_reset:function(){this._getNextRequestID();this._currentRequest&&this._currentRequest.abort();this._currentRequest=null;this.setState({loading:false,attachmentData:null});},render:function(){var s=(("_tig")+(' '+"_tih"));if(this.state.loading)return (l.createElement(h,{direction:h.DIRECTION.right,className:s},l.createElement(i,{className:"_tii",size:"large",color:"white"}),l.createElement(m,{className:"_tij",shade:"dark",size:"small",onClick:this._close})));var t=this.state.attachmentData;if(!t)return l.createElement("div",null);return (l.createElement("div",null,l.createElement(m,{className:"_tij",shade:"dark",size:"small",onClick:this._close}),l.createElement(j,{attachment:t,location:k.CHAT_PREVIEW})));}});e.exports=r;},null);
__d("P2PAddCreditCardDialog.react",["Link.react","P2PAPI","P2PAPIUtils","P2PCreditCardForm.react","P2PLoadingMask.react","P2PLinkConstants","React","XUIButton.react","XUIDialog.react","XUIDialogTitle.react","XUIDialogBody.react","XUIDialogFooter.react","XUIGrayText.react","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();'use strict';var w=m,x=w.PropTypes,y='fbP2PAddCreditCardDialog_learnMoreSentenceID',z=m.createClass({displayName:"P2PAddCreditCardDialog",propTypes:{asyncRequestState:x.object,onCancel:x.func,onDecline:x.func,onError:x.func,onSaving:x.func,onSuccess:x.func,showPayButton:x.bool},getDefaultProps:function(){return {asyncRequestState:{},onCancel:u,onDecline:u,onError:u,onSaving:u,onSuccess:u,showPayButton:false};},getInitialState:function(){return {declineAddCardShown:false,isValid:false,formData:{},loading:false,requestID:'',saveErrors:null};},componentWillReceiveProps:function(aa){var ba=aa.asyncRequestState?aa.asyncRequestState[this.state.requestID]:null;if(ba){this.setState({requestID:''});if(ba.error){this.handleOnSaveError(ba.error);}else this.handleOnSaveSuccess(ba);}},onSaveClick:function(){var aa=i.genRequestID();this.setState({loading:true,requestID:aa,saveErrors:null});this.props.onSaving();h.addCreditCard(Object.assign({requestID:aa},this.state.formData));},handleOnSaveSuccess:function(aa){this.props.onSuccess(aa);},handleOnSaveError:function(aa){this.setState({loading:false,saveErrors:aa});this.props.onError();},handleValidation:function(aa,ba){this.setState({isValid:aa,formData:ba});},isSaveButtonDisabled:function(){return this.state.loading||!this.state.isValid;},onToggle:function(aa){if(!aa)this.props.onCancel();},handleNoDebitCardClick:function(){this.setState({declineAddCardShown:true});},handleDeclineCardBackButtonClick:function(){this.setState({declineAddCardShown:false});},handleDeclineCardOkButtonClick:function(){this.setState({declineAddCardShown:false});this.props.onDecline();},getButtonType:function(){var aa='default';if(this.props.showPayButton)aa='confirm';return aa;},getButtonText:function(){var aa=v._("Guardar");if(this.props.showPayButton)aa=v._("Pagar");return aa;},renderDeclineAddCard:function(){return (m.createElement("div",{className:"_2hn6"},m.createElement(p,null,v._("\u00bfNo tienes una tarjeta de d\u00e9bito?")),m.createElement(q,null,m.createElement(s,{display:"block",shade:"medium",size:"small"},v._("Necesitas una tarjeta de d\u00e9bito para enviar pagos en los mensajes. Si no tienes una, no podr\u00e1s enviar pagos en este momento."))),m.createElement(r,null,m.createElement(n,{label:v._("Atr\u00e1s"),onClick:this.handleDeclineCardBackButtonClick,size:"medium",use:"default"}),m.createElement(n,{label:v._("Aceptar"),onClick:this.handleDeclineCardOkButtonClick,size:"medium",use:"default"}))));},renderAddCardForm:function(){return (m.createElement("div",{className:"_2hn6"},m.createElement(p,null,v._("Agregar una tarjeta de d\u00e9bito")),m.createElement(q,null,m.createElement(j,{onValidation:this.handleValidation,saveErrors:this.state.saveErrors}),m.createElement("div",{className:"_4v64",id:y},v._("Tu informaci\u00f3n de pago se guardar\u00e1 de forma segura. {Learn more about p2p link}",[v.param("Learn more about p2p link",m.createElement(g,{"aria-describedby":y,href:l.addDebitCardHelpURI,target:"_blank"},v._("M\u00e1s informaci\u00f3n.")))]))),m.createElement(r,{leftContent:m.createElement(g,{className:"_2hn7",href:"#",onClick:this.handleNoDebitCardClick},v._("\u00bfNo tienes una tarjeta de d\u00e9bito?"))},m.createElement(n,{use:this.getButtonType(),size:"medium",label:this.getButtonText(),disabled:this.isSaveButtonDisabled(),onClick:this.onSaveClick}))));},componentDidUpdate:function(){setTimeout(function(){this.refs.dialog&&this.refs.dialog.layer.updatePosition();}.bind(this));},render:function(){var aa;if(this.state.declineAddCardShown){aa=this.renderDeclineAddCard();}else aa=this.renderAddCardForm();return (m.createElement(o,{className:"_2hn8",layerHideOnBlur:false,ref:"dialog",onToggle:this.onToggle,shown:true,width:288},aa,m.createElement(k,{visible:this.state.loading})));}});e.exports=z;},null);
__d("P2PConfirmAmountDialog.react",["P2PLoadingMask.react","React","XUIButton.react","XUIDialog.react","XUIDialogBody.react","XUIDialogFooter.react","XUIDialogTitle.react","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=h,q=p.PropTypes,r=h.createClass({displayName:"P2PConfirmAmountDialog",propTypes:{amount:q.string,currencySymbol:q.string,onCancel:q.func,onConfirm:q.func,receiverName:q.string},getDefaultProps:function(){return {amount:'',currencySymbol:'',onCancel:n,onConfirm:n,receiverName:q.string};},getInitialState:function(){return {loading:false};},handleCancelClick:function(){this.props.onCancel();},handleConfirmClick:function(){this.setState({loading:true});this.props.onConfirm();},getFormattedAmount:function(){var s=this.props.amount,t=(parseFloat(s)).toFixed(2);return this.props.currencySymbol+''+t;},render:function(){return (h.createElement(j,{layerHideOnBlur:false,shown:true,width:300},h.createElement(m,{showCloseButton:false},o._("Confirmar pago")),h.createElement(k,null,o._("\u00bfQuieres pagar {amount} a {recipient name}?",[o.param("recipient name",this.props.receiverName),o.param("amount",this.getFormattedAmount())])),h.createElement(l,null,h.createElement(i,{label:o._("Cancelar"),onClick:this.handleCancelClick,use:"default"}),h.createElement(i,{label:o._("Pagar"),onClick:this.handleConfirmClick,use:"confirm"})),h.createElement(g,{visible:this.state.loading})));}});e.exports=r;},null);
__d("P2PSendMoneyAmountInput.react",["React","XUIError.react","XUIGrayText.react","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=g,n=m.PropTypes,o=10000,p=g.createClass({displayName:"P2PSendMoneyAmountInput",propTypes:{currencySymbol:n.string,onInputChange:n.func,value:n.string},getDefaultProps:function(){return {currencySymbol:'$',onInputChange:k,value:''};},getInitialState:function(){return {inputError:null,maxInputWidth:100,value:this.props.value,width:''};},componentDidMount:function(){this.updateWidth(this.state.value);},handleAmountInputChange:function(q){var r=q.target.value;this.clearInputError();this.updateAmount(r);},clearInputError:function(){this.setState({inputError:null});},setInputError:function(q){this.setState({inputError:q});},updateAmount:function(q){var r=true,s;q=q.replace(/[^0-9\.]+/g,'');s=parseFloat(q);if(s>=o){r=false;this.setInputError(l._("Ingresa un monto menor"));}var t=q.split('.'),u=t[0],v=t[1];if(v!==undefined){q=(u&&parseFloat(u)!==0?u:'0')+'.'+v.substr(0,2);}else if(u&&parseFloat(u)===0)q='0';this.setValue(q);s=parseFloat(q);r=r&&!isNaN(s)&&s>0;this.props.onInputChange(q,r);},setValue:function(q){this.setState({value:q},this.updateWidth);},updateWidth:function(){var q=this.getMockWidth();if(q)this.setState({width:Math.min(q,this.state.maxInputWidth)});},getMockWidth:function(){return g.findDOMNode(this.refs.mock_input).offsetWidth;},render:function(){return (g.createElement("div",{className:"_ipw"},g.createElement("label",null,g.createElement(i,{className:"_3-91",shade:"medium",size:"small",weight:"bold"},l._("Ingresa el monto")),g.createElement("div",{className:"_4puh"},g.createElement("div",{className:"_5fbp"},this.props.currencySymbol),g.createElement("div",{ref:"mock_input",className:"_5fbs"},this.state.value),g.createElement(h,{xuiError:this.state.inputError},g.createElement("input",{className:"_5fbv",onChange:this.handleAmountInputChange,ref:"textInput",style:{width:this.state.width},value:this.state.value}))))));}});e.exports=p;},null);
__d("P2PSendMoneyDialog.react",["Arbiter","CreditCardFormParam","Image.react","ImageBlock.react","Link.react","P2PAPI","P2PAddCreditCardDialog.react","P2PCreditCardStore","P2PChooseCreditCardForm.react","P2PConfirmAmountDialog.react","P2PLinkConstants","P2PLoadingMask.react","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PQEValues","P2PSendMoneyAmountInput.react","P2PVerifyCreditCardDialog.react","React","ReactLayeredComponentMixin","XUIButton.react","XUIContextualDialog.react","XUIGrayText.react","XUIText.react","cx","fbt","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){b.__markCompiled&&b.__markCompiled();'use strict';var ha=y,ia=ha.PropTypes,ja=fa._("Cambiar"),ka=fa._("Agregar una tarjeta de d\u00e9bito"),la=260,ma=100,na=y.createClass({displayName:"P2PSendMoneyDialog",mixins:[z],propTypes:{currency:ia.string,currencySymbol:ia.string,onAmountInputChange:ia.func,onBlur:ia.func,onError:ia.func,onToggle:ia.func,onSendSuccess:ia.func,receiver:ia.object,theme:ia.string},getDefaultProps:function(){return {currency:'USD',currencySymbol:'$',onAmountInputChange:ga,onBlur:ga,onError:ga,onSendClick:ga,onSendSuccess:ga,onToggle:ga,receiver:{},theme:''};},getInitialState:function(){var oa=n.getAll();return {asyncRequestState:n.getAsyncRequestState(),addCreditCardDialogShown:false,amount:'',creditCards:oa,confirmAmountDialogShown:false,isAmountValid:false,loading:false,selectedCard:oa[0],showChooseCreditCardForm:false,verifyCreditCardDialogShown:false};},passwordCancelSubscribeToken:null,log:function(oa,pa){s.log(oa,Object.assign({www_event_flow:u.UI_FLOW_P2P_SEND,object_id:this.props.receiver.userId},pa));},componentWillUnmount:function(){if(this.passwordCancelSubscribeToken!==null){g.unsubscribe(this.passwordCancelSubscribeToken);this.passwordCancelSubscribeToken=null;}if(this.creditCardStoreSub){this.creditCardStoreSub.remove();this.creditCardStoreSub=null;}},componentWillMount:function(){this.creditCardStoreSub=n.addListener('change',this.onCreditCardStoreChange);this.log(t.UI_ACTN_INITIATE_SEND);},onAmountInputChange:function(oa,pa){this.setState({amount:oa,isAmountValid:pa});},onCreditCardStoreChange:function(){var oa=n.getAll();this.setState({asyncRequestState:n.getAsyncRequestState(),creditCards:oa,selectedCard:!this.state.selectedCard?oa[0]:this.state.selectedCard});},shouldShowConfirmAmountDialog:function(){var oa=parseFloat(this.state.amount);return oa>=ma;},shouldShowVerifyCreditCardDialog:function(){return !this.state.selectedCard.getIsVerified();},handleSendClick:function(oa){if(this.isSendButtonDisabled())return false;this.log(t.UI_ACTN_SEND_CLICKED,{raw_amount:this.state.amount,currency:this.props.currency});this.initiatePayment();},initiatePayment:function(){if(this.shouldShowConfirmAmountDialog()){this.setState({addCreditCardDialogShown:false,confirmAmountDialogShown:true});this.log(t.UI_ACTN_CONFIRM_AMOUNT,{raw_amount:this.state.amount,currency:this.props.currency});return;}if(this.shouldShowVerifyCreditCardDialog()){this.setState({addCreditCardDialogShown:false,verifyCreditCardDialogShown:true});this.log(t.UI_ACTN_VERIFY_CSC,{raw_amount:this.state.amount,currency:this.props.currency});return;}this.createTransaction();},shouldShowLoading:function(){return (!this.state.addCreditCardDialogShown&&!this.state.confirmAmountDialogShown&&!this.state.verifyCreditCardDialogShown);},createTransaction:function(){var oa={};this.setState({loading:this.shouldShowLoading()});oa[h.CREDENTIAL_ID]=this.state.selectedCard.getCredentialId();oa.amount=this.state.amount;oa.receiverId=this.props.receiver.userId;this.passwordCancelSubscribeToken=g.subscribeOnce('PasswordReauthDialogCancelClick',this.handlePasswordReauthDialogCancelClick);l.createTransaction({formData:oa,error:this.setCreateTransferError,success:this.setCreateTransferSuccess});this.log(t.UI_ACTN_CONFIRM_SEND,{raw_amount:this.state.amount,currency:this.props.currency});},hideAllDialogs:function(){this.setState({addCreditCardDialogShown:false,confirmAmountDialogShown:false,verifyCreditCardDialogShown:false});},setCreateTransferError:function(oa){if(this.isMounted()){this.hideAllDialogs();this.setState({loading:false});}this.props.onError(oa);this.log(t.UI_ACTN_SEND_FAIL);},setCreateTransferSuccess:function(oa){if(this.isMounted()){this.setState({loading:false});this.hideAllDialogs();}this.props.onSendSuccess(oa);this.log(t.UI_ACTN_SEND_SUCCESS);},handlePasswordReauthDialogCancelClick:function(){this.passwordCancelSubscribeToken=null;this.setState({loading:false});},onAddCreditCardCancel:function(){this.setState({addCreditCardDialogShown:false});this.log(t.UI_ACTN_CANCEL_ADD_CARD);},onAddCreditCardSaving:function(){this.log(t.UI_ACTN_CONFIRM_CARD_DETAILS);},onAddCreditCardSuccess:function(oa){var pa=this.state.creditCards.filter(function(qa){var ra=qa.getCredentialId();return (oa[h.CREDENTIAL_ID]===ra);})[0];this.setState({selectedCard:pa});if(this.state.isAmountValid){this.initiatePayment();}else{this.setState({addCreditCardDialogShown:false});this.focusAmountInput();}this.log(t.UI_ACTN_ADD_CARD_SUCCESS);},onAddCreditCardError:function(){this.log(t.UI_ACTN_ADD_CARD_FAIL);},onAddCreditCardDecline:function(){this.setState({addCreditCardDialogShown:false});this.props.onBlur();},focusAmountInput:function(){if(this.refs.send_money_amount_input)y.findDOMNode(this.refs.send_money_amount_input).focus();},_onBlur:function(){this.props.onBlur();if(!this.state.loading)this.log(t.UI_ACTN_SEND_MONEY_CANCELLED);},handleAddCreditCardClick:function(){this.setState({addCreditCardDialogShown:true,showChooseCreditCardForm:false});},handleBackClick:function(){this.setState({showChooseCreditCardForm:false},function(){this.focusAmountInput();});},handleChooseCardNextClick:function(){var oa=this.refs.choose_credit_card_form.getSelectedCard();this.setState({selectedCard:oa,showChooseCreditCardForm:false},function(){this.focusAmountInput();});},handleAddCardNextClick:function(){this.setState({addCreditCardDialogShown:true});this.log(t.UI_ACTN_INITIATE_ADD_CARD);},handleChangeSelectedCardClick:function(){var oa={};if(this.state.creditCards.length===1){oa.addCreditCardDialogShown=true;}else oa.showChooseCreditCardForm=true;this.setState(oa);},onConfirmAmountCancel:function(){this.setState({confirmAmountDialogShown:false});},onConfirmAmountSuccess:function(){if(this.shouldShowVerifyCreditCardDialog()){this.setState({confirmAmountDialogShown:false,verifyCreditCardDialogShown:true});}else this.createTransaction();},onVerifyCreditCardSuccess:function(){this.createTransaction();},onVerifyCreditCardCancel:function(){this.setState({verifyCreditCardDialogShown:false});},isSendButtonDisabled:function(){return (!this.state.isAmountValid||!this.state.creditCards.length||this.state.loading);},isAddCardNextButtonDisabled:function(){return !this.state.isAmountValid;},renderAddDebitCardLink:function(){return (y.createElement("div",{ref:"send_money_dialog_add_card_text"},y.createElement(k,{className:"_49nm",href:"#",onClick:this.handleAddCreditCardClick},ka)));},renderSelectedCard:function(){var oa=this.state.selectedCard;return (y.createElement("div",{className:"_21x5"},y.createElement("div",{className:"_49nn"},oa.getName()),y.createElement("div",{className:"_21wx"},oa.getCreditCardNumberFormatted()),y.createElement("div",{className:"_21ww"},'\u00b7'),y.createElement(k,{className:"_21wy",onClick:this.handleChangeSelectedCardClick,href:"#"},ja)));},renderFormButtons:function(){var oa;if(!this.state.creditCards.length){oa=this.renderAddCardNextButton();}else if(this.state.showChooseCreditCardForm){oa=y.createElement("div",null,this.renderChooseCardBackButton(),this.renderChooseCardNextButton());}else oa=this.renderPayButton();return oa;},renderChooseCardBackButton:function(){return (y.createElement(aa,{className:"_2abj",label:fa._("Atr\u00e1s"),onClick:this.handleBackClick,ref:"back_button",size:"medium",use:"default"}));},renderAddCardNextButton:function(){return (y.createElement(aa,{disabled:this.isAddCardNextButtonDisabled(),label:fa._("Siguiente"),onClick:this.handleAddCardNextClick,ref:"add_card_next_button",size:"medium",use:"default"}));},renderChooseCardNextButton:function(){return (y.createElement(aa,{label:fa._("Siguiente"),onClick:this.handleChooseCardNextClick,ref:"choose_card_next_button",size:"medium",use:"confirm"}));},renderPayButton:function(){return (y.createElement(aa,{className:"_21x6",disabled:this.isSendButtonDisabled(),label:fa._("Pagar"),onClick:this.handleSendClick,ref:"send_button",size:"medium",use:"confirm"}));},renderPaymentDetails:function(){var oa,pa=v.SendMoneyFlyoutBottomText||'';if(this.state.creditCards.length){if(this.state.showChooseCreditCardForm){oa=this.renderAddDebitCardLink();}else oa=this.renderSelectedCard();}else oa=y.createElement("div",{className:"_2abl"},y.createElement(ca,{display:"block",ref:"send_money_dialog_add_card_next_text",size:"small",shade:"light"},pa));return oa;},renderSendMoneyForm:function(){return (y.createElement("div",null,y.createElement("div",{className:"_49no _2pi4",ref:"send_money_dialog_title"},y.createElement(j,{spacing:"large"},y.createElement(i,{heigh:40,src:this.props.receiver.big_image_src||this.props.receiver.image_src,width:40}),y.createElement("div",{className:"_3-8w"},y.createElement(ca,{display:"block",weight:"normal",size:"small"},fa._("Enviar a")),y.createElement(da,{display:"block",size:"small",color:"dark",weight:"bold"},this.props.receiver.name))),y.createElement(k,{className:"_49np",href:q.helpCenterURI,target:"_blank"})),y.createElement("div",{className:"_2abm"},this.renderMainContainer()),y.createElement("div",{className:"_21w-"},y.createElement("div",{className:"_21x4"},this.renderPaymentDetails()),y.createElement("div",{className:"_4zf-"},this.renderFormButtons()))));},renderMainContainer:function(){var oa;if(this.state.showChooseCreditCardForm){oa=y.createElement("div",{className:"_xn7"},y.createElement(o,{creditCards:this.state.creditCards,selectedCard:this.state.selectedCard,ref:"choose_credit_card_form"}));}else oa=y.createElement("div",{className:"_2abn"},y.createElement(w,{currencySymbol:this.props.currencySymbol,onInputChange:this.onAmountInputChange,ref:"send_money_amount_input",value:this.state.amount}));return oa;},renderLayers:function(){var oa={};if(this.state.addCreditCardDialogShown){oa.addCreditCard=y.createElement(m,{asyncRequestState:this.state.asyncRequestState,ref:"send_money_dialog_add_credit_card_form",onCancel:this.onAddCreditCardCancel,onDecline:this.onAddCreditCardDecline,onSuccess:this.onAddCreditCardSuccess,onError:this.onAddCreditCardError,onSaving:this.onAddCreditCardSaving,showPayButton:this.state.isAmountValid});}else if(this.state.confirmAmountDialogShown){oa.confirmAmount=y.createElement(p,{amount:this.state.amount,currencySymbol:this.props.currencySymbol,onCancel:this.onConfirmAmountCancel,onConfirm:this.onConfirmAmountSuccess,receiverName:this.props.receiver.short_name});}else if(this.state.verifyCreditCardDialogShown)oa.verifyCreditCard=y.createElement(x,{asyncRequestState:this.state.asyncRequestState,creditCard:this.state.selectedCard,isSending:true,onCancel:this.onVerifyCreditCardCancel,onSuccess:this.onVerifyCreditCardSuccess});return oa;},render:function(){var oa=this.props.theme==='messenger';return (y.createElement(ba,{alignment:oa?'right':'left',context:this.props.context,onBlur:this._onBlur,shown:true,width:la,position:this.props.position||'above'},y.createElement("div",{className:(("_21x9")+(oa?' '+"_1pka":''))},this.renderSendMoneyForm(),y.createElement(r,{ref:"send_money_dialog_loader",visible:this.state.loading}))));}});e.exports=na;},null);
__d("P2PSendMoneyButton.react",["Image.react","LayerSlowlyFadeOnShow","Link.react","P2PErrorDialog.react","P2PLinkConstants","P2PPasswordProtectionNUXDialog.react","P2PPasswordProtectionStatusTypes","P2PSendMoneyDialog.react","P2PTransferRiskResult","P2PTransferParam","P2PVerificationFlowHelper","React","ReactLayeredComponentMixin","TooltipLink.react","XUIButton.react","XUIDialog.react","XUIDialogTitle.react","XUIDialogBody.react","XUIDialogFooter.react","XUIDialogOkayButton.react","XUIGrayText.react","cx","emptyFunction","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea){b.__markCompiled&&b.__markCompiled();'use strict';var fa=r,ga=fa.PropTypes,ha=r.createClass({displayName:"P2PSendMoneyButton",mixins:[s],propTypes:{theme:ga.string,disabled:ga.bool,onTrigger:ga.func,receiver:ga.object},getDefaultProps:function(){return {disabled:false,onTrigger:ca,receiver:{}};},getInitialState:function(){return {confirmationDialogShown:false,dialogShown:false,passwordNUXPending:false,passwordProtectionNUXDialogShown:false,sendErrorObject:null,underManualReviewDialogShown:false};},originalCreateTransactionResponse:null,_onButtonClick:function(ia){if(this._clickGuard||this.props.disabled)return;this.setState({dialogShown:true});},_handleDialogSendClick:function(){this.setState({dialogShown:false});},_handleDialogBlur:function(){this.setState({dialogShown:false});},_prepareForClick:function(){this._clickGuard=this.state.dialogShown;},handleOnSendSuccess:function(ia){this.setState({dialogShown:false});var ja=ia[p.RISK_RESULT];this.originalCreateTransactionResponse=ia;if(ja===o.REQUIRE_VERIFICATION){q.startVerificationFlow(ia.id,true,this.handlePostSendSteps);}else if(ja===o.UNDER_MANUAL_REVIEW){this.setState({underManualReviewDialogShown:true});}else this.handlePostSendSteps();},handlePostSendSteps:function(){var ia=this.originalCreateTransactionResponse,ja=ia.passwordProtection===m.NOT_SET;if(ia.isFirstSend){this.setState({confirmationDialogShown:true,passwordNUXPending:ja});}else if(ja)this.setState({passwordProtectionNUXDialogShown:true});this.originalCreateTransactionResponse=null;this.props.onTrigger();},onPasswordProtectionNUXComplete:function(){this.setState({passwordProtectionNUXDialogShown:false});},handleConfirmationOKClick:function(){this.setState({confirmationDialogShown:false,passwordProtectionNUXDialogShown:this.state.passwordNUXPending,passwordNUXPending:false});},handleSendError:function(ia){this.setState({sendErrorObject:ia});},handleErrorDialogOKClick:function(){this.setState({sendErrorObject:null});},onRiskResultDialogConfirmed:function(){this.setState({underManualReviewDialogShown:false},function(){this.handlePostSendSteps();}.bind(this));},renderLayers:function(){var ia={};if(this.state.sendErrorObject)ia.sendError=r.createElement(j,{error:this.state.sendErrorObject,onOKClick:this.handleErrorDialogOKClick,ref:"send_error",title:da._("Problema al enviar el dinero")});if(this.state.dialogShown)ia.sendMoneyDialog=r.createElement(n,{context:r.findDOMNode(this.refs.p2pSendMoneyButton),onBlur:this._handleDialogBlur,onError:this.handleSendError,onSendClick:this._handleDialogSendClick,onSendSuccess:this.handleOnSendSuccess,receiver:this.props.receiver,ref:'send_money_dialog',theme:this.props.theme});if(this.state.confirmationDialogShown)ia.confirmationDialog=r.createElement(v,{behaviors:{LayerFadeOnShow:false,LayerSlowlyFadeOnShow:h},layerHideOnBlur:false,ref:"confirmation_dialog",shown:true,width:300},r.createElement(w,{showCloseButton:false},da._("Pago enviado")),r.createElement(x,null,r.createElement("div",{className:"_3hd2"},r.createElement(g,{height:50,width:50,src:ea("/images/p2p/check_mark-sm.png")})),r.createElement(aa,{display:"block",size:"small",shade:"dark"},da._("Cuando recibas dinero, tambi\u00e9n se acreditar\u00e1 en esta tarjeta. Puedes actualizar los datos de tu tarjeta en la {Link with text that goes to settings page}.",[da.param("Link with text that goes to settings page",r.createElement(i,{target:"_blank",href:k.settingsWWWURI},da._("Configuraci\u00f3n de pagos")))]))),r.createElement(y,null,r.createElement(z,{action:"cancel",use:"default",onClick:this.handleConfirmationOKClick})));if(this.state.passwordProtectionNUXDialogShown)ia.passwordProtectionNUXDialog=r.createElement(l,{onComplete:this.onPasswordProtectionNUXComplete});if(this.state.underManualReviewDialogShown)ia.underManualReviewDialog=r.createElement(v,{layerHideOnBlur:false,ref:"under_manual_review_dialog",shown:true,width:300},r.createElement(w,{showCloseButton:false},da._("Revisando informaci\u00f3n de pago")),r.createElement(x,null,da._("Por tu seguridad, este pago estar\u00e1 en revisi\u00f3n durante un m\u00e1ximo de 24 horas. Se efectuar\u00e1 cuando lo confirmemos.")),r.createElement(y,null,r.createElement(u,{label:da._("Aceptar"),onClick:this.onRiskResultDialogConfirmed,use:"confirm"})));return ia;},render:function(){var ia=da._("Enviar dinero"),ja='';if(this.props.receiver)ja=da._("{receiverName} no puede recibir dinero en este momento.",[da.param("receiverName",this.props.receiver.short_name)]);var ka=!this.props.disabled?ia:null,la=this.props.disabled?ja:'';return (r.createElement(t,{alignH:"center",className:((this.state.dialogShown?"open":'')+(this.props.disabled?' '+"disabled":'')+(this.props.theme!=='messenger'?' '+"_5uqy":'')),position:"above",tooltip:la,onClick:this._onButtonClick,onMouseDown:this._prepareForClick,title:ka,ref:"p2pSendMoneyButton"}));}});e.exports=ha;},null);
__d("SelectionPosition",["Event","InputSelection","SubscriptionsHandler","merge"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();function k(l){"use strict";this.$SelectionPosition0=l;this.$SelectionPosition1={start:0,end:0};this.$SelectionPosition2=new i();this.$SelectionPosition3=false;this.updatePos();this.enable();}k.prototype.getPos=function(){"use strict";return j(this.$SelectionPosition1);};k.prototype.setPos=function(l,m){"use strict";this.$SelectionPosition1={start:l,end:m};this.restore();};k.prototype.updatePos=function(){"use strict";this.$SelectionPosition1=h.get(this.$SelectionPosition0);};k.prototype.restore=function(){"use strict";h.set(this.$SelectionPosition0,this.$SelectionPosition1.start,this.$SelectionPosition1.end);};k.prototype.enable=function(){"use strict";if(!this.$SelectionPosition3){this.$SelectionPosition2.addSubscriptions(g.listen(this.$SelectionPosition0,'keyup',this.updatePos.bind(this)),g.listen(this.$SelectionPosition0,'click',this.updatePos.bind(this)));this.$SelectionPosition3=true;}};k.prototype.disable=function(){"use strict";if(this.$SelectionPosition3){this.$SelectionPosition2.release();this.$SelectionPosition3=false;}};e.exports=k;},null);
__d("XStickerReplyNUXController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/stickers\/tooltip\/",{});},null);
__d("ChatTabView",["Arbiter","ArbiterMixin","AsyncDialog","AsyncRequest","AsyncSignal","AvailableListConstants","BanzaiODS","Bootloader","BootloadedComponent.react","ChatAddToThreadButton.react","ChatArchiveWarning.react","ChatBehavior","ChatCloseButton.react","ChatConfig","ChatContextualDialogController","ChatEmployeeAwayWarning","ChatOpenTab","ChatPhotoUploader.react","ChatPrivacyActionController","ChatQuietLinks","ChatShareLinkUploader","ChatStickerButton.react","ChatStickerTriggerController","ChatTabActions","ChatTabMenu.react","ChatTabMessagesView","ChatTabOfficeStatus","ChatTabSheetController","ChatTitleLink.react","ChatVisibility","ChatVideoCallButton.react","MercuryConstants","CurrentUser","CSS","CurrentLocale","Dialog","Dock","DOM","DOMEvent","DOMQuery","DragDropTarget","EmoticonsList","EmoticonUtils","Event","FBRTCCore","Focus","ImmutableObject","Input","Keys","Locale","LogHistory","MercuryIDs","MercuryFileUploader","MercuryLogMessageType","MercuryParticipants","MercuryShareAttachmentRenderLocations","MercurySharePreview.react","MercurySourceType","MercuryThreadInfo","MercuryThreadMetadataRawRenderer","MercuryThreadMuter","MercuryTypingReceiver","MercuryViewer","NubController","P2PSendMoneyButton.react","P2PTransferStore","Parent","PhotosUploadWaterfall","PresencePrivacy","PresenceStatus","React","Run","SelectionPosition","StickerActions","StickerConfig","StickerConstants","StickersFlyout.react","StickerState","Style","SubscriptionsHandler","SyntheticMouseEvent","ChatTabTemplates","TextAreaControl","Toggler","Tooltip","TypingDetectorController","URLScraper","URI","UserAgent_DEPRECATED","WaterfallIDGenerator","WebMessengerThreadPermalinks","XStickerReplyNUXController","copyProperties","createCancelableFunction","csx","cx","fbt","getActiveElement","isEmpty","setIntervalAcrossTransitions","ChatReactInput","MercuryMessageActions","MercuryMessages","MercuryMessageObject","MercuryServerRequests","MercuryThreadInformer","MercuryThreadMetadataRenderer","MercuryThreadActions","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc,qc,rc,sc,tc,uc,vc,wc,xc,yc,zc,ad,bd){b.__markCompiled&&b.__markCompiled();'use strict';var cd=b('ChatReactInput').module,dd=b('MercuryMessageActions').get(),ed=b('MercuryMessages').get(),fd=b('MercuryMessageObject').get(),gd=b('MercuryServerRequests').get(),hd=b('MercuryThreadInformer').get(),id=b('MercuryThreadMetadataRenderer').get(),jd=b('MercuryThreadActions').get(),kd=b('MercuryThreads').get(),ld=/^\s*$/,md={},nd=null,od,pd=10,qd=960,rd=eb.getInstance('chat_tab_view');function sd(ne,oe){var pe=ra.create('div');oe=oe&&oe.filter(function(se){return se!=qb.getID();});if(ad(oe))return mc.remove(ne);var qe=oe.length,re=qe-pd;if(re>1)oe=oe.slice(0,pd);ib.getMulti(oe,function(se){for(var te in se){var ue=se[te],ve=jc[':fb:mercury:chat:multichat-tooltip-item'].build();ra.setContent(ve.getNode('name'),ue.name);var we=fb.getUserIDFromParticipantID(te),xe=we&&xb.get(we)==l.ACTIVE;na.conditionShow(ve.getNode('icon'),xe);na.conditionClass(ve.getNode('name'),'tooltipItemWithIcon',xe);ra.appendContent(pe,ve.getRoot());}if(re>1){var ye=yc._("y {number of hidden chat participants} m\u00e1s.",[yc.param("number of hidden chat participants",re)]);ra.appendContent(pe,ra.create('div',{},ye));}mc.set(ne,pe,'above');});}var td={},ud=null,vd=false;function wd(ne,oe,pe){if(pe){td[ne]=oe;if(!ud)ud=bd(xd,600);}else{na.removeClass(oe,'highlightTitle');delete td[ne];}}function xd(){for(var ne in td){var oe=td[ne];if(oe.parentNode){na.conditionClass(oe,'highlightTitle',vd);}else delete td[ne];}vd=!vd;if(!Object.keys(td).length){clearInterval(ud);ud=null;}}function yd(ne){var oe=fb.tokenize(ne);switch(oe.type){case 'user':return jc[':fb:mercury:chat:user-tab'].build();}return jc[':fb:mercury:chat:multichat-tab'].build();}function zd(ne){var oe=ne._getInputValue(),pe=ne._fileUploader.getAttachments();if(fe(ne))be(ne,oe,pe,function(qe){var re=ne._fileUploader.getImageFiles();if(re.length>0){qe.image_ids=re;qe.has_attachment=true;}var se=ne._fileUploader.getAnimatedImageFiles();if(se.length>0){qe.gif_ids=se;qe.has_attachment=true;}var te=ne._fileUploader.getVideoFiles();if(te.length>0){qe.video_ids=te;qe.has_attachment=true;}var ue=ne._fileUploader.getAudioFiles();if(ue.length>0){qe.audio_ids=ue;qe.has_attachment=true;}var ve=ne._fileUploader.getFiles();if(ve.length>0){qe.file_ids=ve;qe.has_attachment=true;}dd.send(qe);ne._fileUploader.removeAttachments();ne._shareLinkUploader&&ne._shareLinkUploader.clear();if(ne._sharePreview)ne._sharePreview.setProps({share:null,uri:null});if(!t.get('chat_react_input'))ne._getNode('input').value='';ne._typingDetector&&ne._typingDetector.resetState();ne._messagesView&&ne._messagesView.setShouldScrollToBottom(true);});}function ae(ne,oe){if(oe===0)return;ie(ne,vb.POST_PUBLISHED,{count:oe});ne._waterfallID=rc.generate();}function be(ne,oe,pe,qe){kd.getThreadMeta(ne._threadID,function(re){var se=lb.CHAT_WEB;if(ne._shareLinkUploader&&ne._shareLinkUploader.getAttachData()&&ne._shareLinkUploader.loadedFromFeed())se=lb.SAM_UFI;var te=fd.constructUserGeneratedMessageObject(oe,se,ne._threadID);if(pe.length>0){te.has_attachment=true;te.raw_attachments=pe;}if(ne._shareLinkUploader){var ue=ne._shareLinkUploader.getAttachData();if(ue){te.has_attachment=true;te.content_attachment=ue;}}if(ne._sharePreview){var ve=ne._sharePreview.getShareData();if(ve){te.has_attachment=true;te.shareable_attachment=ve;}}if(kd.isNewEmptyLocalThread(ne._threadID)){var we=ne._sheetController.getAddFriendsParticipants();if(we===null||we.length===0)return;we=we.filter(function(ye){return ye!=qb.getID();});if(we.length===0){te.thread_id=fb.getThreadIDFromUserID(ma.getID());}else if(we.length===1){te.thread_id=fb.getThreadIDFromParticipantID(we[0]);}else jd.addParticipants(ne._threadID,we);}if(kd.isEmptyLocalThread(ne._threadID)){te.message_id=fb.tokenize(ne._threadID).value;var xe=kd.getThreadMetaNow(re.thread_id);te.specific_to_list=Array.from(xe.participants);}if(typeof te!='undefined')te.signatureID=ne._signatureID;te.ui_push_phase=la.UIPushPhase;qe(te);if(ne._threadID!==te.thread_id&&!ne._photoUploader.isUploading()){da.closeTab(ne._threadID);w.openThread(te.thread_id,'ChatTabView');}});}function ce(ne){ne._blocked=true;ne._sheetController.openUploadWarningTabSheet();}function de(ne){return (ne._fileUploader.isUploading()||ne._photoUploader.isUploading()||(ne._sharePreview&&ne._sharePreview.isLoading()));}function ee(ne){return ne._fileUploader.isUploading();}function fe(ne){var oe=ne._getInputValue();if(!ld.test(oe))return true;if(ne._fileUploader.getAttachments().length>0||ne._fileUploader.getImageFiles().length>0||ne._fileUploader.getAnimatedImageFiles().length>0||ne._fileUploader.getVideoFiles().length>0||ne._fileUploader.getAudioFiles().length>0||ne._fileUploader.getFiles().length>0)return true;if(ne._shareLinkUploader&&ne._shareLinkUploader.getAttachData())return true;if(ne._sharePreview&&ne._sharePreview.getShareData())return true;return false;}function ge(ne){if(!ne._blocked||ee(ne))return;ne._blocked=false;zd(ne);ne._sheetController.closeUploadWarningTabSheet();}function he(ne){ne._nubController.flyoutContentChanged();var oe=ne._getNode('attachmentShelf');oe.scrollTop=oe.scrollHeight;}function ie(ne,oe,pe){vb.sendSignal(uc({qn:ne._waterfallID,step:oe,uploader:vb.APP_CHAT},pe||{}));}function je(ne,oe,pe,qe,re){if(oe)gd.ensureThreadIsFetched(oe);this._threadID=ne;this._signatureID=pe;this._eventListeners=[];this._tabTemplate=yd(ne);this._tabElem=this._tabTemplate.getRoot();if(re){this.insertBefore(re);}else this.appendTo(qe);this._titlebar=this._getNode('nubFlyoutTitlebar');this._iconsContainerNode=this._getNode('iconsContainer');this._inputContainerNode=this._getNode('inputContainer');this._waterfallID=rc.generate();this._subscriptionsHandler=new hc();this._initializeAutoSendPhotoUploader();this._stickersFlyoutShown=false;var se=ta.scry(this._tabElem,"._1ia");if(se&&se.length>0){this._dropTarget=new ua(se[0]);this._dropTarget.setOnFilesDropCallback(this._filesDropped.bind(this));this._dropTarget.setOnURLDropCallback(this._linkDropped.bind(this));this._dropTarget.enable();}this._sheetController=new ha(this._threadID,this._getNode('sheet'),this._tabElem,this);if(t.get('chat_react_option_menu')){this._initializeReactMenu(this._getNode('fileAttachmentShelf'));}else{this._fileUploader=new gb(this._getNode('fileAttachmentShelf'),this._tabTemplate.getNode('attachButtonForm'),this._tabTemplate.getNode('fileInput'),this._tabTemplate.getNode('attachID'));this._initializeUploader(this._fileUploader);}this._initializeArchiveWarning();this._initializeAddToThreadButton();this._initializeVideoCallButton();this._initializeCloseButton();this._initializeTitle();this._sheetController.onClickNewMessagesSheet(function(){this._messagesView&&this._messagesView.scrollToBottom();this.focus();this.tryMarkAsRead();}.bind(this));this._sheetController.onClickThreadIsMutedSheet(function(){jd.unmute(this._threadID);this.focus();}.bind(this));this._nubController=new rb().init(this._tabElem);this._sheetController.onResize(this._nubController.flyoutContentChanged.bind(this._nubController));this._sheetController.onTokensChanged(function(xe,ye){kd.getThreadMeta(this._threadID,function(ze){this._updateControls(ze,ye.token_count);}.bind(this));}.bind(this));if(nd===null)nd=!t.get('seen_autosend_photo_nux');this._messagesView=null;if(t.get('chat_react_option_menu')){sc.getThreadURI(ne,function(xe){return this._setTitleHref(xe);}.bind(this));}else{var te=this._getNode('conversationLink');na.hide(te);id.renderWebMessengerLink(ne,te,function(){na.show(te);this._setTitleHref(te.href);}.bind(this));}if(!fb.getUserIDFromThreadID(this._threadID))this._titlebarTooltipAnchor=this._getNode('titlebarText');var ue=this._getCanonicalUserID();if(this._getCanonicalUserID()){ib.get(fb.getParticipantIDFromUserID(ue),function(xe){if(xe.href)this._setTitleHref(xe.href);}.bind(this));}else if(t.get('chat_react_option_menu')&&this._reactChatTabMenu.getURL()){this._setTitleHref(this._reactChatTabMenu.getURL());}else if(te&&te.href)this._setTitleHref(te.href);this._nubController.subscribe('resize',function(){this._resizeInputContainer();}.bind(this));this._setNameConversationLink();this._listen('closeButton','click',this._closeClicked);this._listen('dockButton','click',this._nubClicked);this._listen('dockButton','keydown',this._dockKeyDown);this._listen('nubFlyoutTitlebar','click',this._titleClicked);this._listen('chatConv','click',this._chatConvClicked);this._listen('inputContainer','click',this._inputContainerClicked);this._listen('addFriendLink','click',this._addFriendLinkClicked,true);this._listen('nameConversationLink','click',this._nameConversationLinkClicked,true);this._listen('clearWindowLink','click',this._clearHistory,true);this._listen('unsubscribeLink','click',this._unsubscribeLinkClicked,true);this._listen('reportSpamLink','click',this._reportSpamClicked,true);this._listen('createGroupLink','click',this._createGroupClicked,true);this._listen('enableDesktopNotif','click',this._enableDesktopNotif,true);this._listen('muteThreadLink','click',ob.showMuteChangeDialog.bind(null,this._threadID,null),true);this._listen('unmuteThreadLink','click',function(){jd.unmute(this._threadID);lc.hide();}.bind(this),true);this._listen('switchToWorkUserLink','click',this._switchToWorkUserClicked,true);this._listen('sheet','keydown',function(event){if(!event.getModifiers().any&&event.keyCode===cb.TAB){this._focusInput();event.kill();}}.bind(this));if(this._getNode('officeStatus'))this._listen('officeStatus','click',function(){return false;},true);this._stickersFlyoutToggler=this._getNode('emoticons');if(cc.WebStickerTrigger)this._stickerTriggerController=new ca(this._getNode('stickersTriggerFlyoutContainer'),this._getNode('emoticonIndicator'),this._stickersFlyoutToggler,this._stickerSelected.bind(this),this._searchStickers.bind(this));this._initializeInput();if(fc.shouldShowStickerSearchNUX())this._listen('emoticons','click',function(){if(fc.shouldShowStickerSearchNUX()){bc.selectPack(dc.SEARCH_PACK_ID);fc.clearShowStickerSearchNUX();}},true);if(t.get('chat_react_sticker_button')){this._stickerButton=yb.render(yb.createElement(ba,{className:"_4vui",flyoutAlignment:"left",onFlyoutShown:this._onFlyoutShown.bind(this),onFlyoutHidden:this._onFlyoutHidden.bind(this),onStickerSelect:this._stickerSelected.bind(this),onEmoticonSelect:this._emoticonSelected.bind(this)}),this._getNode('stickerButtonContainer'));m.bumpEntityKey('chat.web','sticker_button.mounting_attempted');}else{var ve=this._getNode('stickers');if(ve)this._stickersFlyout=yb.render(yb.createElement(ec,{onStickerSelect:function(xe){this._stickerSelected(xe);}.bind(this),onShown:this._onFlyoutShown.bind(this),onHidden:this._onFlyoutHidden.bind(this),onEmoticonSelect:this._emoticonSelected.bind(this),onEscKeyDown:this._hideStickersFlyoutIfShown.bind(this)}),ve);this._eventListeners.push(fc.addListener(fc.PACK_SELECTED,function(xe){if(this._stickersFlyout&&this._stickersFlyout.isMounted())this._stickersFlyout.setProps({packID:xe});}.bind(this)));}this._renderOrionTrigger();if(!this._isP2PEnabled())this._transferStoreSub=tb.addListener('change',this._onP2PTransferStoreChange.bind(this));this._privacyLink=this._getNode('privacyLink');if(this._privacyLink){this._privacyActionController=new y(ue,this._updatePrivacyLink.bind(this));this._eventListeners.push(xa.listen(this._privacyLink,'click',this._privacyActionController.togglePrivacy.bind(this._privacyActionController)));}kd.getThreadMeta(this._threadID,function(xe){this._setUpMutingSettings(xe);}.bind(this));z.removeEmptyHrefs(this._tabElem);md[ne]=this;this.updateAvailableStatus();this.updateTab();this._setCloseTooltip(false);var we={threadID:ne,userID:ue,signatureID:this._signatureID};new k('/ajax/chat/opentab_tracking.php',we).send();this._checkUnsentMessages=vc(function(){if(this._hasUnfinishedPost())return yc._("A\u00fan no env\u00edas el mensaje. \u00bfQuieres salir sin enviarlo?");if(ed.getNumberLocalMessages(this._threadID))return yc._("A\u00fan se est\u00e1 enviando tu mensaje. \u00bfSeguro que quieres abandonar?");return null;}.bind(this));zb.onBeforeUnload(this._checkUnsentMessages,false);this._logUnsentPhotos=vc(ke.bind(null,this));zb.onUnload(this._logUnsentPhotos);}function ke(ne){if(ne._photoUploader.isUploading())ie(ne,vb.CANCEL_DURING_UPLOAD);}function le(){for(var ne in md){md[ne].updateAvailableStatus();md[ne].updateMultichatTooltip();}}g.subscribe(['buddylist/availability-changed'],le);wb.subscribe(['privacy-changed','privacy-availability-changed'],le);r.subscribe(r.ON_CHANGED,function(){for(var ne in md)kd.getThreadMeta(ne,function(oe){md[ne]._updateUnreadCount(oe);});});pb.addRetroactiveListener('state-changed',function(ne){for(var oe in ne){var pe=ne[oe]&&ne[oe].length,qe=md[oe];qe&&qe.showTypingIndicator(pe);}});hd.subscribe('threads-updated',function(ne,oe){for(var pe in md){var qe=md[pe];oe[pe]&&qe.updateTab();if(qe._newThreadIDFromPhotoUpload&&!qe._photoUploader.isUploading()&&oe[qe._newThreadIDFromPhotoUpload]){da.closeTab(qe._threadID);w.openThread(qe._newThreadIDFromPhotoUpload,'ChatTabView');qe._newThreadIDFromPhotoUpload=null;}}});hd.subscribe('threads-deleted',function(ne,oe){for(var pe in md)oe[pe]&&da.closeTab(pe,'thread_deleted');});uc(je,h,{get:function(ne){return md[ne];}});uc(je.prototype,{getThreadID:function(){return this._threadID;},showAddFriend:function(){setTimeout((function(){this._sheetController.openAddFriendsSheet();}).bind(this),0);},showNameConversation:function(ne){setTimeout((function(){this._sheetController.openNameConversationSheet(ne);}).bind(this),0);},hideAutomaticNameConversation:function(){setTimeout((function(){this._sheetController.closeAutomaticNameConversationSheet();}).bind(this),0);},isVisible:function(){return na.shown(this._tabElem);},setVisibleState:function(ne,oe){var pe=na.shown(this._tabElem),qe=na.hasClass(this._tabElem,'opened');na.conditionShow(this._tabElem,ne);na.conditionClass(this._tabElem,'opened',oe);if(!(pe&&qe)&&ne&&oe){if(!this._messagesView)this._messagesView=new fa(this._threadID,this._sheetController,this._getNode('chatConv'),this._getNode('conversation'),this._getNode('loadingIndicator'),this._getNode('lastMessageIndicator'),this._getNode('typingIndicator'),this);this._nubController.flyoutContentChanged();this._messagesView.scrollToBottom();}if(pe&&qe&&!(ne&&oe))this._contextualDialogController&&this._contextualDialogController.tabNotActive();},focus:function(){if(na.hasClass(this._tabElem,'opened')){this._focusInput();}else this._getNode('dockButton').focus();},isFocused:function(){var ne=zc();return ub.byClass(ne,"_50mz")===this._tabElem;},hasEmptyInput:function(){var ne;if(t.get('chat_react_input')){if(!this._chatInput||!this._chatInput.isMounted())return false;ne=this._chatInput.getValue();}else ne=this._getNode('input').value;return ld.test(ne);},getInputElem:function(){if(t.get('chat_react_input')){if(!this._chatInput||!this._chatInput.isMounted())return null;return yb.findDOMNode(this._chatInput);}else return this._getNode('input');},setStickersFlyoutPackID:function(ne){if(this._stickerButton){this._setPackIDReact(ne);}else this._setPackIDLegacy(ne);},loadShareFromParams:function(ne,oe){this._shareLinkUploader&&this._shareLinkUploader.loadShareFromParams(ne,oe);if(this._sharePreview)this._sharePreview.setProps({share:{params:oe,type:ne},uri:null});},_linkDropped:function(ne){this._shareLinkUploader&&this._shareLinkUploader.loadShare(ne);if(this._sharePreview)this._sharePreview.setProps({share:null,uri:ne});},_filesDropped:function(ne){if(this._fileUploader)this._fileUploader.addDroppedFiles(ne);},_setPackIDLegacy:function(ne){var oe=this._stickersFlyout;if(!this._stickersFlyoutToggler||!oe||!oe.isMounted())return;bc.selectPack(ne);this._toggleStickersFlyoutShownLegacy(true);},_setPackIDReact:function(ne){if(!this._stickerButton.isMounted())return;bc.selectPack(ne);this._toggleStickersFlyoutShownReact(true);},_toggleStickersFlyoutShownReact:function(ne){this._stickerButton.showFlyout();this._stickersFlyoutShown=ne;},_toggleStickersFlyoutShownLegacy:function(ne){if(ne){lc.show(this._stickersFlyoutToggler);}else lc.hide(this._stickersFlyoutToggler);this._stickersFlyoutShown=ne;},_hideStickersFlyoutIfShown:function(){if(this._stickersFlyoutToggler&&this._stickersFlyout&&this._stickersFlyoutShown)this._toggleStickersFlyoutShownLegacy(false);},showStickerReplyNUX:function(){if(od)return;var ne=this._getNode('stickerButtonContainer')||this._getNode('emoticons');new j(tc.getURIBuilder().getURI()).setRelativeTo(ne).setData({thread_id:this._threadID}).setHandler(function(oe){fc.clearShowStickerReplyNUX();}).send();},insertBefore:function(ne){ra.insertBefore(ne._tabElem,this._tabElem);},appendTo:function(ne){ra.appendContent(ne,this._tabElem);},nextTabIs:function(ne){var oe=ne&&ne._tabElem;return this._tabElem.nextSibling==oe;},getScrollTop:function(){return ra.find(this._tabElem,'.fbNubFlyoutBody.scrollable').scrollTop;},setScrollTop:function(ne){ra.find(this._tabElem,'.fbNubFlyoutBody.scrollable').scrollTop=ne;},_unmountComponentAtNodeSafe:function(ne){var oe=this._getNode(ne);oe&&yb.unmountComponentAtNode(oe);},destroy:function(){this._selectionPosition&&this._selectionPosition.disable();while(this._eventListeners.length)this._eventListeners.pop().remove();if(this._dropTarget)this._dropTarget.disable();this._checkUnsentMessages&&this._checkUnsentMessages.cancel();this._logUnsentPhotos&&this._logUnsentPhotos.cancel();this._messagesView&&this._messagesView.destroy();this._sheetController&&this._sheetController.destroy();if(t.get('chat_react_option_menu')){yb.unmountComponentAtNode(this._getNode('menuContainer'));}else this._fileUploader&&this._fileUploader.destroy();if(t.get('chat_react_header')){yb.unmountComponentAtNode(this._getNode('addToThreadContainer'));this._unmountComponentAtNodeSafe('archiveContainer');this._unmountComponentAtNodeSafe('videoCallButtonContainer');yb.unmountComponentAtNode(this._getNode('closeButtonContainer'));yb.unmountComponentAtNode(this._getNode('titleContainer'));}if(t.get('chat_react_share_uploader')&&this._sharePreview&&this._sharePreview.isMounted()){yb.unmountComponentAtNode(yb.findDOMNode(this._sharePreview));}else this._shareLinkUploader&&this._shareLinkUploader.clear();try{yb.unmountComponentAtNode(this._getNode('photoUploaderContainer'));}catch(ne){m.bumpEntityKey('chat.web','chattab.unmount_failed');}if(t.get('chat_react_sticker_button')){yb.unmountComponentAtNode(this._getNode('stickerButtonContainer'));}else yb.unmountComponentAtNode(this._getNode('stickers'));if(cc.WebStickerTrigger)this._stickerTriggerController.destroy();this._subscriptionsHandler&&this._subscriptionsHandler.release();this._contextualDialogController&&this._contextualDialogController.destroy();this._privacyActionController&&this._privacyActionController.destroy();if(t.get('chat_react_input')){yb.unmountComponentAtNode(this._getNode('inputContainer'));}else bb.reset(this._getNode('input'));ra.remove(this._tabElem);delete md[this._threadID];qa.unregisterNubController(this._nubController);},updateAvailableStatus:function(){kd.getThreadMeta(this._threadID,function(ne){var oe=l.OFFLINE,pe=false,qe=this._getCanonicalUserID();if(qe){oe=xb.get(qe);pe=ya.isAvailableForWebrtcCalling(qe);}else{var re=ne.participants.map(function(te){return fb.getUserIDFromParticipantID(te);});oe=xb.getGroup(re);}if(!ja.isOnline())oe=l.OFFLINE;if(qe)this._updateCallLink();na.conditionClass(this._tabElem,"_5238",oe===l.ACTIVE);na.conditionClass(this._tabElem,"_4hwz",pe);na.conditionClass(this._tabElem,"_5239",oe===l.MOBILE);var se=this._getNode('presenceIndicator');switch(oe){case l.ACTIVE:se.setAttribute('alt',yc._("En l\u00ednea"));break;case l.MOBILE:se.setAttribute('alt',yc._("Celular"));break;default:se.removeAttribute('alt');break;}}.bind(this));},updateTab:function(){this._setNameConversationLink();kd.getThreadMeta(this._threadID,function(ne){var oe=[this._getNode('name')];if(!t.get('chat_react_header')){oe.push(this._getNode('titlebarText'));}else if(this._title.isMounted())this._title.setProps({thread:ne},function(){this._getNode('chatWrapper').setAttribute('aria-label',this._title.getTitle());}.bind(this));id.renderAndSeparatedParticipantList(this._threadID,oe,{names_renderer:nb.renderShortNames,check_length:true});this._updateControls(ne);this._updateMutingSettings(ne);this._updateUnreadCount(ne);this.updateMultichatTooltip();this._updateArchiveWarning(ne);this._updateEmployeeAwayWarning(ne);this._updateOfficeStatus(ne);this._updateNewThread(ne);this._updateNameConversationSheet(ne);this._updateReadOnlySheet(ne);this._updateSwitchToWork(ne);}.bind(this));},_setNameConversationLink:function(){var ne=this._getNode('nameConversationLink');if(ne)kd.isEmptyLocalThread(this._threadID)?na.hide(ne):na.show(ne);},_updateNameConversationSheet:function(ne){if(mb.canReply(ne)&&!ne.name&&!ne.is_canonical&&!ne.name_conversation_sheet_dismissed&&!ne.has_email_participant&&!ne.read_only&&!kd.isEmptyLocalThread(ne.thread_id)){this.showNameConversation(true);}else this.hideAutomaticNameConversation();},_updateReadOnlySheet:function(ne){var oe=mb.canReply(ne),pe=kd.isEmptyLocalThread(ne.thread_id);if(!oe&&!pe)this._sheetController.openReadOnlySheet();},updateSignatureID:function(ne){this._signatureID=ne;},_showPhotoNUXIfNecessary:function(){if(nd){nd=false;new j('/ajax/chat/photo_nux.php').setRelativeTo(this._getNode('photoUploaderContainer')).setData({threadID:this._threadID}).send();return true;}},_setUpMutingSettings:function(ne){var oe=mb.isMuted(ne);if(oe)this._sheetController.openThreadIsMutedTabSheet();this._updateActionMenu(oe);},_updateMutingSettings:function(ne){var oe=mb.isMuted(ne),pe;if(t.get('chat_react_option_menu')){pe=this._reactChatTabMenu.props.isMuted;}else pe=na.shown(this._getNode('unmuteThreadLink').parentNode);if(oe&&!pe){this._sheetController.openThreadIsMutedTabSheet();}else if(!oe&&pe)this._sheetController.closeThreadIsMutedTabSheet();this._updateActionMenu(oe);},_updateActionMenu:function(ne){if(t.get('chat_react_option_menu')){this._reactChatTabMenu.isMounted()&&this._reactChatTabMenu.setProps({isMuted:ne});}else{na.conditionShow(this._getNode('muteThreadLink').parentNode,!ne);na.conditionShow(this._getNode('unmuteThreadLink').parentNode,ne);}},_updateArchiveWarning:function(ne){if(ma.isEmployee())ib.getMulti(ne.participants,this._showArchiveWarningIfAllParticipantsAreEmployees.bind(this));},_updateEmployeeAwayWarning:function(ne){v.updateEmployeeAwayWarning(ne,function(){this._sheetController.openEmployeeAwaySheet();}.bind(this),function(){});},_updateOfficeStatus:function(ne){var oe=this._getNode('officeStatus');if(!oe||fb.isMultichat(ne.thread_id))return;var pe=fb.getParticipantIDFromUserID(ne.canonical_fbid);ib.get(pe,function(qe){ga.update(oe,qe);});},_updateSwitchToWork:function(ne){if(ma.isEmployee()&&ma.hasWorkUser()&&fb.isMultichat(ne.thread_id)){ib.getMulti(ne.participants,function(oe){this._showSwitchToWork(this._isEmployeesOnly(oe));}.bind(this));}else this._showSwitchToWork(false);},_updateControls:function(ne,oe){var pe=false;if(ne&&ne.thread_id){var qe=fb.tokenize(ne.thread_id);if(qe.type==='user'){var re=qe.value;pe=!gd.isUser(re);}}var se=mb.canReply(ne)&&(!ad(ne.participants)||!!oe);na.conditionShow(this._inputContainerNode,se);na.conditionShow(this._iconsContainerNode,se);if(!t.get('chat_react_option_menu')){na.conditionShow(this._getNode('dropdown'),se);}else if(this._reactChatTabMenu.isMounted()){this._reactChatTabMenu.setProps({isEmptyChat:kd.isNewEmptyLocalThread(ne.thread_id),show:se});if(pe)this._reactChatTabMenu.setProps({showAddFriend:null});}var te=se&&!pe;if(t.get('chat_react_header')){this._addToThreadButton.isMounted()&&this._addToThreadButton.setProps({shown:te});}else na.conditionShow(this._getNode('addToThreadLink'),te);this._resizeInputContainer();this._updateOrionTrigger(se);},_updateOrionTrigger:function(ne){if(this._orionTrigger&&ne){this._setOrionTriggerProps();}else if(!this._orionTrigger)this._renderOrionTrigger();},_setOrionTriggerProps:function(){var ne=this.getParticipantIDForOrionNUX(),oe=true;na.conditionShow(this._orionTriggerContainer,ne);if(ne){ib.get(ne,function(pe){pe=ab.set(pe,{userId:this._getUserIdFromParticipantID(ne)});if(pe.orion_eligible||tb.hasReceivedFromSender(pe.userId))oe=false;this._orionTrigger.setProps({receiver:pe,disabled:oe});}.bind(this));}else this._orionTrigger.setProps({receiver:{}});},_getUserIdFromParticipantID:function(ne){return fb.getUserIDFromParticipantID(ne);},_onP2PTransferStoreChange:function(){this._renderOrionTrigger();if(this._transferStoreSub){this._transferStoreSub.remove();this._transferStoreSub=null;}},_isP2PEnabled:function(){return t.get('p2p_enabled');},_renderOrionTrigger:function(){var ne=this._isP2PEnabled()||tb.hasTransfers();if(ne){this._orionTriggerContainer=this._getNode('orionTriggerContainer');this._orionTrigger=yb.render(yb.createElement(sb,{onTrigger:this._orionTriggered.bind(this)}),this._orionTriggerContainer);na.addClass(this._inputContainerNode,"_11d6");this._setOrionTriggerProps();}},getParticipantIDForOrionNUX:function(){var ne=this._sheetController.getAddFriendsTabSheet(),oe=ne.getParticipants(),pe=this._getCanonicalUserID(),qe=null;if(pe){qe=fb.getParticipantIDFromUserID(pe);}else if(oe&&oe.length===1)qe=oe[0];return qe;},_resizeInputContainer:function(){var ne=this._tabElem.clientWidth,oe=2,pe=ne-(this._inputContainerNode.clientWidth+oe),qe=db.isRTL()?'left':'right';gc.set(this._iconsContainerNode,qe,pe+'px');if(!t.get('chat_react_input'))kc.getInstance(this._getNode('input')).update();},_updateNewThread:function(ne){if(kd.isNewEmptyLocalThread(ne.thread_id))this.showAddFriend();},_isEmployeesOnly:function(ne){for(var oe in ne)if(!ne[oe].employee)return false;return true;},_showArchiveWarningIfAllParticipantsAreEmployees:function(ne){var oe=this._isEmployeesOnly(ne),pe=t.get('chat_react_header'),qe=pe?this._getNode('archiveContainer'):this._getNode('titanArchiveWarning');if(qe){if(this._titlebarTooltipAnchor)na.conditionClass(this._titlebarTooltipAnchor,'narrowTitleBar',oe);if(pe){this._archiveWarning.isMounted()&&this._archiveWarning.setProps({shown:oe});}else na.conditionShow(qe,oe);}},_showSwitchToWork:function(ne){if(!t.get('chat_react_option_menu')){var oe=this._getNode('switchToWorkUserLink');if(oe)na.conditionShow(oe,ne);}else if(this._reactChatTabMenu.isMounted())this._reactChatTabMenu.setProps({hasSwitchToWork:ne});},updateMultichatTooltip:function(){kd.getThreadMeta(this._threadID,function(ne){if(!ne.is_canonical){var oe;if(t.get('chat_react_header')){oe=yb.findDOMNode(this._title);}else oe=this._titlebarTooltipAnchor;sd(oe,ne.participants);}}.bind(this));},_getNode:function(ne){return this._tabTemplate.getNode(ne);},_getCanonicalUserID:function(){return fb.getUserIDFromThreadID(this._threadID);},_listen:function(ne,event,oe,pe){var qe=this._getNode(ne);if(qe){this._eventListeners.push(xa.listen(qe,event,oe.bind(this)));}else if(!pe)throw new Error('Could not find node "'+ne+'"');},_closePreClicked:function(ne){this._closeMouseDown=true;},_closeClicked:function(ne){ke(this);da.closeTab(this._threadID);if(ne instanceof ic){ne.stopPropagation();return;}ne.kill();},_closeEnter:function(ne){if(ne.keyCode===cb.RETURN)this._closeClicked(ne);},_nubClicked:function(ne){ne.kill();return je.inform('nub-activated',this._threadID);},_dockKeyDown:function(event){if(event.keyCode===cb.RETURN||event.keyCode===cb.SPACE){je.inform('nub-activated',this._threadID);event.kill();}else this._handleHotkeyPressed(event);},_handleHotkeyPressed:function(event){if(event.keyCode===cb.ESC){this._handleEscape();if(t.get('chat_react_input'))event=new sa(event);event.kill();}else if(event.keyCode===cb.TAB)this._handleTabPressed(event);},_handleTabPressed:function(event){if(!event.ctrlKey){var ne=je.inform('tab-pressed',{id:this._threadID,shiftPressed:event.shiftKey});if(t.get('chat_react_input'))event=new sa(event);!ne&&event.kill();return true;}},_handleEscape:function(){if(this._stickersFlyoutShown){this._stickerButton?this._toggleStickersFlyoutShownReact(false):this._toggleStickersFlyoutShownLegacy(false);return;}ke(this);if(this.hasEmptyInput()){je.inform('esc-pressed',this._threadID);}else{var ne=yc._("\u00bfSeguro que quieres cerrar esta ventana del chat?"),oe=yc._("No enviaste tu mensaje."),pe=new pa().setTitle(ne).setBody(oe).setButtons([pa.CLOSE,pa.CANCEL]).setHandler(je.inform.bind(je,'esc-pressed',this._threadID,null)).setModal(true).show(),qe=pe.getButtonElement('yes');qe&&za.set(qe);}},_titleClicked:function(event){var ne=event.getTarget();if(!ub.byClass(ne,'titlebarText')&&!ub.byClass(ne,'uiSelector')&&!ub.byClass(ne,'addToThread')&&!ub.byClass(ne,'optionMenu')&&!ub.byClass(ne,'videoicon')&&!ub.byClass(ne,'close')){event.kill();da.lowerTab(this._threadID);this.focus();}},_callEnter:function(ne){if(ne.keyCode===cb.RETURN)this._callClicked(ne);},_callClicked:function(ne){if(ne.target)ne.target.blur();var oe=this._getCanonicalUserID();if(ya.isAvailableForWebrtcCalling(oe)){var pe='chat_tab_icon';if(ne.target&&na.hasClass(ne.target,'video_call_tour'))pe='chat_tab_icon_tour';je.inform('video-call-clicked',{threadID:this._threadID,userID:oe,clickSource:pe});}if(t.get('chat_react_header')){ne.stopPropagation();}else return false;},_addFriendLinkClicked:function(){this.showAddFriend();},_nameConversationLinkClicked:function(){this.showNameConversation();},_showParticipantsClicked:function(){gd.getServerThreadID(this._threadID,function(ne){i.send(new j(pc('/ajax/browser/dialog/multichat_members/').addQueryData({id:ne})));});},_clearHistory:function(){var ne=kd.getThreadMetaNow(this._threadID);if(ne){var oe=this._getCanonicalUserID();gd.clearChat(this._threadID,oe,ne.timestamp);}},_unsubscribeLinkClicked:function(){var ne=[];ne.push({name:'unsubscribe',label:yc._("Abandonar la conversaci\u00f3n"),handler:this._unsubscribeToThread.bind(this)});ne.push(pa.CANCEL);new pa().setTitle(yc._("\u00bfDeseas abandonar la conversaci\u00f3n?")).setBody(yc._("No recibir\u00e1s m\u00e1s mensajes de esta conversaci\u00f3n y los participantes ver\u00e1n que la abandonaste.")).setButtons(ne).show();},_switchToWorkUserClicked:function(){var ne=[];ne.push({name:'move',label:yc._("Mover conversaci\u00f3n"),handler:this._switchToWork.bind(this)});ne.push(pa.CANCEL);new pa().setTitle(yc._("\u00bfQuieres mover la conversaci\u00f3n a la cuenta laboral?")).setBody(yc._("\u00bfQuieres mover esta conversaci\u00f3n para que se muestre en tu cuenta laboral?")).setButtons(ne).show();},_getUserParticipants:function(ne){var oe=[];ne.forEach(function(pe){var qe=fb.getUserIDFromParticipantID(pe);qe&&oe.push(qe);});return oe;},_createGroupClicked:function(){kd.getThreadMeta(this._threadID,function(ne){if(!ne.is_canonical){var oe=pc('/ajax/groups/create_get.php').addQueryData({ref:'web_messenger_dock',parent_id:'0'}),pe=this._getUserParticipants(ne.participants);oe.addQueryData({members:pe});if(ne.name)oe.addQueryData({name:ne.name});i.send(new j(oe));}}.bind(this));},_enableDesktopNotif:function(){Notification.requestPermission();},_reportSpamClicked:function(){var ne=this._getCanonicalUserID(),oe=pc('/ajax/chat/report.php').addQueryData({id:ne}).addQueryData({src:'top_report_link'});i.send(new j(oe));},_inputPasted:function(event){if(qc.chrome()){var ne=event.clipboardData||event.originalEvent.clipboardData;if(!ne||!ne.items||ne.items.length<1)return;var oe=ne.items[0].type;if(oe!=='image/png')return;if(ne.items[0].getAsFile){var pe=ne.items[0].getAsFile();this._photoUploader.uploadFile(pe);}}},_focusInput:function(){if(t.get('chat_react_input')){this._chatInput&&this._chatInput.isMounted()&&this._chatInput.focus();}else this._getNode('input').focus();},_focusTab:function(){na.addClass(this._tabElem,'focusedTab');this.tryMarkAsRead();this._contextualDialogController&&this._contextualDialogController.tabFocused();if(!od&&this._showPhotoNUXIfNecessary())g.subscribe(['ChatNUX/show','ChatNUX/hide'],function(event){od=event==='ChatNUX/show';});this._closeMouseDown=false;this._setCloseTooltip(true);je.inform('focus-tab',this._threadID);},_blurTab:function(){na.removeClass(this._tabElem,'focusedTab');!this._closeMouseDown&&this._setCloseTooltip(false);},_setCloseTooltip:function(ne){if(t.get('chat_react_header')){this._closeButton.isMounted()&&this._closeButton.setProps({active:ne});return;}var oe=this._getNode('titlebarCloseButton'),pe=ne?yc._("Presiona Esc para cerrar"):yc._("Cerrar pesta\u00f1a");mc.set(oe,pe,'above');},_inputKeyDown:function(event){this.tryMarkAsRead();if(event.keyCode===cb.RETURN&&!event.shiftKey){if(ee(this)){ce(this);event.kill&&event.kill();return;}zd(this);if(cc.WebStickerTrigger)this._stickerTriggerController.activateAfterparty();event.kill&&event.kill();return;}if(event.keyCode===cb.DOWN&&event.shiftKey&&this.hasEmptyInput()){event.kill&&event.kill();da.lowerTab(this._threadID);this.focus();return;}this._handleHotkeyPressed(event);},_initializeInput:function(){if(!t.get('chat_react_input')){var ne=this._inputContainerNode.clientHeight;kc.getInstance(this._getNode('input')).subscribe('resize',function(){var oe=this._inputContainerNode.clientHeight;if(oe!=ne)this._nubController.flyoutContentChanged();ne=oe;}.bind(this));this._listen('input','focus',this._focusTab);this._listen('input','blur',this._blurTab);this._listen('input','paste',this._inputPasted);if(qc.firefox()&&oa.get()=='ko_KR'){this._listen('input','keyup',this._inputKeyDown);}else this._listen('input','keydown',this._inputKeyDown);this._initializeThingsWithInputFn(this._tabTemplate.getNode('input'));}else{this._chatInput=yb.render(yb.createElement(cd,{initializeThingsWithInputFn:this._initializeThingsWithInputFn.bind(this),inputChanged:function(oe){if(cc.WebStickerTrigger)this._stickerTriggerController.updateInput(oe);}.bind(this),inputKeyDown:this._inputKeyDown.bind(this),onAddMention:this._onAddMention.bind(this),onBlur:this._blurTab.bind(this),onEscape:this._handleEscape.bind(this),onFocus:this._focusTab.bind(this),onTab:this._handleTabPressed.bind(this),openFlyoutFn:this._toggleStickersFlyoutShownLegacy.bind(this,true),stickersFlyoutToggler:this._stickersFlyoutToggler,searchTriggeredWord:function(){this._toggleStickersFlyoutShownLegacy(true);this._searchStickers(this._stickerTriggerController.getTriggeredWord());}.bind(this),resizeFn:function(oe){gc.set(this._getNode('inputContainer'),'height',oe+'px');this._nubController.flyoutContentChanged();}.bind(this),uploadPhotoFn:this._photoUploader.uploadFile}),this._getNode('chatInputContainer'));if(cc.WebStickerTrigger)this._stickerTriggerController.setInput(this._chatInput);}},_initializeSharePreview:function(ne,oe){this._sharePreview=yb.render(yb.createElement(kb,{imageSize:{width:qd,height:qd},location:jb.CHAT_PREVIEW,onClose:this._focusInput.bind(this),onUpdate:function(){he(this);ge(this);}.bind(this)}),this._getNode('shareAttachmentShelf'));xa.listen(ne,'keyup',function(){var pe=oe?oe():ne.value;!pe.length&&this._urlScraper.reset();}.bind(this));this._urlScraper=new oc(ne,oe);this._urlScraper.subscribe('match',function(pe,qe){this._sharePreview.setProps({share:null,uri:(qe&&qe.url)});}.bind(this));},_initializeThingsWithInputFn:function(ne,oe){if(t.get('chat_react_share_uploader')){this._initializeSharePreview(ne,oe);}else{this._shareLinkUploader=new aa(this._getNode('shareAttachmentShelf'),ne,this.focus.bind(this),oe,this._appendTextToInput.bind(this));this._initializeUploader(this._shareLinkUploader);}kd.getThreadMeta(this._threadID,function(pe){gd.getServerThreadID(this._threadID,function(qe){this._typingDetector=new nc(this._getCanonicalUserID(),ne,'mercury-chat',null,qe,oe);}.bind(this));}.bind(this));},_getInputValue:function(){if(t.get('chat_react_input')){if(!this._chatInput||!this._chatInput.isMounted())return '';return this._chatInput.getValue()||'';}else return this._tabTemplate.getNode('input').value||'';},_appendTextToInput:function(ne){if(t.get('chat_react_input')){if(this._chatInput&&this._chatInput.isMounted())this._chatInput.appendText(ne);}else this._getNode('input').value+=ne;},_hasUnfinishedPost:function(){return fe(this)||de(this);},tryMarkAsRead:function(){if(!this._messagesView||this._messagesView.isScrolledToBottom()){jd.markRead(this._threadID);jd.markSeen(this._threadID);return true;}return false;},_chatConvClicked:function(ne){this.tryMarkAsRead();if(ub.byTag(ne.getTarget(),'a')||ra.getSelection())return;this.focus();},_inputContainerClicked:function(ne){this.tryMarkAsRead();this.focus();},showTypingIndicator:function(ne){if(t.get('chat_closed_tab_typing_indicator_animated')){var oe=ra.find(this._tabElem,"._54m9");if(ne){this._animatedTypingIndicator=yb.render(yb.createElement(o,{bootloadPlaceholder:yb.createElement("span",null),bootloadComponent:function(pe){n.loadModules(["MercuryTypingAnimation.react"],pe);}}),oe);this._updateAnimatedIndicatorColor();na.addClass(this._tabElem,"_54m8");na.show(oe);}else{na.removeClass(this._tabElem,"_54m8");na.hide(oe);yb.unmountComponentAtNode(oe);this._animatedTypingIndicator=null;}}else na.conditionClass(this._tabElem,'typing',ne);},_updateAnimatedIndicatorColor:function(){if(this._animatedTypingIndicator){var ne=na.hasClass(this._tabElem,'highlightTab')?'light':'dark';this._animatedTypingIndicator.setProps({color:ne});}},_updateUnreadCount:function(ne){var oe=ne.unread_count;if(typeof oe!='undefined'){var pe=!!oe&&(!r.showsTabUnreadUI||r.showsTabUnreadUI()),qe=this._getNode('numMessages');na.conditionShow(qe,pe);na.conditionClass(this._tabElem,'highlightTab',pe);this._updateAnimatedIndicatorColor();wd(this._threadID,this._tabElem,pe);ra.setContent(qe,oe);}},_updateCallLink:function(){var ne=this._getCanonicalUserID();if(ne===ma.getID()){this._hideVideoCallouts();if(t.get('chat_react_header')){this._videoCallButton.isMounted()&&this._videoCallButton.setProps({shown:false});}else na.hide(this._getNode('videoCallLink'));return;}var oe=ya.callabilityForUser(ne),pe=fb.getParticipantIDFromUserID(ne);if(oe!=ya.CallabilityStatus.AVAILABLE)this._hideVideoCallouts();ib.get(pe,function(qe){this._setVideoCallTooltip(ya.generateCallButtonTooltip(qe.short_name,oe));}.bind(this));},_setVideoCallTooltip:function(ne){if(t.get('chat_react_header')){this._videoCallButton.isMounted()&&this._videoCallButton.setProps({tooltipLabel:ne});}else mc.set(this._getNode('videoCallLink'),ne);},_hideVideoCallouts:function(){this._contextualDialogController.hideVideoCallouts();},_updatePrivacyLink:function(ne){var oe;if(ne==y.OFFLINE){oe=yc._("Con\u00e9ctate");if(t.get('chat_react_option_menu')){this._reactChatTabMenu.isMounted()&&this._reactChatTabMenu.setProps({privacyText:oe});}else ra.setContent(this._privacyLink,oe);return;}var pe=this._getCanonicalUserID();if(!pe)return;var qe='fbid:'+pe;ib.get(qe,function(re){if(ne==y.BLOCKED){oe=yc._("Activar el chat para  {name}",[yc.param("name",re.short_name)]);}else oe=yc._("Desactivar el chat para {name}",[yc.param("name",re.short_name)]);if(t.get('chat_react_option_menu')){this._reactChatTabMenu.isMounted()&&this._reactChatTabMenu.setProps({privacyText:oe});}else ra.setContent(this._privacyLink,oe);}.bind(this));},_unsubscribeToThread:function(){if(!kd.isEmptyLocalThread(this._threadID)){var ne=fd.constructLogMessageObject(lb.CHAT_WEB,this._threadID,hb.UNSUBSCRIBE,{removed_participants:[qb.getID()]});dd.send(ne);}da.closeTab(this._threadID,'unsubscribed');return true;},_switchToWork:function(){if(!kd.isEmptyLocalThread(this._threadID)){var ne=fd.constructLogMessageObject(lb.CHAT_WEB,this._threadID,hb.SWITCH_TO_WORK,{removed_participants:[qb.getID()]});dd.send(ne);}da.closeTab(this._threadID,'unsubscribed');return true;},_initializeUploader:function(ne){this._subscriptionsHandler.addSubscriptions(ne.subscribe(['all-uploads-completed','upload-canceled'],function(){ge(this);}.bind(this)),ne.subscribe('dom-updated',function(){he(this);}.bind(this)),ne.subscribe('submit',function(){this._focusInput();}.bind(this)));},_initializeReactMenu:function(ne){var oe=this._getNode('menuContainer'),pe=fb.isMultichat(this._threadID),qe=kd.isNewEmptyLocalThread(this._threadID),re=this._sheetController.openAddFriendsSheet.bind(this._sheetController);if(oe)this._reactChatTabMenu=yb.render(yb.createElement(ea,{onFileUploaderMounted:this.setFileUploader.bind(this),updatePrivacyLinkFunc:this._updatePrivacyLink.bind(this),nameConversationFunc:this._nameConversationLinkClicked.bind(this),showParticipantsFunc:this._showParticipantsClicked.bind(this),leaveConversationFunc:this._unsubscribeLinkClicked.bind(this),clearHistoryFunc:this._clearHistory.bind(this),reportSpamFunc:this._reportSpamClicked.bind(this),createGroupFunc:this._createGroupClicked.bind(this),switchToWorkFunc:this._switchToWorkUserClicked.bind(this),isMultichat:pe,isEmptyChat:qe,showAddFriend:re,threadID:this._threadID,attachmentsShelf:ne,onUploadFinished:ge.bind(this,this),onUpdateAttachmentsShelf:he.bind(this,this),onSubmit:this._focusInput.bind(this),enableDesktopNotif:function(){this._enableDesktopNotif();}.bind(this)}),oe);},_initializeArchiveWarning:function(){if(t.get('chat_react_header'))this._archiveWarning=yb.render(yb.createElement(q,{isFBAtWork:t.IsWorkUser,shown:true}),this._getNode('archiveContainer'));},_initializeAddToThreadButton:function(){if(t.get('chat_react_header')){this._addToThreadButton=yb.render(yb.createElement(p,{isFBAtWork:t.get('IsWorkUser',false),onClick:this._addFriendLinkClicked.bind(this),shown:true}),this._getNode('addToThreadContainer'));}else this._listen('addToThreadLink','click',this._addFriendLinkClicked,true);},_initializeVideoCallButton:function(){if(!fb.getUserIDFromThreadID(this._threadID))return;var ne=null;if(t.get('chat_react_header')){this._videoCallButton=yb.render(yb.createElement(ka,{shown:true,onClick:this._callClicked.bind(this),onKeyUp:this._callEnter.bind(this)}),this._getNode('videoCallButtonContainer'));ne=yb.findDOMNode(this._videoCallButton);}else{ne=this._getNode('videoCallLink');this._listen('videoCallLink','click',this._callClicked,true);this._listen('videoCallLink','keyup',this._callEnter,true);}this._contextualDialogController=new u(this._threadID,ne);},_initializeCloseButton:function(){if(t.get('chat_react_header')){this._closeButton=yb.render(yb.createElement(s,{onClick:this._closeClicked.bind(this),onKeyUp:this._closeEnter.bind(this),onMouseDown:this._closePreClicked.bind(this)}),this._getNode('closeButtonContainer'));}else{this._listen('titlebarCloseButton','click',this._closeClicked);this._listen('titlebarCloseButton','keyup',this._closeEnter);this._listen('titlebarCloseButton','mousedown',this._closePreClicked);}},_initializeTitle:function(){if(t.get('chat_react_header')){var ne=kd.getThreadMetaNow(this._threadID);this._title=yb.render(yb.createElement(ia,{isNewThread:kd.isNewEmptyLocalThread(this._threadID),thread:ne,viewer:ma.getID()}),this._getNode('titleContainer'));}},setFileUploader:function(ne){this._fileUploader=ne;},_initializeAutoSendPhotoUploader:function(){this._photoUploader=yb.render(yb.createElement(x,{onSubmit:this._handlePUSubmit.bind(this),onAllUploadsComplete:this._handlePUAllUploadsCompleted.bind(this),onLastUploadFail:this._handlePULastUploadFailed.bind(this),onLastUploadCancel:this._handlePULastUploadCanceled.bind(this)}),this._getNode('photoUploaderContainer'));},_handlePUSubmit:function(ne,oe){ie(this,vb.UPLOAD_START,oe);be(this,'',[],function(pe){if(this._threadID!==pe.thread_id){this._newThreadIDFromPhotoUpload=pe.thread_id;if(this._messagesView)this._messagesView.setNewThreadID(pe.thread_id);}pe.content_attachment=null;dd.addAttachmentPlaceholder(pe,oe.upload_id,oe);}.bind(this));me('submit',oe);this._focusInput();},_handlePULastUploadFailed:function(ne,oe){ie(this,vb.CLIENT_ERROR,oe);me('failed',oe);dd.cancelAttachmentPlaceholder(oe.upload_id,oe);var pe=yc._("Error al subir la foto"),qe=yc._("Vuelve a intentarlo. Aseg\u00farate de subir una foto v\u00e1lida.");new pa().setTitle(pe).setBody(qe).setButtons(pa.OK).show();},_handlePULastUploadCanceled:function(ne,oe){ie(this,vb.CANCEL_DURING_UPLOAD,oe);me('canceled',oe);dd.cancelAttachmentPlaceholder(oe.upload_id,oe);},_handlePUAllUploadsCompleted:function(ne,oe){ie(this,vb.ALL_UPLOADS_DONE,oe);me('completed',oe);dd.confirmAttachmentPlaceholder(oe.upload_id,oe);var pe=oe.image_ids.length||oe.attachments.length;ae(this,pe);},_stickerSelected:function(ne){be(this,'',[],function(oe){oe.has_attachment=true;oe.sticker_id=ne;dd.send(oe);this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_emoticonSelected:function(ne){var oe=va.symbols[ne];if(!oe)return;if(t.get('chat_react_input')){this._chatInput.insertEmoticon(oe);return;}this._selectionPosition=this._selectionPosition||new ac(this._getNode('input'));var pe=kc.getInstance(this._getNode('input')),qe=pe.getValue(),re=wa.insertEmoticon(oe,qe,this._selectionPosition.getPos());pe.setValue(re.result);this._selectionPosition.setPos(re.start,re.end);},_orionTriggered:function(){be(this,'',[],function(ne){this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_addStickerSearchNUXIndicator:function(){na.addClass(this._getNode('emoticonIndicator'),'nux');od=false;},_onFlyoutShown:function(ne){if(t.get('chat_react_sticker_button')){var oe=this._stickersFlyout.props.packID;if(oe!==dc.SEARCH_PACK_ID)this.focus();}if(cc.WebStickerTrigger){this._stickerTriggerController.onFlyoutShown(ne);}else ne();this._stickersFlyoutShown=true;},_searchStickers:function(ne,oe){this._stickersFlyout.isMounted()&&this._stickersFlyout.setProps({packID:dc.SEARCH_PACK_ID,trigger:ne},oe);},_onFlyoutHidden:function(){this._stickersFlyoutShown=false;this.focus();},_setTitleHref:function(ne){if(t.get('chat_react_header')){this._title.isMounted()&&this._title.setProps({href:ne});}else{var oe=this._getNode('titlebarText');oe.setAttribute('href',ne);oe.removeAttribute('rel');na.removeClass(oe,'noLink');}},_onAddMention:function(ne){this._linkDropped((new pc(ne.getURI())).getQualifiedURI().toString());}});function me(ne,oe){rd.debug('photo_uploader:'+ne,Object.assign({},oe));}e.exports=je;},null);
__d("ChatNewMessageHandler",["ChatActivity","ChatMentionsNotifications","ChatTabModel","ChatTabView","JSLogger","MercuryAssert","MercuryBrowserAlerts","UserActivity","MercuryConfig","MercuryThreadlistConstants"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();var q=k.create('chat_new_message'),r={_notify:function(s,t,u){if(o.DesktopNotificationsGK)h.notifyIfMessageToMe(t);var v=j.get(s);u.view_is_visible=v&&v.isVisible();u.view_is_focused=v&&v.isFocused();if(!u.view_is_visible)q.log('message_to_hidden');u.is_active=g.isActive();m.messageReceived(t);},newMessage:function(s,t){l.isThreadID(s);var u=i.getTab(s),v={thread_id:s,message_id:t.message_id,to_new_tab:!u,to_raised_tab:u?!!u.raised:true};this._notify(s,t,v);q.log('message',v);}};m.subscribe('before-alert',function(s,event){var t=event.threadID,u=j.get(t),v=i.getTab(t),w=p.MESSAGE_NOTICE_INACTIVITY_THRESHOLD;if(v&&v.raised&&u&&u.isVisible()&&u.isFocused()&&n.isActive(w)){u.tryMarkAsRead();event.cancelAlert();}});e.exports=r;},null);
__d("ChatTabLRUManager",["ChatTabView","ChatTabModel","InitialServerTime","MercuryThreads"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=b('MercuryThreads').get(),k={getLRUVisibleTab:function(l){if(l.hasRoomForRaisedTab())return (void 0);var m=Object.keys(l.getTabsToShow()||{}),n=1*60,o=null,p=Infinity;for(var q=0;q<m.length;q++){var r=m[q],s=j.getThreadMetaNow(r);if(h.isTabPromoted(r))continue;if(!g.get(r).hasEmptyInput()||!s)continue;var t=(i.serverTime-s.timestamp)/1000;if(!s.timestamp||(s.timestamp&&s.timestamp<p&&t>n)){o=s.thread_id;p=s.timestamp;}}return o;}};e.exports=k;},null);
__d("ChatTabPolicy",["ChatBehavior","JSLogger","MercuryActionType","MercuryLogMessageType","MercuryAssert","MercuryIDs","MercuryParticipantTypes","MercurySourceType","MercuryThreadInfo","MercuryThreadMode","MercuryViewer","MessagingTag","PresencePrivacy","ShortProfiles","MercuryThreadActions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();var u=b('MercuryThreadActions').get(),v=h.create('tab_policy');e.exports={messageIsAllowed:function(w,x,y){var z=w.thread_id,aa=x.message_id;k.isThreadID(z);k.isParticipantID(x.author);var ba;if(o.isMuted(w)){ba={thread_id:z,message_id:aa,mute_settings:w.mute_settings};v.log('message_thread_muted',ba);return;}if(w.mode==p.OBJECT_ORIGINATED){ba={thread_id:z,message_id:aa,mode:w.mode};v.log('message_object_originated',ba);return;}if(x.source==n.EMAIL||x.source==n.TITAN_EMAIL_REPLY){ba={thread_id:z,message_id:aa,source:x.source};v.log('message_source_not_allowed',ba);return;}var ca=l.getUserIDFromParticipantID(x.author);if(!ca){v.log('message_bad_author',{thread_id:z,message_id:aa,user:ca});return;}if(x.action_type!=i.USER_GENERATED_MESSAGE&&!this._messageIsNewlyCreatedGroup(x,w)){ba={thread_id:z,message_id:aa,type:x.action_type};v.log('message_non_user_generated',ba);return;}if(w.is_canonical_user&&!g.notifiesUserMessages()){v.log('message_jabber',{thread_id:z,message_id:aa});u.markSeen(z,true);return;}if(w.is_canonical&&!w.canonical_fbid){v.log('message_canonical_contact',{thread_id:z,message_id:aa});return;}if(w.folder!=r.INBOX){v.log('message_folder',{thread_id:z,message_id:aa,folder:w.folder});return;}var da=l.getUserIDFromParticipantID(q.getID());t.getMulti([ca,da],function(ea){if(!s.allows(ca)){v.log('message_privacy',{thread_id:z,message_id:aa,user:ca});return;}var fa=ea[ca].employee&&ea[da].employee;if(!fa&&ea[ca].type!==m.FRIEND){v.log('message_non_friend',{thread_id:z,message_id:aa,user:ca});return;}y();});},_messageIsNewlyCreatedGroup:function(w,x){return w.action_type===i.LOG_MESSAGE&&w.log_message_type===j.THREAD_NAME&&x.message_count===1;}};},null);
__d("ChatTabViewSelector",["Event","Arbiter","ChatTabActions","CSS","DataStore","DOM","MenuDeprecated","NubController","ChatTabTemplates","Toggler","copyProperties","MercuryThreadInformer","MercuryThreads","MercuryThreadMetadataRenderer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();var r=b('MercuryThreadInformer').get(),s=b('MercuryThreads').get(),t=b('MercuryThreadMetadataRenderer').get();function u(v){var w=o[':fb:chat:tab:selector'].build(),x=w.getRoot(),y=w.getNode('menu'),z=l.find(y,'.uiMenuInner'),aa={},ba=new n().init(x);j.hide(x);l.insertBefore(v,x);function ca(fa){var ga=0;for(var ha in aa){var ia=aa[ha],ja=s.getThreadMetaNow(ha),ka=ia.getNode('unreadCount'),la=(ja&&ja.unread_count)||0;ga+=la;if(la>9)la='+';j.conditionClass(ka,'invisible_elem',!la);l.setContent(ka,la);}var ma=w.getNode('numMessages');j.conditionShow(ma,ga);l.setContent(ma,ga);}this.setTabData=function(fa){aa={};if(fa.length<1){j.hide(x);return;}j.show(x);l.empty(z);fa.forEach(function(ga){var ha=o[':fb:chat:tab:selector:item'].build();aa[ga.id]=ha;var ia=ha.getNode('content');t.renderAndSeparatedParticipantList(ga.id,ia);l.prependContent(z,ha.getRoot());k.set(ha.getRoot(),'threadID',ga.id);var ja=ha.getNode('closeButton');g.listen(ja,'click',function(event){i.closeTab(ga.id,'selector/close-tab');event.kill();});});ba.flyoutContentChanged();l.setContent(w.getNode('numTabs'),fa.length);ca();};function da(event,fa){if(fa.menu!=y)return;var ga=k.get(fa.item,'threadID');u.inform('selected',ga);p.hide(x);}function ea(event,fa){m.register(y);}m.subscribe('select',da.bind(this));p.listen('show',x,function(){h.inform('layer_shown',{type:'ChatTabSelector'});ea();});p.listen('hide',x,function(){h.inform('layer_hidden',{type:'ChatTabSelector'});});r.subscribe('threads-updated',ca);}q(u,new h());e.exports=u;},null);
__d("ChatTabController",["Arbiter","BanzaiLogger","ChatActivity","ChatConfig","ChatNewMessageHandler","ChatTabActions","ChatTabLRUManager","ChatTabMessagesView","ChatTabModel","ChatTabPolicy","ChatTabView","ChatTabViewSelector","JSLogger","MercuryViewer","Style","UserAgent_DEPRECATED","VideoCallCore","ChatTabPresence","ChatTypeaheadBehavior","MercuryThreadInformer","MercuryThreadActions","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){b.__markCompiled&&b.__markCompiled();b('ChatTabPresence');b('ChatTypeaheadBehavior');var x=b('MercuryThreadInformer').get(),y=b('MercuryThreadActions').get(),z=b('MercuryThreads').get(),aa=j.get('tab_auto_close_timeout')||7200000,ba=s.create('tab_controller');function ca(na,oa,pa){var qa=o.get().tabs,ra=qa[na],sa,ta;if(qa.length===0)return false;var ua=qa.slice(na+1),va=qa.slice(0,na),wa=ua.concat(va);if(!oa)wa.reverse();if(ra)wa.push(ra);for(var xa=0;xa<wa.length;xa++){sa=wa[xa];ta=q.get(sa.id);if(ta&&ta.isVisible()&&(!pa||sa.raised)){ta.focus();return true;}}return false;}function da(na,oa){var pa=oa&&oa.getRightmostHiddenTab();if(pa===na)return null;return pa;}function ea(){return Math.floor(Math.random()*2147483648).toString(16);}function fa(na,oa,pa,qa){l.raiseTab(na,true,pa);var ra=oa&&oa.getLeftmostVisibleTab(),sa=oa&&oa.getTabsToShow();if(sa&&!sa[na]&&ra){o.promoteThreadInPlaceOfThread(na,ra,da(na,oa),true);}else l.promoteTab(na);g.inform('chat/open-tab',na);var ta=q.get(na);ta&&ta.focus();}function ga(na,oa){if(!o.getTab(na))l.raiseTab(na,false);var pa=oa&&m.getLRUVisibleTab(oa),qa=oa&&oa.getTabsToShow();if(qa&&!qa[na]&&pa)o.promoteThreadInPlaceOfThread(na,pa,da(na,oa));}function ha(na){r.subscribe('selected',function(pa,qa){fa(qa,na);});g.subscribe('page_transition',function(pa,qa){l.closeFragileTabs();});g.subscribe('chat-visibility/go-offline',function(){l.closeAllTabs();});i.subscribe('idle',function(pa,qa){if(qa>aa){var ra=o.get().tabs;ra.forEach(function(sa){var ta=sa.id;z.getThreadMeta(ta,function(ua){if(!ua.unread_count){ba.log('autoclose_idle_seen',{thread_id:ta,idleness:qa});l.closeTab(ta,'autoclose_idle_seen');}});});}});q.subscribe('nub-activated',function(pa,qa){fa(qa,na);});q.subscribe('focus-tab',function(pa,qa){var ra=o.getTab(qa);if(ra&&ra.raised)fa(qa,na,ra.signatureID,true);});function oa(pa,qa){h.log('VideoCallLoggerConfig',{event:'chat_tab_call_click'});w.showOutgoingCallDialog(qa.userID,qa.clickSource);}q.subscribe('video-call-clicked',oa);n.subscribe('video-call-clicked',oa);n.subscribe('interaction-with-tab',function(pa,qa){var ra=o.getTab(qa);ra&&ra.raised&&y.markSeen(qa);});q.subscribe('esc-pressed',function(pa,qa){ba.log('close_esc',{thread_id:qa});var ra=o.indexOf(qa);l.closeTab(qa,'close_esc');setTimeout(function(){ca(ra-1,true,true);},0);});x.subscribe('messages-received',function(pa,qa){for(var ra in qa){var sa=qa[ra];for(var ta=0;ta<sa.length;ta++){var ua=sa[ta];if(ua.author!=t.getID()){if(!ua.is_unread){ba.log('message_already_read',{action_id:ua.action_id,thread_id:ua.thread_id});continue;}z.getThreadMeta(ra,function(va){p.messageIsAllowed(va,ua,function(){ga(ra,na);k.newMessage(ra,ua);});});}}}});x.subscribe('thread-read-changed',function(pa,qa){for(var ra in qa)if(!qa[ra].mark_as_read){ba.log('autoclose_marked_unread',{thread_id:ra});l.closeTab(ra,'autoclose_marked_unread');}});q.subscribe('tab-pressed',function(pa,qa){return !ca(o.indexOf(qa.id),qa.shiftPressed);});g.subscribe(s.DUMP_EVENT,function(pa,qa){qa.chat_controller={auto_close_timeout:aa};});this.openTab=function(pa,qa,ra){fa(pa,qa,ea());if(ra)ra(q.get(pa));};}if(v.firefox()){var ia=function(){return u.get(document.body,'overflowX')+' '+u.get(document.body,'overflowY');},ja=ia(),ka=function(){var na=ia();if(na!==ja){ja=na;g.inform('overflow-applied-to-body');}};if('MutationObserver' in window){var la=new MutationObserver(ka),ma={attributes:true,attributeFilter:['class','style']};la.observe(document.documentElement,ma);}else document.documentElement.addEventListener('DOMAttrModified',function(event){if(event.getTarget()===document.documentElement&&(event.attrName==='class'||event.attrName==='style'))ka();},false);}e.exports=ha;},null);
__d("ChatTabViewCoordinator",["Arbiter","ChatTabModel","ChatTabView","ChatTabViewSelector","CSS","JSLogger","VideoCallSupport"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n=l.create('chat_tab_coordinator');function o(p,q){var r=new j(p),s={},t=false;function u(){var y=h.get(),z={};y.tabs.forEach(function(ba){z[ba.id]=1;});n.log('process_tab_changed',{model_tabs:Object.keys(z),view_tabs:Object.keys(s)});for(var aa in s)if(!z[aa]){n.log('remove_tab',{tab_id:aa});s[aa].destroy();delete(s[aa]);}v(y);w(y);if(y.tabNeedsFocus&&!y.tabNeedsFocus.isFocused())y.tabNeedsFocus.focus();}function v(y){var z=null;y.tabs.forEach(function(aa){var ba=aa.id,ca=false;if(!s[ba]){n.log('add_tab',{tab_id:ba});s[ba]=new i(ba,aa.server_id,aa.signatureID,p,z);ca=true;}else s[ba].updateSignatureID(aa.signatureID);if(s[ba].isFocused())y.tabNeedsFocus=s[ba];if(!ca&&!s[ba].nextTabIs(z)){var da=s[ba].getScrollTop();if(z){s[ba].insertBefore(z);}else s[ba].appendTo(p);if(da)s[ba].setScrollTop(da);}z=s[ba];});}function w(y){var z=q.getTabsToShow(y),aa=[],ba=false;y.tabs.forEach(function(ca){if(!z[ca.id]){s[ca.id].setVisibleState(false,ca.raised);aa.push(ca);}});y.tabs.forEach(function(ca){if(z[ca.id]){s[ca.id].setVisibleState(true,ca.raised);ba|=ca.raised;}});r.setTabData(aa);x(ba);}function x(y){if(!y&&t){g.inform('layer_hidden',{type:'ChatTab'});t=false;}else if(y&&!t){g.inform('layer_shown',{type:'ChatTab'});t=true;}}if(m.isVideoCallSupported())k.addClass(p,'videoCallEnabled');q.subscribe('tabs-changed',u);u();}e.exports=o;},null);
__d("TabsViewport",["Arbiter","ArbiterMixin","ChatTabModel","Dock","DOM","DOMDimensions","Event","Parent","Vector","ViewportBounds","areJSONRepresentationsEqual","copyProperties","csx","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();var u=175,v=269,w=0;function x(){return u;}function y(){return v;}function z(aa){this._root=aa;var ba=this._recalculateWidth.bind(this);m.listen(window,'resize',ba);j.subscribe('resize',ba);g.subscribeOnce('sidebar/initialized',ba,g.SUBSCRIBE_NEW);i.subscribe('chat/tabs-changed',t(this._recalculateTabs,this,true));this._recalculateWidth();this._initialized=true;}r(z.prototype,h,{_root:null,_initialized:false,_availableWidth:0,_maxShown:1,_viewState:null,_recalculateWidth:function(){var aa=z._getAvailableDockWidth(this._root),ba=Math.max(1,Math.floor(aa/y())),ca=ba!=this._maxShown;if(!this._viewState||ca||aa<=this._viewState.usedWidth||aa>this._viewState.widthToShowNext){this._availableWidth=aa;this._maxShown=ba;this._viewState=null;this._recalculateTabs(ca);}},_onTabsChanged:function(){if(this._initialized){this.inform('tabs-changed');this.inform('max-to-show-changed',this._maxShown);this.inform('max-to-show-change-completed');}},_recalculateTabs:function(aa){var ba=z._getTabsToShow(i.get(),this._availableWidth);if(aa||!q(this._viewState,ba)){this._viewState=ba;this._onTabsChanged();}},getMaxTabsToShow:function(){return this._maxShown;},checkWidth:function(){this._recalculateWidth();},hasRoomForRaisedTab:function(){return this._availableWidth-this._viewState.usedWidth>y();},getTabsToShow:function(){return JSON.parse(JSON.stringify(this._viewState.tabsToShow));},getShowingTabsOrder:function(){var aa=i.get(),ba=this._viewState.tabsToShow;return aa.tabs.filter(function(ca){return ba[ca.id];});},getRightmostHiddenTab:function(){var aa=i.get(),ba=this._viewState.tabsToShow,ca=aa.tabs.filter(function(ea){return !ba[ea.id];}),da=ca.shift();return da?da.id:null;},getLeftmostVisibleTab:function(){var aa=this.getShowingTabsOrder(),ba=aa.pop();return ba?ba.id:null;},getRaisedVisibleTabs:function(){var aa=[],ba=this.getShowingTabsOrder(),ca=ba.length;for(var da=0;da<ca;da++)if(i.getTab(ba[da].id).raised)aa.push(ba[da].id);return aa;},shouldPromoteOnRaise:function(aa){if(!this._viewState.tabsToShow[aa])return true;if(this._viewState.nextToHide!=aa)return false;var ba=i.getTab(aa),ca=ba&&ba.raised;return !ca&&(this._availableWidth-this._viewState.usedWidth<y()-x());}});r(z,{_getAvailableDockWidth:function(aa){var ba=l.getViewportWithoutScrollbarDimensions().width;ba-=p.getLeft()+p.getRight();ba-=50;var ca=n.byClass(aa,'fbDock'),da=k.find(ca,"._56ox"),ea=o.getElementDimensions(da).x;ba-=ea;var fa=k.scry(ca,"._56oy");ea+=o.getElementDimensions(fa.pop()).x;var ga=o.getElementDimensions(ca),ha=ga.x-ea;if(ha>w)w=ha;ba-=w;ba-=15;return Math.max(ba,0);},_getTabsToShow:function(aa,ba){ba=Math.max(ba,y()+1);function ca(sa,ta){return (sa.raised||!ta)?y():x();}var da=JSON.parse(JSON.stringify(aa.tabs)),ea=-1,fa=null;if(aa.promoted)da.forEach(function(sa,ta){if(sa.id===aa.promoted){ea=ta;fa=sa;}});var ga=0,ha=false,ia=0,ja=!fa;da.forEach(function(sa,ta){var ua=ca(sa,ha);ha=ha||!sa.raised;sa.leftmostOffset=ga+ua;ga+=ua;if(sa.leftmostOffset<ba)ia++;ja|=ta==ea;sa.alreadyPlacedPromoted=ja;});function ka(sa,ta,ua){var va={};for(var wa=0;wa<ta;wa++){var xa=sa[wa];if(!xa.alreadyPlacedPromoted&&wa==ta-1){va[ua]=true;}else va[xa.id]=true;}return va;}var la=ka(da,ia,aa.promoted),ma=ka(da,ia-1,aa.promoted),na=null;for(var oa in la)if(!ma[oa])na=oa;var pa=da[ia-1],qa=pa?pa.leftmostOffset:0,ra=Infinity;if(ia<da.length)ra=da[ia].leftmostOffset;return {nextToHide:na,tabsToShow:la,usedWidth:qa,widthToShowNext:ra};}});e.exports=z;},null);
__d("ChatApp",["CSS","JSLogger","Promise"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j={init:function(m,n,o){if(this._isInitialized){h.create('chat_app').error('repeated_init');return;}this._rootElem=m;i.resolve().then(function(){return k(o);}).then(function(){return l(n);}).then(function(){this._isInitialized=this._isLoaded=true;}.bind(this));},isInitialized:function(){return !!this._isInitialized;},isHidden:function(){return !this._isInitialized||this._isHidden;},hide:function(){if(this.isHidden())return;g.hide(this._rootElem);this._isHidden=true;},unhide:function(){if(this._isInitialized){if(this._isHidden){g.show(this._rootElem);this.tabsViewport.checkWidth();d(['Dock'],function(m){m.resizeAllFlyouts();});this._isHidden=false;}}else if(!this._isLoaded){d(['UIPagelet'],function(m){m.loadFromEndpoint('ChatTabsPagelet','ChatTabsPagelet');m.loadFromEndpoint('BuddylistPagelet','BuddylistPagelet');});this._isLoaded=true;}}};function k(m){return new i(function(n){d(['MercuryChannelHandler','MercuryDeliveryState','MercuryServerRequests','MercuryStateCheck'],function(o,p,q,r){o.get().turnOn();q.get().handleUpdate(m);p.get();r.initialize();n();});});}function l(m){return new i(function(n){d(['ChatTabController','ChatTabViewCoordinator','TabsViewport'],function(o,p,q){j.tabsViewport=new q(m);j.tabViewCoordinator=new p(m,j.tabsViewport);j.tabController=new o(j.tabsViewport);n();});});}e.exports=j;},null);