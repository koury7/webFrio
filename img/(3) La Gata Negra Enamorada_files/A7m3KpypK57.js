/*!CK:4107086561!*//*1427386974,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["7\/tp8"]); }

__d("GroupSellUserActionEvents",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={MARK_AS_SOLD:"mark_as_sold",MARK_AS_AVAILABLE:"mark_as_available",GROUP_POST:"group_post",LAUNCH_EDIT:"launch_edit",GROUP_POST_EDIT:"group_post_edit",ADMIN_OPT_IN:"admin_opt_in",ADMIN_OPT_OUT:"admin_opt_out",ADMIN_NOT_FOR_SALE:"admin_not_for_sale",ADMIN_DO_NOT_WANT:"admin_do_not_want",OPT_IN_MEGAPHONE_SEEN:"opt_in_megaphone_seen",OPT_IN_NOTIFICATION_SENT:"opt_in_notification_sent",GROUP_NON_FOR_SALE_POST:"group_non_for_sale_post",GROUP_ENABLED:"group_enabled",GROUP_DISABLED:"group_disabled",GROUP_NON_FOR_SALE_POST_INTERCEPT_WORDS:"group_non_for_sale_post_intercept_words",FOR_SALE_POST_APPROVE:"for_sale_post_approve",NON_FOR_SALE_POST_APPROVE:"non_for_sale_post_approve",FOR_SALE_POST_DELETED:"for_sale_post_deleted",NON_FOR_SALE_POST_DELETED:"non_for_sale_post_deleted",GROUP_NON_FOR_SALE_POST_INTERCEPT_CREATED:"group_non_for_sale_post_intercept_created",SHARED_TO_GROUP:"shared_to_group",COMPOSER_TOOLTIP_NUX_SEEN:"composer_tooltip_nux_seen",COMPOSER_LOAD:"composer_load",LAUNCH_SELL_COMPOSER:"launch_sell_composer",LAUNCH_NORMAL_COMPOSER:"launch_normal_composer",COMPOSER_FILL_TITLE:"composer_fill_title",COMPOSER_FILL_PRICE:"composer_fill_price",COMPOSER_FILL_DESCRIPTION:"composer_fill_description",COMPOSER_FILL_PICKUP_NOTE:"composer_fill_pickup_note",COMPOSER_DELETE_PHOTO:"composer_delete_photo",COMPOSER_SUBMIT:"composer_submit",AUTHOR_COMMENT:"author_coment",GROUP_NON_FOR_SALE_POST_INTERCEPT_DETECTED:"group_non_for_sale_post_intercept_detected",GROUP_NON_FOR_SALE_POST_INTERCEPT_DECLINED:"group_non_for_sale_post_intercept_declined",GROUP_NON_FOR_SALE_POST_INTERCEPT_ACCEPTED:"group_non_for_sale_post_intercept_accepted"};},null);
__d("ComposerTagSuggestionsWaterfall",["Banzai","copyProperties"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i='composer_tag_suggestions';function j(k){"use strict";this._waterfallID=k;}j.prototype.setWaterfallID=function(k){"use strict";this._waterfallID=k;};j.prototype._logStep=function(k,l){"use strict";l=h({},l||{},{waterfall_id:this._waterfallID,step:k});g.post(i,l);return this;};j.prototype.logBegin=function(){"use strict";return this._logStep('begin');};j.prototype.logAddPhoto=function(k){"use strict";return this._logStep('add_photo',{photo:k});};j.prototype.logAddPhotos=function(k){"use strict";k.forEach(this.logAddPhoto.bind(this));};j.prototype.logRemovePhoto=function(k,l,m){"use strict";return this._logStep('remove_photo',{photo:k,tokens:l,suggestions:m});};j.prototype.logAddToken=function(k,l){"use strict";return this._logStep('add_token',{user:k,replaced_with_tag:l});};j.prototype.logRemoveToken=function(k,l){"use strict";return this._logStep('remove_token',{user:k,suggestions:l});};j.prototype.logAddSuggestion=function(k,l,m,n){"use strict";return this._logStep('add_suggestion',{photo:k,facebox:l,user:m,certainty:n});};j.prototype.logRemoveSuggestion=function(k,l,m,n){"use strict";return this._logStep('remove_suggestion',{photo:k,facebox:l,user:m,certainty:n});};j.prototype.logAddManualTag=function(k,l,m){"use strict";return this._logStep('add_tag',{photo:k,facebox:l,user:m});};j.prototype.logRemoveManualTag=function(k,l,m){"use strict";return this._logStep('remove_tag',{photo:k,facebox:l,user:m});};j.prototype.logStartPoll=function(k){"use strict";return this._logStep('start_poll',{photos:k});};j.prototype.logStopPoll=function(k,l){"use strict";return this._logStep('stop_poll',{time_spent:k,unresolved_photos:l});};j.prototype.logSubmit=function(k,l,m,n,o,p){"use strict";return this._logStep('submit',{photos:k,tokens:l,manual_tokens:m,suggestions:n,manual_tags:o,time_spent:p});};j.prototype.logFailure=function(k,l){"use strict";return this._logStep('fail',{photo:k,user:l});};e.exports=j;},null);
__d("InstanceRegistry",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(){"use strict";this.instances={};this.waits=[];}g.prototype.set=function(h,i){"use strict";this.instances[h]=i;this.waits=this.waits.filter(function(j){if(this._isWaitResolved(j.names)){j.callback.apply(this,this._mapNamesToInstances(j.names));return false;}return true;}.bind(this));};g.prototype.get=function(h){"use strict";return this.instances[h];};g.prototype.remove=function(h){"use strict";delete this.instances[h];};g.prototype.waitFor=function(h,i){"use strict";if(this._isWaitResolved(h))return i.apply(this,this._mapNamesToInstances(h));this.waits.push({names:h,callback:i});};g.prototype.waitForAndRemove=function(h,i){"use strict";this.waitFor(h,function(){i.apply(this,arguments);h.forEach(this.remove.bind(this));}.bind(this));};g.prototype._isWaitResolved=function(h){"use strict";return h.every(this.instances.hasOwnProperty.bind(this.instances));};g.prototype._mapNamesToInstances=function(h){"use strict";return h.map(function(i){return this.instances[i];}.bind(this));};e.exports=new g();},null);
__d("PhotosTaggingFlyoutLoader",["ArbiterMixin","AsyncRequest","InstanceRegistry","URI","arrayContains","mixin","removeFromArray"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n=l(g);for(var o in n)if(n.hasOwnProperty(o))q[o]=n[o];var p=n===null?null:n.prototype;q.prototype=Object.create(p);q.prototype.constructor=q;q.__superConstructor__=n;function q(r){"use strict";this._flyouts={};this._loading=[];this._callbacks={};this._targetID=r;}q.prototype.get=function(r,s){"use strict";if(this._isLoaded(r))return s(this._flyouts[r]);this._callbacks[r]=this._callbacks[r]||[];if(!this._isLoading(r))this._load(r);this._callbacks[r].push(s);};q.prototype.whenLoaded=function(r,s){"use strict";if(this._isLoaded(r))return s(this._flyouts[r]);this._callbacks[r]=this._callbacks[r]||[];this._callbacks[r].push(s);};q.prototype._load=function(r){"use strict";if(this._isLoading(r))return;this._loading.push(r);new h().setURI(j('/ajax/photos/tagging-flyout/').addQueryData({photo:r,target:this._targetID,recognitionFeature:'composer_facerec'})).setHandler(function(){i.waitForAndRemove(['PhotosTaggingFlyout_'+r],function(s){if(!this._isLoading(r))return;this.inform('loaded',s);this._flyouts[r]=s;this._callbacks[r].forEach(function(t){t(s);});delete this._callbacks[r];}.bind(this));}.bind(this)).setFinallyHandler(function(){m(this._loading,r);}.bind(this)).send();};q.prototype._isLoading=function(r){"use strict";return k(this._loading,r);};q.prototype._isLoaded=function(r){"use strict";return !!this._flyouts[r];};q.prototype.remove=function(r){"use strict";if(this._isLoaded(r))this._flyouts[r].cleanup();delete this._flyouts[r];delete this._callbacks[r];m(this._loading,r);};q.prototype.cleanup=function(){"use strict";Object.keys(this._flyouts).forEach(this.remove.bind(this));Object.keys(this._callbacks).forEach(this.remove.bind(this));};e.exports=q;},null);
__d("FaceRecognitionController",["ArbiterMixin","BanzaiODS","Poller","copyProperties","mixin","removeFromArray"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=k(g);for(var n in m)if(m.hasOwnProperty(n))p[n]=m[n];var o=m===null?null:m.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=m;function p(q){"use strict";this._config=j({uri:'/photos/tagging/recognition/',interval:2000,maxRequests:4,targetIsPage:false,targetID:null},q);this._cleanup();this._poller=new i({dontStart:true,maxRequests:this._config.maxRequests,interval:this._config.interval,setupRequest:function(r){r.setURI(this._config.uri).setData({recognition_project:'composer_facerec',photos:this._pendingPhotos,waterfallID:this._config.waterfallID,target:this._config.targetID,is_page:this._config.targetIsPage,include_unrecognized_faceboxes:!!this._config.include_unrecognized_faceboxes,include_face_crop_src:!!this._config.include_face_crop_src,include_recognized_user_profile_picture:!!this._config.include_recognized_user_profile_picture,include_low_confidence_recognitions:!!this._config.include_low_confidence_recognitions}).setHandler(this._handleResponse.bind(this));}.bind(this)});this._poller.subscribe('done',function(){var r=this._pendingPhotos;this._cleanup();this.inform('done',{unresolved:r});}.bind(this));}p.prototype.setWaterfallID=function(q){"use strict";this._config.waterfallID=q;};p.prototype.start=function(q){"use strict";Array.prototype.push.apply(this._pendingPhotos,q);this._poller.reset();this._resetSafeguardTimeout();};p.prototype.stop=function(){"use strict";this._poller.stop();this._cleanup();};p.prototype._cleanup=function(){"use strict";window.clearTimeout(this._safeguardTimeout);this._safeguardTimeout=null;this._pendingPhotos=[];};p.prototype._resetSafeguardTimeout=function(){"use strict";window.clearTimeout(this._safeguardTimeout);this._safeguardTimeout=window.setTimeout(function(){h.bumpEntityKey('composer_facerec','safeguard');var q=this._pendingPhotos;this._poller.stop();this._cleanup();this.inform('done',{unresolved:q});}.bind(this),(this._config.maxRequests+2)*this._config.interval);};p.prototype._handleResponse=function(q){"use strict";var r=q.getPayload();r.forEach(function(s){var t=0;l(this._pendingPhotos,s.fbid);s.faceboxes.forEach(function(u){t+=u.recognitions.length;u.recognitions.forEach(function(v){this.inform('recognition',{photo:s.fbid,facebox:{fbid:u.fbid,x:u.x,y:u.y},recognition:v});}.bind(this));}.bind(this));this.inform('photo',{photo:s.fbid,faceboxes:s.faceboxes,recognitions:t});}.bind(this));if(!this._pendingPhotos.length){this._poller.stop();this._cleanup();this.inform('done',{unresolved:this._pendingPhotos});}};e.exports=p;},null);
__d("AttachmentWithPhotosTaggingFlyoutMixin",["Event","Arbiter","PhotoTagStore","ComposerTagSuggestionsWaterfall","PhotosTaggingFlyoutLoader","BanzaiODS","FaceRecognitionController","ComposerXNUX","DOM","CSS","cx","csx","DOMQuery","isEmpty","fbt","Tooltip","Parent","Form","SubscriptionsHandler","copyProperties","PhotosUploadWaterfallXMixin","AsyncRequest","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca){b.__markCompiled&&b.__markCompiled();var da=[];e.exports=z(aa,{initTaggingFlyoutMixin:function(ea,fa){this._taggingFlyoutData={};this._taggingFlyoutData.root=ea.getRoot();this._taggingFlyoutData.gridID=ea.getGridID();this._taggingFlyoutData.uploadArea=ea.getUploadArea();this._taggingFlyoutData.submitButton=ea.getSubmitButton();this._taggingFlyoutData.tagger=ea.getTagger();this._taggingFlyoutData.scrollableArea=ea.getScrollableArea();this._taggingFlyoutData.config=fa;this._taggingFlyoutData.xyTagInputs={};this._taggingFlyoutData.subscriptions=new y();this._initTaggingFlyout();},setFaceRecSubmitButtonLock:function(ea){this._taggingFlyoutData.faceRecSubmitButtonLock=ea;},initTaggingFlyoutWithComponents:function(){this._taggingFlyoutData.subscriptions.addSubscriptions(h.subscribe('multi-upload/image-removed/'+this._taggingFlyoutData.gridID,this._doHandleImageRemoved.bind(this)),h.subscribe('multi-upload/images-added/'+this._taggingFlyoutData.gridID,this._doHandleImageAdded.bind(this)),this._taggingFlyoutData.recognitionController.subscribe('recognition',this._doHandleRecognitionResult.bind(this)),this._taggingFlyoutData.recognitionController.subscribe('photo',this._doHandlePhotoRecognitionDone.bind(this)),this._taggingFlyoutData.recognitionController.subscribe('done',function(ga,ha){this._taggingFlyoutData.faceRecSubmitButtonLock.unlock();this._setSubmitButtonTooltip('');ha.unresolved.forEach(function(ia){this._taggingFlyoutData.flyoutLoader.whenLoaded(ia,function(ja){ja.reset();});this._taggingFlyoutData.facerecLogger.bump('facerec_queries_fail');this._taggingFlyoutData.tagSuggestionsWaterfall.logFailure(ia,ha.user);this._doHandlePhotoRecognitionDone(ga,{photo:ia,faceboxes:[],recognitions:0});},this);this._taggingFlyoutData.facerecLogger.bump('facerec_queries_done');this._taggingFlyoutData.tagSuggestionsWaterfall.logStopPoll(Date.now()-this._taggingFlyoutData.pollLastStartedTimestamp,ha.unresolved.length);}.bind(this)));var ea=this.getComponentInstance('withtagger');if(ea)this._taggingFlyoutData.subscriptions.addSubscriptions(ea.subscribe('removeToken',this._doHandleTokenRemoved.bind(this)));i.getInstance().clear();var fa=this.getWaterfallID();this._taggingFlyoutData.tagSuggestionsWaterfall=new j(fa);this._taggingFlyoutData.tagSuggestionsWaterfall.logBegin();this._taggingFlyoutData.flowBeginTimestamp=Date.now();this._taggingFlyoutData.recognitionController.setWaterfallID(fa);},cleanupTaggingFlyout:function(){this._taggingFlyoutData.flyoutLoader.cleanup();if(this._taggingFlyoutData.config.taggingFlyoutNUXDialog)n.onCleanup(this._taggingFlyoutData.config.taggingFlyoutNUXDialog);this.releaseSubscriptions();this.engageSubscriptions();},resetTaggingFlyout:function(){i.getInstance().clear();this._taggingFlyoutData.recognitionController.stop();for(var ea in this._taggingFlyoutData.xyTagInputs)o.remove(this._taggingFlyoutData.xyTagInputs[ea]);this._taggingFlyoutData.xyTagInputs={};},getWaterfallID:function(){throw "Classes using AttachmentWithPhotosTaggingFlyoutMixin "+"should implement getWaterfallID";},releaseSubscriptions:function(){this._taggingFlyoutData.subscriptions.release();},engageSubscriptions:function(){this._taggingFlyoutData.subscriptions.engage();},addSubscriptions:function(){for(var ea=[],fa=0,ga=arguments.length;fa<ga;fa++)ea.push(arguments[fa]);var ha=this._taggingFlyoutData.subscriptions;ha.addSubscriptions.apply(ha,ea);},getSubscriptions:function(ea){return this._taggingFlyoutData.subscriptions;},logWithTaggingData:function(ea,fa){var ga=0,ha=this.getComponentInstance('withtagger');if(ha){var ia=i.getInstance(),ja=ha.getTokens();ga=ja.filter(function(ma){return !ia.userHasDirtyTags(ma.info.uid);}).length;var ka=ia.getAllTags(),la=ka.filter(function(ma){return ma.source=='composerx_suggestions';});this._taggingFlyoutData.tagSuggestionsWaterfall.logSubmit(ea,ja.length,ga,la.length,ka.length-la.length,Date.now()-this._taggingFlyoutData.flowBeginTimestamp);}return ga;},_initTaggingFlyout:function(){this._taggingFlyoutData.flyoutLoader=new k(this._taggingFlyoutData.config.targetID);this._taggingFlyoutData.flyoutLoader.subscribe('loaded',function(ea,fa){this._setupTaggingFlyout(fa);}.bind(this));this._taggingFlyoutData.facerecLogger={bump:function(ea,fa){l.bumpEntityKey('composer_facerec_suggestions',ea,fa);}};this._taggingFlyoutData.recognitionController=new m({targetID:this._taggingFlyoutData.config.targetID,targetIsPage:this._taggingFlyoutData.config.targetIsPage});},_setupTaggingFlyout:function(ea){da.push(ea);if(!this._getPhotoGridItem(ea.getPhotoID()))return;this._taggingFlyoutData.subscriptions.addSubscriptions(ea.subscribe('show',this._onTaggingFlyoutShow.bind(this,ea)),ea.subscribe('beforehide',this._onTaggingFlyoutHide.bind(this,ea)),ea.subscribe('confirm',this._onTaggingFlyoutConfirmed.bind(this,ea)),ea.subscribe('select',this._onTaggingFlyoutSelect.bind(this,ea)),ea.subscribe('unselect',this._onTaggingFlyoutUnselect.bind(this,ea)));},_onTaggingFlyoutShow:function(ea,fa,ga){da.forEach(function(ha){if(ha!=ea)ha.hide();});if(this._taggingFlyoutData.config.taggingFlyoutNUXDialog)n.acknowledgeDialog(n.TAGGING_FLYOUT_NUX,this._taggingFlyoutData.config.taggingFlyoutNUXDialog);ea.setNextButtonVisibility(!this._findNextTaggableGridItem(this._getPhotoGridItem(ea.getPhotoID())));},_onTaggingFlyoutHide:function(ea,fa,ga){p.removeClass(ea.getContext(),"_58pl");p.conditionClass(this._taggingFlyoutData.uploadArea,"_58pk",s.scry(this._taggingFlyoutData.uploadArea,"._58pl").length);},_onTaggingFlyoutConfirmed:function(ea,fa,ga){var ha=this._findNextTaggableGridItem(this._getPhotoGridItem(ea.getPhotoID()));if(!ha)return;if(this._taggingFlyoutData.scrollableArea)this._taggingFlyoutData.scrollableArea.scrollIntoView(ha);p.addClass(this._taggingFlyoutData.uploadArea,"_58pk");p.addClass(ha,"_58pl");this._getTaggingFlyout(ha.getAttribute('data-fbid'),function(ia){ia.show(ha);});},_onTaggingFlyoutSelect:function(ea,fa,ga){p.addClass(this._getPhotoGridItem(ea.getPhotoID()),"_57vj");var ha=i.getInstance().userHasDirtyTags(ga.user);if(!ha)this._taggingFlyoutData.facerecLogger.bump('suggestion_tags_added');i.getInstance().storeTagWithOptions(ga.photo,ga.user,ga.facebox.x,ga.facebox.y,{fbid:ga.photo,name:ga.name,subject:ga.user,from_facebox:true,facebox:ga.facebox.fbid,source:'composerx_flyout'});this._taggingFlyoutData.tagSuggestionsWaterfall.logAddManualTag(ga.photo,ga.facebox.fbid,ga.user);var ia=this.getComponentInstance('withtagger');if(ia)if(!ha){var ja=ia.replaceToken(ia.createDecorativeToken({uid:ga.user,text:ga.name},'faceSuggestion'));this._taggingFlyoutData.tagSuggestionsWaterfall.logAddToken(ga.user,ja);}this._updateXYTagInputs();},_onTaggingFlyoutUnselect:function(ea,fa,ga){this._fireDismissRequest([{facebox:ga.facebox,log_data:{tagee:ga.user,is_first:true}}]);var ha=i.getInstance().removeTag(ga.photo,ga.user);if(t(ha))return;var ia=this._taggingFlyoutData.tagSuggestionsWaterfall;ha.forEach(function(la){if(la.source=='composerx_suggestions'){ia.logRemoveSuggestion(la.fbid,la.facebox,la.subject,la.certainty);}else ia.logRemoveManualTag(la.fbid,la.facebox,la.subject);});p.conditionClass(this._getPhotoGridItem(ea.getPhotoID()),"_57vj",!t(i.getInstance().getPhotoTags(ga.photo)));var ja=i.getInstance().userHasDirtyTags(ga.user),ka=this.getComponentInstance('withtagger');if(ka&&!ja){ka.removeToken(ka.findToken({uid:ga.user}));this._taggingFlyoutData.tagSuggestionsWaterfall.logRemoveToken(ga.user,0);}this._updateXYTagInputs();},_doHandleImageRemoved:function(ea,fa){this._taggingFlyoutData.flyoutLoader.remove(fa);var ga=0,ha=[],ia=this.getComponentInstance('withtagger');if(ia){ha=Object.keys(i.getInstance().getPhotoTags(fa));i.getInstance().removeAllTagsFromPhoto(fa);ha.forEach(function(ja){if(!i.getInstance().userHasDirtyTags(ja)){ga++;ia.removeToken(ia.findToken({uid:ja}));}});}this._taggingFlyoutData.tagSuggestionsWaterfall.logRemovePhoto(fa,ga,ha.length);this._updateXYTagInputs();da.forEach(function(ja){return ja.hide();});},_doHandleImageAdded:function(ea,fa){if(fa.disableRecognition)return;Object.keys(fa.fbids).forEach(function(ga){var ha=fa.fbids[ga],ia=this._getPhotoGridItem(ha);if(ia)p.addClass(ia,"_57vh");},this);this._taggingFlyoutData.tagSuggestionsWaterfall.logAddPhotos(ca(fa.fbids));this._taggingFlyoutData.facerecLogger.bump('photos_queried');if(this.getComponent('withtagger')&&!this._taggingFlyoutData.config.hideWithTagger)this._taggingFlyoutData.tagger.eventuallySwitchToTagger('with');if(!this._taggingFlyoutData.config.applyTagSuggestionsDelay)this._taggingFlyoutData.faceRecSubmitButtonLock.lock();this._taggingFlyoutData.recognitionController.start(ca(fa.fbids));this._setSubmitButtonTooltip(u._("Procesando"));this._taggingFlyoutData.pollLastStartedTimestamp=Date.now();this._taggingFlyoutData.tagSuggestionsWaterfall.logStartPoll(Object.keys(fa.fbids).length);},_doHandleRecognitionResult:function(ea,fa){var ga=fa.facebox,ha=fa.recognition,ia=i.getInstance().userHasDirtyTags(ha.user.fbid);this._taggingFlyoutData.facerecLogger.bump('xy_tags_added');this._taggingFlyoutData.tagSuggestionsWaterfall.logAddSuggestion(fa.photo,ga.fbid,ha.user.fbid,ha.certainty);if(!ia)this._taggingFlyoutData.facerecLogger.bump('suggestion_tags_added');i.getInstance().storeTagWithOptions(fa.photo,ha.user.fbid,ga.x,ga.y,{fbid:fa.photo,name:ha.user.name,subject:ha.user.fbid,from_facebox:true,facebox:ga.fbid,certainty:ha.certainty,source:'composerx_suggestions',timestamp:Date.now()});var ja=this.getComponentInstance('withtagger');if(ja){if(!ia){var ka=ja.replaceToken(ja.createDecorativeToken({uid:ha.user.fbid,text:ha.user.name},this._taggingFlyoutData.config.additionalTokensGlyph));this._taggingFlyoutData.tagSuggestionsWaterfall.logAddToken(ha.user.fbid,ka);}this._taggingFlyoutData.tagger.eventuallySwitchToTagger('with');}setTimeout(this._updateXYTagInputs.bind(this),this._taggingFlyoutData.config.applyTagSuggestionsDelay?500:0);},_doHandlePhotoRecognitionDone:function(ea,fa){var ga=fa.photo,ha=this._getPhotoGridItem(ga);if(!ha)return;p.removeClass(ha,"_57vh");if(!this._taggingFlyoutData.config.useTaggingFlyout)return;p.addClass(ha,"_57vi");p.conditionClass(ha,"_57vj",fa.recognitions);p.conditionClass(ha,"_57vk",fa.faceboxes.length);if(fa.recognitions&&this._taggingFlyoutData.config.taggingFlyoutNUXDialog&&!this._taggingFlyoutData.taggingFlyoutNUXShown){this._scrollIntoView(ha);n.onInit(this._taggingFlyoutData.config.taggingFlyoutNUXDialog,ha,n.TAGGING_FLYOUT_NUX);this._taggingFlyoutData.taggingFlyoutNUXShown=true;}this._taggingFlyoutData.subscriptions.addSubscriptions(g.listen(ha,'click',function(ia){if(p.hasClass(ia.target,'fbVaultGridPhotoItemRemoveButton')||p.hasClass(ia.target,'fbVaultGridPhotoItemEditButton')||p.hasClass(ia.target,"_24iq"))return;p.addClass(this._taggingFlyoutData.uploadArea,"_58pk");p.addClass(ha,"_58pl");this._getTaggingFlyout(ga,function(ja){ja.toggle(ha);});}.bind(this)));},_setSubmitButtonTooltip:function(ea){var fa=s.find(this._taggingFlyoutData.root,"._yo");if(ea){v.set(fa,ea,'above','center');}else{v.remove(fa);fa.setAttribute('aria-label',u._("Publicar"));}},_doHandleTokenRemoved:function(ea,fa){var ga=i.getInstance(),ha=fa.info.uid,ia=this._taggingFlyoutData;if(ga.userHasDirtyTags(ha)){var ja=ga.userDirtyTagsCount(ha);ia.tagSuggestionsWaterfall.logRemoveToken(ha,ja);ia.facerecLogger.bump('suggestion_tokens_removed');ia.facerecLogger.bump('xy_tags_removed',ja);}var ka=[];ga.removeAllNewTagsOfUser(ha).forEach(function(la){ka.push({facebox:la.facebox,log_data:{tagee:la.subject,is_first:true}});if(ia.config.useTaggingFlyout){if(!ga.photoHasTags(la.fbid))p.removeClass(this._getPhotoGridItem(la.fbid),"_57vj");ia.flyoutLoader.whenLoaded(la.fbid,function(ma){ma.getFaceboxInstance(la.facebox).reset();});}if(la.source=='composerx_suggestions'){ia.tagSuggestionsWaterfall.logRemoveSuggestion(la.fbid,la.facebox,la.subject,la.certainty);}else ia.tagSuggestionsWaterfall.logRemoveManualTag(la.fbid,la.facebox,la.subject);}.bind(this));this._fireDismissRequest(ka);this._updateXYTagInputs();},_updateXYTagInputs:function(){var ea=w.byTag(this._taggingFlyoutData.submitButton,'form');for(var fa in this._taggingFlyoutData.xyTagInputs)o.remove(this._taggingFlyoutData.xyTagInputs[fa]);var ga=i.getInstance().getAllTags();if(this._taggingFlyoutData.config.applyTagSuggestionsDelay)ga=ga.filter(function(ha){return !ha.timestamp||(ha.timestamp+500<=Date.now());});x.createHiddenInputs({xy_tags:ga},ea,this._taggingFlyoutData.xyTagInputs);},_getPhotoGridItem:function(ea){return s.scry(this._taggingFlyoutData.uploadArea,'.fbVaultGridItem[data-fbid="'+ea+'"]')[0];},_findNextTaggableGridItem:function(ea){var fa=s.scry(this._taggingFlyoutData.uploadArea,'.fbVaultGridItem'),ga=fa.indexOf(ea);while(++ga<fa.length)if(p.hasClass(fa[ga],"_57vk"))break;return fa[ga];},_getTaggingFlyout:function(ea,fa){this._taggingFlyoutData.flyoutLoader.get(ea,fa);},_fireDismissRequest:function(ea){if(ea.length>0)new ba().setURI('/ajax/dismiss_tag_suggest.php').setMethod('POST').setData({facebox_logs:ea,closing_source:'composerx_suggestions',closing_action:'no'}).setAllowCrossPageTransition(true).send();},_scrollIntoView:function(ea){if(this._taggingFlyoutData.scrollableArea)this._taggingFlyoutData.scrollableArea.scrollIntoView(ea);}});},null);
__d("ComposerXPrivacyWidgetTags",["Arbiter","CurrentUser","PrivacySelectorBase","copyProperties","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();function l(m){"use strict";var n=m.getComponent('mainprivacywidget');if(!n){this._subscriptions=[];return null;}this._privacyWidget=n.element;this._privacyWidgetInstance=n.instance&&n.instance.getInstance().getInstance();this._mentionsInput=m.getComponent('maininput').instance;this._placeTypeahead=m.getComponent('placetagger')?m.getComponent('placetagger').instance:null;this._friendsTokenizer=m.getComponent('withtagger')?m.getComponent('withtagger').instance:null;this._init();}l.prototype._init=function(){"use strict";this._subscriptions=[this._mentionsInput.subscribe('update',this._informChangedTags.bind(this))];if(this._placeTypeahead){this._subscriptions.push(this._placeTypeahead.subscribe('select',this._onPlaceSelect.bind(this)));this._subscriptions.push(g.subscribe('Events/autoSuggestionSelected',this._onPlaceSelect.bind(this)));this._subscriptions.push(this._placeTypeahead.subscribe('unselect',this._onPlaceUnselect.bind(this)));}if(this._friendsTokenizer)this._subscriptions.push(this._friendsTokenizer.subscribe(['addToken','removeToken'],this._informChangedTags.bind(this)));this._informChangedTags();};l.prototype._getTaggedNamesForAudience=function(){"use strict";var m={},n=this._mentionsInput.getMentions();for(var o in n)if(n[o].type=='user')m[o]=n[o].text;if(this._friendsTokenizer)this._friendsTokenizer.getTokens().map(function(p){m[p.getValue()]=p.getText();});delete m[h.getID()];return k(m);};l.prototype._onPlaceSelect=function(m,n){"use strict";this._placeType=n.selected.place_type;this._informChangedTags();};l.prototype._onPlaceUnselect=function(m,n){"use strict";this._placeType=null;this._informChangedTags();};l.prototype._informChangedTags=function(){"use strict";var m=[];if(this._friendsTokenizer)m=this._friendsTokenizer.getTokens();var n=null;if(this._placeType==='Event')n=this._placeTypeahead.getCore().getHiddenValue();var o={withTags:m,mention:this._mentionsInput.getMentions(),eventTag:n};g.inform('Composer/changedtags',o);if(this._privacyWidgetInstance&&this._privacyWidgetInstance instanceof i)this._privacyWidgetInstance.informTagsChanged(o);};l.prototype.destroy=function(){"use strict";while(this._subscriptions.length)this._subscriptions.pop().unsubscribe();};j(l.prototype,{_subscriptions:null,_placeType:null});e.exports=l;},null);
__d("ComposerXMediaUploadAttachment",["Arbiter","Button","ComposerXAttachment","ComposerXAttachmentUtils","ComposerXAttachmentButtonBarState","ComposerXAttachmentPrefillMixin","ComposerXPrivacyWidgetTags","ComposerXSessionIDInserter","Dialog","DOM","DOMQuery","Event","PagesBanzaiLogger","PagesComposerEntryLogger","Parent","SubscriptionsHandler","classWithMixins","copyProperties","csx","cx","ge","fbt","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca){b.__markCompiled&&b.__markCompiled();var da=w(i,ca(l));for(var ea in da)if(da.hasOwnProperty(ea))ga[ea]=da[ea];var fa=da===null?null:da.prototype;ga.prototype=Object.create(fa);ga.prototype.constructor=ga;ga.__superConstructor__=da;function ga(ha,ia,ja){"use strict";da.call(this);this._root=ha;this._tagger=ia;this._config=ja;this._hasSelected=false;this._subscriptions=new v();this._uploadArea=p.find(this._root,"div._yn");this._submitButton=p.find(this._root,"._yo");}ga.prototype.getRoot=function(){"use strict";return this._root;};ga.prototype.getUploadArea=function(){"use strict";return this._uploadArea;};ga.prototype.getSubmitButton=function(){"use strict";return this._submitButton;};ga.prototype.getTagger=function(){"use strict";return this._tagger;};ga.prototype.initWithComponents=function(){"use strict";this._initFileInput();var ha=this.getComponent('maininput');j.initMentions(ha,this._config.mentionsPlaceholder,this.getComposerID(),{dontFocusMentions:this._config.dontFocusMentions});var ia=q.find(ha.element,'textarea.input');if(!ia.value&&this._config.targetIsPage){this._pagesComposerEntryLogger=new t(this._config.targetID);this._pagesComposerEntryLogger.registerForContentEntryEvents(ia);}if(this._config.prefill)this._initPrefill(q.find(this.getComponent('maininput').element,'textarea.input'),this._config.prefill);this._root.action=this._config.photoEndpoint;this._tagger.init(this);this._privacyWidgetTags=new m(this);k.trackCityChanges(this);g.inform('ComposerXMediaUpload/start');var ja=this._config.fileForm;this._subscriptions.addSubscriptions(ja.subscribe('submit',function(){n.insertSessionInput(ja.getRoot());}.bind(this)));if(this._config.postActionsButton!=null)this._config.postActionsButton.initHiddenInputs(this.getComponent('pabhiddeninputs').instance);g.inform('composer/render_pab_nux');};ga.prototype.cleanup=function(){"use strict";this._tagger.cleanup();this._privacyWidgetTags&&this._privacyWidgetTags.destroy();this._privacyWidgetTags=null;this._subscriptions.release();this._subscriptions.engage();if(this._pagesComposerEntryLogger)this._pagesComposerEntryLogger.unregister();};ga.prototype.reset=function(){"use strict";this._tagger.reset();this._resetFileInput();if(this._config.prefill)this._resetPrefill();};ga.prototype._resetFileInput=function(){"use strict";p.replace(this._fileInput,this._fileInputCopy);this._initFileInput();};ga.prototype.canSwitchAway=function(){"use strict";return !u.byClass(this._root,'async_saving');};ga.prototype._setSubmitButtonEnabled=function(ha){"use strict";h.setEnabled(this._submitButton,ha);};ga.prototype._isImageFile=function(){"use strict";return !!this._config.imageExtensions[this._getFileExtension()];};ga.prototype._getFileExtension=function(){"use strict";return this._fileInput.value.split('.').pop().toLowerCase();};ga.prototype._initFileInput=function(){"use strict";this._fileInput=p.find(this._root,"._n");this._fileInputCopy=this._fileInput.cloneNode(false);this._subscriptions.addSubscriptions(r.listen(this._fileInput,'change',this._onFileChange.bind(this)));};ga.prototype._onFileChange=function(){"use strict";if(this._isImagesOnly()&&!this._isImageFile()){new o().setTitle(ba._("Archivo de imagen no v\u00e1lido")).setBody(ba._("Sube un archivo de imagen v\u00e1lido.")).setModal(true).setButtons([o.OK]).show();this._resetFileInput();}else{p.setContent(aa('fbComposerUploadMediaFilename'),this._fileInput.value.split('\\').pop());this._setSubmitButtonEnabled(!!this._fileInput.value);}var ha=this._getPageSelectLoggingData();if(ha&&!this._hasSelected&&this._fileInput.value){this._hasSelected=true;s.logData(ha,null);}};ga.prototype._isImagesOnly=function(){"use strict";return !!this._config.imagesOnly;};ga.prototype._getPageSelectLoggingData=function(){"use strict";return this._config.pageSelectLoggingData;};x(ga.prototype,{_privacyWidgetTags:null,attachmentClassName:"_92"});e.exports=ga;},null);
__d("Lockable",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(i,j){"use strict";this._onUnlock=i;this._onLock=j;this._isLocked=false;this._locks=[];}g.prototype.getLock=function(){"use strict";var i=new h(this._onLockChanged.bind(this));this._locks.push(i);return i;};g.prototype._onLockChanged=function(){"use strict";var i=this._locks.some(function(j){return j.isLocked();});if(i!==this._isLocked){this._isLocked=i;if(i){this._onLock();}else this._onUnlock();}};function h(i){"use strict";this._isLocked=false;this._onChange=i;}h.prototype.lock=function(){"use strict";if(!this._isLocked){this._isLocked=true;this._onChange();}return this;};h.prototype.unlock=function(){"use strict";if(this._isLocked){this._isLocked=false;this._onChange();}return this;};h.prototype.isLocked=function(){"use strict";return this._isLocked;};e.exports=g;},null);
__d("VaultComposerController",["Arbiter","CSS","SubscriptionsHandler","areEqual","copyProperties","emptyFunction","removeFromArray","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();function o(p,q){this._uploadedImageCount=0;this._uploadingImageCount=0;this._subscriptionsHandler=new i();this._hasVideo=false;this._singleSelect=false;this._multiselectElems=q;this._initialPhotoFbids=[];this._photoFbids=[];this.setAllMediaRemovedHandler(l);this._subscriptionsHandler.addSubscriptions(g.subscribe('multi-upload/images-added/'+p,function(r,s){var t=Object.keys(s.fbids),u=t.length;this._uploadingImageCount=Math.max(0,this._uploadingImageCount-u);this._uploadedImageCount+=u;if(this._uploadingImageCount>0)return;t.forEach(function(v){var w=s.fbids[v];this._photoFbids.push(w);if(s.initialPhoto)this._initialPhotoFbids.push(w);}.bind(this));this._onImagesChanged();}.bind(this)),g.subscribe('multi-upload/image-removed/'+p,function(r,s){this._uploadedImageCount=Math.max(0,this._uploadedImageCount-1);m(this._photoFbids,s);this._onImagesChanged();}.bind(this)),g.subscribe('multi-upload/images-upload-completed/'+p,function(r,s){this._uploadingImageCount=0;this._onImagesChanged();}.bind(this)),g.subscribe('multi-upload/video-added/'+p,function(){q.forEach(h.hide);this._enableComposerHandler(true);this._placeholderHandler(n._("Haz un comentario sobre este video..."),n._("\u00bfD\u00f3nde se grab\u00f3 este video?"));this._hasVideo=true;}.bind(this)),g.subscribe('multi-upload/video-removed/'+p,function(){q.forEach(h.show);this._enableComposerHandler(false);this._placeholderHandler(n._("Haz un comentario..."),n._("\u00bfD\u00f3nde se tom\u00f3 esta foto?"));this._hasVideo=false;this._allMediaRemovedHandler();}.bind(this)),g.subscribe('multi-upload/images-upload-start/'+p,function(r,s){this._uploadingImageCount+=s.imageCount;this._enableComposerHandler(false);var t=this.getTotalImageCount();this._placeholderHandler(o.getPlaceholderText(t),o.getPlacePickerPlaceholderText(t));this._checkForSingleSelect();}.bind(this)),g.subscribe('multi-upload/all-images-removed/'+p,function(){q.forEach(h.show);this._uploadedImageCount=0;this._uploadingImageCount=0;this._enableComposerHandler(false);this._placeholderHandler(n._("Haz un comentario..."),n._("\u00bfD\u00f3nde se tom\u00f3 esta foto?"));this._photoFbids.length=0;this._allMediaRemovedHandler();}.bind(this)));}k(o,{getPlaceholderText:function(p){if(p===0){return n._("Haz un comentario...");}else if(p==1){return n._("Haz un comentario sobre esta foto...");}else return n._("Haz un comentario sobre estas fotos...");},getPlacePickerPlaceholderText:function(p){if(p===0){return n._("\u00bfD\u00f3nde se tom\u00f3 esta foto?");}else if(p==1){return n._("\u00bfD\u00f3nde se tom\u00f3 esta foto?");}else return n._("\u00bfD\u00f3nde se tomaron estas fotos?");}});k(o.prototype,{setEnableComposerHandler:function(p){this._enableComposerHandler=p;return this;},setPlaceholderHandler:function(p){this._placeholderHandler=p;return this;},setAllMediaRemovedHandler:function(p){this._allMediaRemovedHandler=p;return this;},setSingleSelect:function(p){this._singleSelect=p;return this;},cleanup:function(){this._uploadedImageCount=0;this._uploadingImageCount=0;this._initialPhotoFbids.length=0;this._photoFbids.length=0;this._subscriptionsHandler.release();},_checkForSingleSelect:function(){if(this._singleSelect)this._multiselectElems.forEach(function(p){h.conditionShow(p,this.getTotalImageCount()===0);}.bind(this));},getTotalImageCount:function(){return this._uploadingImageCount+this._uploadedImageCount;},_onImagesChanged:function(){this._enableComposerHandler(this._uploadedImageCount>0&&this._uploadingImageCount===0);this._placeholderHandler(o.getPlaceholderText(this._uploadedImageCount),o.getPlacePickerPlaceholderText(this._uploadedImageCount));this._checkForSingleSelect();if(this._uploadedImageCount===0&&this._uploadingImageCount===0)this._allMediaRemovedHandler();},hasChanges:function(){var p=!j(this._photoFbids,this._initialPhotoFbids);return p||this._hasVideo;}});e.exports=o;},null);
__d("PhotoEditorCanvas",["BlobFactory","DOM","PhotoResizeModeConst","Vector","sprintf"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();function l(n){"use strict";this._editor=n;this._canvas=h.create('canvas');this._ctx=this._canvas.getContext('2d');this._drawHandler=null;}l.prototype.setImageContent=function(n){"use strict";this._canvas.width=n.width;this._canvas.height=n.height;this._ctx.drawImage(n,0,0);return this;};l.prototype.drawGraphic=function(){"use strict";this._ctx.drawImage.apply(this._ctx,arguments);return this;};l.prototype.isBlobSupported=function(){"use strict";return !!this._canvas.toBlob;};l.prototype.getElement=function(){"use strict";return this._canvas;};l.prototype.getDimensions=function(){"use strict";return new j(this._canvas.width,this._canvas.height,'document');};l.prototype.getWidth=function(){"use strict";return this._canvas.width;};l.prototype.getHeight=function(){"use strict";return this._canvas.height;};l.prototype.getContext=function(){"use strict";return this._ctx;};l.prototype.setWidth=function(n){"use strict";this._canvas.width=n;return this;};l.prototype.setHeight=function(n){"use strict";this._canvas.height=n;return this;};l.prototype.toBlob=function(n){"use strict";if(this.isBlobSupported()){this._canvas.toBlob(n);return;}this.getBlobFromDataURL(n);};l.prototype.getBlobFromDataURL=function(n){"use strict";var o=this.toDataURL('image/png'),p=o.match(/^data:(.*?);base64,/),q=p[1],r=o.substr(p[0].length),s=a.atob(r),t=new ArrayBuffer(s.length),u=new Uint8Array(t);for(var v=0;v<s.length;v++)u[v]=s.charCodeAt(v);var w=g.getBlob([t],{type:q});n(w);};l.prototype.toBlobURL=function(n){"use strict";this.toBlob(function(o){n(a.URL.createObjectURL(o));});};l.prototype.toURL=function(n){"use strict";if(this.isBlobSupported()){this.toBlobURL(n);return;}n(this.toDataURL());};l.prototype.toDataURL=function(n){"use strict";return this._canvas.toDataURL(n);};l.prototype.resizedCopy=function(n,o){"use strict";var p=n.x/this.getWidth(),q=n.y/this.getHeight();if(o==i.CONTAIN){if(p>q){return this.scaledCopy(q);}else return this.scaledCopy(p);}else if(o==i.COVER){if(p<q){return this.scaledCopy(q);}else return this.scaledCopy(p);}else throw new Error('mode must be one of PhotoResizeModeConst');};l.prototype.scaledCopy=function(n){"use strict";var o=this._canvas.width*n,p=this._canvas.height*n;return new l().setWidth(o).setHeight(p).drawGraphic(this._canvas,0,0,o,p);};l.prototype.copy=function(){"use strict";return this.scaledCopy(1);};l.prototype.getPixelColor=function(n,o){"use strict";var p=this.getImageData(n,o,1,1).getPixel(0,0);return k('rgba(%s,%s,%s,%s)',p.r,p.g,p.b,p.a);};l.prototype.getImageData=function(n,o,p,q){"use strict";return new m(this._ctx.getImageData(n||0,o||0,p||this.getWidth(),q||this.getHeight()));};l.prototype.putImageData=function(n,o,p){"use strict";this._ctx.putImageData(n.getData(),o||0,p||0);return this;};l.prototype.toDataURI=function(){"use strict";return this._canvas.toDataURL('image/png');};l.prototype.toBase64=function(){"use strict";var n='data:image/png;base64,',o=this.toDataURI();return o.slice(n.length);};l.prototype.applyFilter=function(n,o){"use strict";this.putImageData(new n(this).run(o));};l.prototype.enableDrawing=function(n,o){"use strict";if(!this._editor)return;this.disableDrawing();this._drawHandler=new n(this._editor,o).start();return this._drawHandler;};l.prototype.setDrawingFillStyle=function(n){"use strict";if(!this._drawHandler)return;this._drawHandler.setFillStyle(n);};l.prototype.setFillStyle=function(n){"use strict";this._ctx.fillStyle=n;};l.prototype.disableDrawing=function(){"use strict";if(!this._drawHandler)return;this._drawHandler.stop();this._drawHandler=null;};l.prototype.clear=function(){"use strict";this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height);return this;};l.prototype.crop=function(n,o,p,q){"use strict";var r=new l().setWidth(p).setHeight(q);r.drawGraphic(this._canvas,Math.max(0,n),Math.max(0,o),p,q,0,0,p,q);this.setImageContent(r.getElement());return this;};l.prototype.fillText=function(n,o,p,q,r,s){"use strict";this._ctx.font=o;if(s){this._canvas.width=this._ctx.measureText(n).width;this._ctx.font=o;}this._ctx.textBaseline='top';this._ctx.fillStyle=p;this._ctx.fillText(n,q,r);return this;};l.prototype.fillCircle=function(n,o,p,q){"use strict";this._ctx.fillStyle=q||'black';this._ctx.beginPath();this._ctx.arc(n,o,p,0,Math.PI*2);this._ctx.closePath();this._ctx.fill();};l.prototype.fillRect=function(n,o,p,q,r){"use strict";this._ctx.fillStyle=r||'black';this._ctx.fillRect(n||0,o||0,p||this._canvas.width,q||this._canvas.height);return this;};function m(n){"use strict";this.image_data=n;this.width=n.width;this.height=n.height;this.array=n.data;}m.prototype.getData=function(){"use strict";return this.image_data;};m.prototype.getWidth=function(){"use strict";return this.width;};m.prototype.getHeight=function(){"use strict";return this.height;};m.prototype.getPixel=function(n,o){"use strict";var p=this.getIndex(n,o);return {r:this.array[p],g:this.array[p+1],b:this.array[p+2],a:this.array[p+3]};};m.prototype.setPixel=function(n,o,p){"use strict";var q=this.getIndex(n,o);this.array[q]=p.r;this.array[q+1]=p.g;this.array[q+2]=p.b;this.array[q+3]=p.a;};m.prototype.getIndex=function(n,o){"use strict";return 4*(n+o*this.width);};m.prototype.forEach=function(n){"use strict";for(var o=0;o<this.getWidth();o++)for(var p=0;p<this.getHeight();p++)this.setPixel(n(this.getPixel(o,p),o,p));};e.exports=l;},null);
__d("PhotoEditorPopover",["ArbiterMixin","ContextualDialog","Event","JSXDOM","LayerHideOnBlur","cx","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n=m(g);for(var o in n)if(n.hasOwnProperty(o))q[o]=n[o];var p=n===null?null:n.prototype;q.prototype=Object.create(p);q.prototype.constructor=q;q.__superConstructor__=n;function q(r){"use strict";this.$PhotoEditorPopover0=r;this.flyoutRoot=j.div(null);i.listen(this.$PhotoEditorPopover0,'click',this.$PhotoEditorPopover1.bind(this));}q.prototype.renderFlyoutContent=function(){"use strict";};q.prototype.onShow=function(){"use strict";};q.prototype.$PhotoEditorPopover1=function(){"use strict";var r=this.$PhotoEditorPopover2();if(r.isShown()){r.hide();}else r.show();};q.prototype.hide=function(){"use strict";this.$PhotoEditorPopover2().hide();};q.prototype.$PhotoEditorPopover2=function(){"use strict";if(!this.$PhotoEditorPopover3){this.renderFlyoutContent();var r={position:'above',alignh:'center',addedBehaviors:[k],context:this.$PhotoEditorPopover0,classNames:["_5g8e"]};this.$PhotoEditorPopover3=new h(r,this.flyoutRoot);}return this.$PhotoEditorPopover3;};e.exports=q;},null);
__d("ColorSelectorPopover",["PhotoEditorCanvas","CSS","Event","JSXDOM","PhotoEditorPopover","Style","Vector","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o=new m(250,250);for(var p in k)if(k.hasOwnProperty(p))r[p]=k[p];var q=k===null?null:k.prototype;r.prototype=Object.create(q);r.prototype.constructor=r;r.__superConstructor__=k;function r(s,t){"use strict";q.constructor.call(this,s,t);this.$ColorSelectorPopover0=t;}r.prototype.renderFlyoutContent=function(){"use strict";this.$ColorSelectorPopover1=new g().setWidth(o.x).setHeight(o.y);var s=this.$ColorSelectorPopover1.getContext(),t=s.createLinearGradient(0,0,o.x,0);t.addColorStop(.03,'red');t.addColorStop(.21,'yellow');t.addColorStop(.35,'green');t.addColorStop(.52,'lightblue');t.addColorStop(.67,'blue');t.addColorStop(.84,'deeppink');t.addColorStop(.97,'white');this.$ColorSelectorPopover1.fillRect(0,0,o.x,o.y,t);var u=.5;t=s.createLinearGradient(0,0,0,o.y*u);t.addColorStop(.1,'rgba(255, 255, 255, 1)');t.addColorStop(1,'rgba(255, 255, 255, 0)');this.$ColorSelectorPopover1.fillRect(0,0,o.x,o.y,t);t=s.createLinearGradient(0,o.y*u,0,o.y);t.addColorStop(0,'rgba(0, 0, 0, 0)');t.addColorStop(.9,'rgba(0, 0, 0, 1)');this.$ColorSelectorPopover1.fillRect(0,o.y*u,o.x,o.y,t);var v=this.$ColorSelectorPopover1.getElement();h.addClass(v,"_5g6_");i.listen(v,'click',this.$ColorSelectorPopover2.bind(this));i.listen(v,'mouseout',this.$ColorSelectorPopover3.bind(this));i.listen(v,'mousemove',this.$ColorSelectorPopover4.bind(this));this.flyoutRoot.appendChild(v);this.$ColorSelectorPopover5=this.flyoutRoot.appendChild(j.div({className:"_5g70"}));l.set(this.$ColorSelectorPopover5,'background',this.$ColorSelectorPopover0);};r.prototype.$ColorSelectorPopover2=function(s){"use strict";this.setColor(this.$ColorSelectorPopover6(s));this.hide();this.inform('selection',this.$ColorSelectorPopover0);};r.prototype.$ColorSelectorPopover3=function(){"use strict";l.set(this.$ColorSelectorPopover5,'background',this.$ColorSelectorPopover0);};r.prototype.$ColorSelectorPopover4=function(s){"use strict";l.set(this.$ColorSelectorPopover5,'background',this.$ColorSelectorPopover6(s));};r.prototype.$ColorSelectorPopover6=function(s){"use strict";var t=m.getEventPosition(s,'document').sub(m.getElementPosition(this.$ColorSelectorPopover1.getElement()));return this.$ColorSelectorPopover1.getPixelColor(t.x,t.y);};r.prototype.setColor=function(s){"use strict";this.$ColorSelectorPopover0=s;if(this.$ColorSelectorPopover5)l.set(this.$ColorSelectorPopover5,'background',s);};e.exports=r;},null);
__d("PhotoEditorDrawingCursor",["PhotoEditorCanvas","CSS","Vector","cx"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();function k(l,m){"use strict";this.$PhotoEditorDrawingCursor0=l;this.$PhotoEditorDrawingCursor1=m;this.$PhotoEditorDrawingCursor2=new g();this.$PhotoEditorDrawingCursor3=new i(0,0);h.addClass(this.$PhotoEditorDrawingCursor2.getElement(),"_5ewz");}k.prototype.getElement=function(){"use strict";return this.$PhotoEditorDrawingCursor2.getElement();};k.prototype.update=function(){"use strict";var l=this.$PhotoEditorDrawingCursor0.getCurrentBrushSize();this.$PhotoEditorDrawingCursor2.clear();this.$PhotoEditorDrawingCursor2.setWidth(l).setHeight(l);this.$PhotoEditorDrawingCursor1.drawStroke(this.$PhotoEditorDrawingCursor2,l/2,l/2);this.$PhotoEditorDrawingCursor3=new i(l,l);return this;};k.prototype.getDimensions=function(){"use strict";return this.$PhotoEditorDrawingCursor3;};e.exports=k;},null);
__d("PhotoEditorInterpolation",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(h){"use strict";this.$Linear0=null;this.$Linear1=null;this.$Linear2=h;}g.prototype.setPoints=function(h,i){"use strict";this.$Linear0=h;this.$Linear1=i;this.$Linear3=(this.$Linear1.y-this.$Linear0.y)/(this.$Linear1.x-this.$Linear0.x);this.$Linear4=this.$Linear0.y-this.$Linear3*this.$Linear0.x;if((this.isHorizontal()&&this.$Linear0.x>this.$Linear1.x)||(!this.isHorizontal()&&this.$Linear0.y>this.$Linear1.y)){var j=this.$Linear0;this.$Linear0=this.$Linear1;this.$Linear1=j;}return this;};g.prototype.invert=function(h){"use strict";var i=h.x;h.x=h.y;h.y=i;};g.prototype.isHorizontal=function(){"use strict";return this.$Linear3<=1&&this.$Linear3>-1;};g.prototype.draw=function(){"use strict";if(this.isHorizontal()){this.$Linear5();}else this.$Linear6();};g.prototype.$Linear6=function(){"use strict";var h,i;if(!isFinite(this.$Linear3)){for(i=this.$Linear0.y;i<=this.$Linear1.y;i++)this.$Linear2.draw(this.$Linear0.x,i);}else for(i=this.$Linear0.y;i<=this.$Linear1.y;i++){h=Math.floor((i-this.$Linear4)/this.$Linear3);this.$Linear2.draw(h,i);}};g.prototype.$Linear5=function(){"use strict";var h,i;for(h=this.$Linear0.x;h<=this.$Linear1.x;h++){i=Math.floor(this.$Linear3*h+this.$Linear4);this.$Linear2.draw(h,i);}};e.exports={Linear:g};},null);
__d("PhotoEditorDrawingHandlers",["PhotoEditorDrawingCursor","Event","PhotoEditorInterpolation","SubscriptionsHandler","Vector"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();function l(q,r,s){"use strict";this._editor=q;this._canvas=q.getWorkingCanvas();this.setFillStyle(r);this.setBrushSize(s);this.image_data=this._canvas.getImageData();this.isMouseDown=false;this.subscriptionsHandler=new j();this._lastPosition=null;this._func=null;}l.prototype.onMouseDown=function(q){"use strict";this.isMouseDown=true;q.preventDefault();this._func=new i.Linear(this);};l.prototype.onMouseUp=function(){"use strict";this._lastPosition=null;this.isMouseDown=false;};l.prototype.onMouseMove=function(q){"use strict";if(!this.isMouseDown)return;var r=k.getEventPosition(q).sub(k.getElementPosition(this._editor.getCanvasWrapper())).div(this._editor.getResizeFactor());if(this._lastPosition)this._func.setPoints(this._lastPosition,r).draw();this._lastPosition=r;};l.prototype.onMouseLeave=function(){"use strict";this._lastPosition=null;};l.prototype.setBrushSize=function(q){"use strict";this._brushSize=q;this.getDrawingCursor().update();};l.prototype.setFillStyle=function(q){"use strict";if(q instanceof Image){this._fillStyle=this._canvas.getContext().createPattern(q,'no-repeat');}else if(Array.isArray(q)){this._fillStyle=this._canvas.getContext().createLinearGradient(0,0,this._canvas.getwidth(),this._canvas.getHeight());for(var r=0;r<q.length;r++)this._fillStyle.addColorStop(q[r].index,q[r].color);}else this._fillStyle=q;this.getDrawingCursor().update();};l.prototype.drawStroke=function(q,r,s){"use strict";};l.prototype.draw=function(q,r){"use strict";this.drawStroke(this._canvas,q,r);};l.prototype.getDrawingCursor=function(){"use strict";if(!this._cursor)this._cursor=new g(this._editor,this);return this._cursor;};l.prototype.getCursorElement=function(){"use strict";return this.getDrawingCursor().getElement();};l.prototype.start=function(){"use strict";var q=this.getDrawingCursor();q.update();this.subscriptionsHandler.engage();this.subscriptionsHandler.addSubscriptions(h.listen(this._canvas.getElement(),'mouseleave',this.onMouseLeave.bind(this)),h.listen(this._canvas.getElement(),'mousemove',this.onMouseMove.bind(this)),h.listen(this._canvas.getElement(),'mousedown',this.onMouseDown.bind(this)),h.listen(this._canvas.getElement(),'mouseup',this.onMouseUp.bind(this)),h.listen(q.getElement(),'mousemove',this.onMouseMove.bind(this)),h.listen(q.getElement(),'mousedown',this.onMouseDown.bind(this)),h.listen(q.getElement(),'mouseup',this.onMouseUp.bind(this)));return this;};l.prototype.getCurrentBrushRect=function(q,r){"use strict";var s=this._editor.getCurrentBrushSize();q-=Math.floor(s/2);r-=Math.floor(s/2);return {x:q,y:r,width:s,height:s};};l.prototype.stop=function(){"use strict";this.subscriptionsHandler.release();return this;};for(var m in l)if(l.hasOwnProperty(m))o[m]=l[m];var n=l===null?null:l.prototype;o.prototype=Object.create(n);o.prototype.constructor=o;o.__superConstructor__=l;function o(){"use strict";if(l!==null)l.apply(this,arguments);}o.prototype.drawStroke=function(q,r,s){"use strict";var t=this.getCurrentBrushRect(r,s);q.fillRect(t.x,t.y,t.width,t.height,this._fillStyle);};for(m in l)if(l.hasOwnProperty(m))p[m]=l[m];p.prototype=Object.create(n);p.prototype.constructor=p;p.__superConstructor__=l;function p(){"use strict";if(l!==null)l.apply(this,arguments);}p.prototype.drawStroke=function(q,r,s){"use strict";var t=this._editor.getCurrentBrushSize();q.fillCircle(r,s,t/2,this._fillStyle);};e.exports={SquareBrush:o,CircularBrush:p};},null);
__d("SizeSelectorPopover",["Event","JSXDOM","Keys","Parent","PhotoEditorPopover","clamp","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n="_5g8m",o="_5g8n";for(var p in k)if(k.hasOwnProperty(p))r[p]=k[p];var q=k===null?null:k.prototype;r.prototype=Object.create(q);r.prototype.constructor=r;r.__superConstructor__=k;function r(s,t,u,v){"use strict";q.constructor.call(this,s);this.$SizeSelectorPopover0=t;this.$SizeSelectorPopover1=u;this.$SizeSelectorPopover2=v;}r.prototype.renderFlyoutContent=function(){"use strict";this.$SizeSelectorPopover3=h.input({className:"_5g8o",value:this.$SizeSelectorPopover0});this.flyoutRoot.appendChild(h.div(null,h.a({className:o}),this.$SizeSelectorPopover3,h.a({className:n})));g.listen(this.$SizeSelectorPopover3,'keyup',this.$SizeSelectorPopover4.bind(this));g.listen(this.flyoutRoot,'click',this.$SizeSelectorPopover5.bind(this));g.listen(this.$SizeSelectorPopover3,'blur',this.$SizeSelectorPopover6.bind(this));};r.prototype.$SizeSelectorPopover6=function(){"use strict";this.$SizeSelectorPopover3.value=this.$SizeSelectorPopover7(this.$SizeSelectorPopover0);};r.prototype.$SizeSelectorPopover4=function(s){"use strict";if(s.keyCode==i.UP||s.keyCode==i.RIGHT){this.$SizeSelectorPopover8(1);return;}else if(s.keyCode==i.DOWN||s.keyCode==i.LEFT){this.$SizeSelectorPopover8(-1);return;}var t=parseInt(this.$SizeSelectorPopover3.value,10);if(a.isNaN(t))return;this.$SizeSelectorPopover9(this.$SizeSelectorPopover7(t));};r.prototype.$SizeSelectorPopover7=function(s){"use strict";return l(this.$SizeSelectorPopover1,s,this.$SizeSelectorPopover2);};r.prototype.$SizeSelectorPopover8=function(s){"use strict";var t=this.$SizeSelectorPopover7(this.$SizeSelectorPopover0+s);this.$SizeSelectorPopover9(t);this.$SizeSelectorPopover3.value=t;};r.prototype.$SizeSelectorPopover5=function(s){"use strict";var t=s.getTarget();if(j.byClass(t,n)){this.$SizeSelectorPopover8(1);}else if(j.byClass(t,o))this.$SizeSelectorPopover8(-1);};r.prototype.$SizeSelectorPopover9=function(s){"use strict";if(s!=this.$SizeSelectorPopover0){this.$SizeSelectorPopover0=s;this.inform('selection',this.$SizeSelectorPopover0);}};r.prototype.setSize=function(s){"use strict";this.$SizeSelectorPopover0=s;if(this.$SizeSelectorPopover3)this.$SizeSelectorPopover3.value=s;};e.exports=r;},null);
__d("PhotoEditorPaletteBase",["ArbiterMixin","CSS","DOM","Event","SubscriptionsHandler","cx","csx","mixin","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p="_5c-o",q=n(g);for(var r in q)if(q.hasOwnProperty(r))t[r]=q[r];var s=q===null?null:q.prototype;t.prototype=Object.create(s);t.prototype.constructor=t;t.__superConstructor__=q;function t(u,v){"use strict";this.palette=v;this.photoEditor=u;this.$PhotoEditorPaletteBase0=false;this.$PhotoEditorPaletteBase1=null;this.subscriptionsHandler=new k('PhotoEditorPalette');this.initDOM();}t.prototype.initDOM=function(){"use strict";this.closeButton=i.scry(this.palette,"._5c-p").pop();this.confirmButton=i.scry(this.palette,"._5c-q").pop();};t.prototype.getRoot=function(){"use strict";return this.palette;};t.prototype.enable=function(u){"use strict";if(this.$PhotoEditorPaletteBase0)return;this.subscriptionsHandler.engage();if(this.closeButton)this.subscriptionsHandler.addSubscriptions(j.listen(this.closeButton,'click',o(this.disable,this)));if(this.$PhotoEditorPaletteBase1)h.addClass(this.$PhotoEditorPaletteBase1,p);this.onEnable(u);this.$PhotoEditorPaletteBase0=true;h.show(this.palette);this.inform('enabled',u);};t.prototype.onEnable=function(u){"use strict";};t.prototype.disable=function(u){"use strict";if(!this.$PhotoEditorPaletteBase0)return;this.subscriptionsHandler.release();this.onDisable(u);this.$PhotoEditorPaletteBase0=false;h.hide(this.palette);this.inform('disabled',u);};t.prototype.onDisable=function(u){"use strict";};t.prototype.isEnabled=function(){"use strict";return this.$PhotoEditorPaletteBase0;};t.prototype.setButtonActive=function(u){"use strict";if(this.$PhotoEditorPaletteBase1)h.removeClass(this.$PhotoEditorPaletteBase1,p);h.addClass(u,p);this.$PhotoEditorPaletteBase1=u;};e.exports=t;},null);
__d("PhotoEditorDrawingPalette",["ColorSelectorPopover","DOM","PhotoEditorDrawingHandlers","Event","SizeSelectorPopover","JSXDOM","PhotoEditorPaletteBase","Style","csx","cx","PhotoEditorConfig"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();var q=b('PhotoEditorConfig').Constants;for(var r in m)if(m.hasOwnProperty(r))t[r]=m[r];var s=m===null?null:m.prototype;t.prototype=Object.create(s);t.prototype.constructor=t;t.__superConstructor__=m;function t(u,v){"use strict";s.constructor.call(this,u,v);this.$PhotoEditorDrawingPalette0=q.DEFAULT_FILL_STYLE;this.$PhotoEditorDrawingPalette1=i.CircularBrush;}t.prototype.initDOM=function(){"use strict";s.initDOM.call(this);this.$PhotoEditorDrawingPalette2();this.$PhotoEditorDrawingPalette3();};t.prototype.$PhotoEditorDrawingPalette2=function(){"use strict";this.$PhotoEditorDrawingPalette4=h.find(this.palette,"._5g74");this.$PhotoEditorDrawingPalette5=this.$PhotoEditorDrawingPalette4.appendChild(l.span({className:"_5g8h"},q.DEFAULT_BRUSH_SIZE));var u=new k(this.$PhotoEditorDrawingPalette4,q.DEFAULT_BRUSH_SIZE,q.MIN_BRUSH_SIZE,q.MAX_BRUSH_SIZE);u.subscribe('selection',this.$PhotoEditorDrawingPalette6.bind(this));};t.prototype.$PhotoEditorDrawingPalette3=function(){"use strict";this.$PhotoEditorDrawingPalette7=h.find(this.palette,"._5g76");this.$PhotoEditorDrawingPalette8=l.span({className:"_5g71"});n.set(this.$PhotoEditorDrawingPalette8,'background',q.DEFAULT_FILL_STYLE);this.$PhotoEditorDrawingPalette7.appendChild(this.$PhotoEditorDrawingPalette8);this.$PhotoEditorDrawingPalette9=new g(this.$PhotoEditorDrawingPalette7,q.DEFAULT_FILL_STYLE);this.$PhotoEditorDrawingPalette9.subscribe('selection',this.$PhotoEditorDrawingPalettea.bind(this));};t.prototype.onEnable=function(){"use strict";this.subscriptionsHandler.addSubscriptions(j.listen(this.confirmButton,'click',this.disable.bind(this)));this.photoEditor.enableDrawing(this.$PhotoEditorDrawingPalette1,this.photoEditor.getCurrentFillStyle(),this.photoEditor.getCurrentBrushSize());};t.prototype.$PhotoEditorDrawingPalettea=function(u,v){"use strict";this.$PhotoEditorDrawingPalettec(v);};t.prototype.$PhotoEditorDrawingPalettec=function(u){"use strict";this.$PhotoEditorDrawingPalette0=u;n.set(this.$PhotoEditorDrawingPalette8,'background',u);this.photoEditor.setCurrentFillStyle(u);this.inform('setcolor');};t.prototype.$PhotoEditorDrawingPalette6=function(u,v){"use strict";this.$PhotoEditorDrawingPaletted(v);};t.prototype.$PhotoEditorDrawingPaletted=function(u){"use strict";h.setContent(this.$PhotoEditorDrawingPalette5,u);this.photoEditor.setCurrentBrushSize(u);this.inform('setsize');};t.prototype.getCurrentDrawingHandler=function(){"use strict";return this.$PhotoEditorDrawingPalette1;};t.prototype.onDisable=function(){"use strict";this.photoEditor.disableDrawing();};e.exports=t;},null);
__d("PhotoEditorFilters",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(k){"use strict";this.$BaseFilter0=k;}g.prototype.filter=function(){"use strict";};g.prototype.run=function(k){"use strict";var l=this.$BaseFilter0.getImageData();this.filter.call(this,l,k);return l;};for(var h in g)if(g.hasOwnProperty(h))j[h]=g[h];var i=g===null?null:g.prototype;j.prototype=Object.create(i);j.prototype.constructor=j;j.__superConstructor__=g;function j(){"use strict";if(g!==null)g.apply(this,arguments);}j.prototype.filter=function(k){"use strict";for(var l=0;l<k.getWidth();l++)for(var m=0;m<k.getHeight();m++){var n=k.getPixel(l,m),o=Math.floor((n.r+n.g+n.b)/3);n.r=n.g=n.b=o;k.setPixel(l,m,n);}};e.exports={BaseFilter:g,BlackAndWhiteFilter:j};},null);
__d("PhotoEditorDOM",["DOM","Parent","sprintf"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j='data-photoeditoraction',k='['+j+'="%s"]',l={getElementForAction:function(m,n){return g.find(m,i(k,n));},getActionFromElement:function(m){m=h.byAttribute(m,j);if(m)return parseInt(m.getAttribute(j),10);}};e.exports=l;},null);
__d("PhotoEditorFilterPalette",["PhotoEditorCanvas","CSS","DOM","Event","PhotoEditorFilters","PhotoEditorDOM","PhotoEditorPaletteBase","PhotoResizeModeConst","PhotoEditorConfig"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o=b('PhotoEditorConfig').Actions,p=b('PhotoEditorConfig').Constants;for(var q in m)if(m.hasOwnProperty(q))s[q]=m[q];var r=m===null?null:m.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=m;function s(){"use strict";if(m!==null)m.apply(this,arguments);}s.prototype.initDOM=function(){"use strict";r.initDOM.call(this);this.$PhotoEditorFilterPalette0=l.getElementForAction(this.palette,o.REVERT);this.$PhotoEditorFilterPalette1=l.getElementForAction(this.palette,o.BW_FILTER);this.$PhotoEditorFilterPalette2=null;};s.prototype.onEnable=function(){"use strict";this.subscriptionsHandler.addSubscriptions(j.listen(this.confirmButton,'click',function(){this.disable(this.$PhotoEditorFilterPalette2);return false;}.bind(this)),j.listen(this.$PhotoEditorFilterPalette1,'click',this.$PhotoEditorFilterPalette3.bind(this)),j.listen(this.$PhotoEditorFilterPalette0,'click',this.$PhotoEditorFilterPalette4.bind(this)));if(!this.$PhotoEditorFilterPalette5){this.$PhotoEditorFilterPalette5=new g();h.addClass(this.$PhotoEditorFilterPalette5.getElement(),this.photoEditor.getCanvasClass());if(!this.$PhotoEditorFilterPalette2){this.$PhotoEditorFilterPalette4();}else this.$PhotoEditorFilterPalette6(this.$PhotoEditorFilterPalette2);}i.insertAfter(this.photoEditor.getWorkingCanvas().getElement(),this.$PhotoEditorFilterPalette5.getElement());this.$PhotoEditorFilterPalette7(this.$PhotoEditorFilterPalette1,k.BlackAndWhiteFilter);this.$PhotoEditorFilterPalette7(this.$PhotoEditorFilterPalette0);};s.prototype.clearCachedCanvas=function(){"use strict";this.$PhotoEditorFilterPalette5=null;};s.prototype.$PhotoEditorFilterPalette7=function(t,u){"use strict";var v=new g().setImageContent(this.photoEditor.getUnfilteredImage()).resizedCopy(p.FILTER_PREVIEW_DIMS,n.COVER);if(u)v.applyFilter(u);var w=i.create('img');v.toURL(function(x){w.src=x;i.setContent(t,w);});};s.prototype.$PhotoEditorFilterPalette3=function(){"use strict";this.setButtonActive(this.$PhotoEditorFilterPalette1);this.$PhotoEditorFilterPalette2={filter:k.BlackAndWhiteFilter,args:null};this.$PhotoEditorFilterPalette6(this.$PhotoEditorFilterPalette2);};s.prototype.$PhotoEditorFilterPalette4=function(){"use strict";this.$PhotoEditorFilterPalette2=null;this.setButtonActive(this.$PhotoEditorFilterPalette0);this.$PhotoEditorFilterPalette5.setImageContent(this.photoEditor.getUnfilteredImage());};s.prototype.$PhotoEditorFilterPalette6=function(t){"use strict";this.$PhotoEditorFilterPalette2=t;this.$PhotoEditorFilterPalette5.setImageContent(this.photoEditor.getUnfilteredImage());this.$PhotoEditorFilterPalette5.applyFilter(t.filter,t.args);};s.prototype.onDisable=function(t){"use strict";i.remove(this.$PhotoEditorFilterPalette5.getElement());i.empty(this.$PhotoEditorFilterPalette0);i.empty(this.$PhotoEditorFilterPalette1);if(!t){this.$PhotoEditorFilterPalette5=null;this.$PhotoEditorFilterPalette2=null;}};e.exports=s;},null);
__d("PhotoEditorGraphic",["ArbiterMixin","PhotoEditorCanvas","CSS","DOM","Draggable","Event","Rect","SimpleDrag","Style","SubscriptionsHandler","TextMetrics","UserAgent_DEPRECATED","Vector","clamp","cx","mixin","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){b.__markCompiled&&b.__markCompiled();var x=0,y=[],z=.6,aa=.25,ba=30,ca=50,da=4,ea=function(sa){return {'-webkit-transform':sa,'-moz-transform':sa,'-ms-transform':sa,transform:sa};},fa=v(g);for(var ga in fa)if(fa.hasOwnProperty(ga))ia[ga]=fa[ga];var ha=fa===null?null:fa.prototype;ia.prototype=Object.create(ha);ia.prototype.constructor=ia;ia.__superConstructor__=fa;function ia(sa,ta,ua){"use strict";this.id=x++;this.photoEditor=sa;y.push(this);this.root=j.create('div');this.maxWidth=ta;this.maxHeight=ua;i.addClass(this.root,"_55gm");var va=j.create('div');i.addClass(va,"_5g8y");i.addClass(va,"_bbn");var wa=j.create('div');i.addClass(wa,"_2fb7");i.addClass(wa,"_bbo");va.appendChild(wa);this.root.appendChild(va);this.$Graphic0=new s(0,0,'document');this.subscriptionsHandler=new p();this.subscriptionsHandler.addSubscriptions(l.listen(va,'click',this.remove.bind(this)),l.listen(va,'mousedown',function(event){i.addClass(va,"_2fb8");event.stopPropagation();}),l.listen(va,'mouseleave',function(event){i.removeClass(va,"_2fb8");}));}ia.prototype.serialize=function(){"use strict";var sa=this.getPos(),ta=this.getDimensions(),ua=this.photoEditor.getCanvasDimensions();return {left:sa.x/ua.x,top:sa.y/ua.y,width:ta.x/ua.x,height:ta.y/ua.y,rotation:this.getRotation()};};ia.prototype.initFromSerializedState=function(sa){"use strict";var ta=this.photoEditor.getCanvasDimensions();this.setDimensions(new s(sa.width*ta.x,sa.height*ta.y));this.setPos(new s(sa.left*ta.x,sa.top*ta.y));this.setRotation(sa.rotation);};ia.prototype.onActive=function(){"use strict";this.$Graphic1=this.$Graphic1||(new k(this.root)).setUseAbsolute(true).setUseScroller(false).setDropHandler(this.updatePos.bind(this));i.addClass(this.root,"_36w9");this.updateDraggableBoundingBox();};ia.prototype.onInactive=function(){"use strict";this.$Graphic1&&this.$Graphic1.destroy();this.$Graphic1=null;i.removeClass(this.root,"_36w9");};ia.prototype.updateDraggableBoundingBox=function(){"use strict";if(this.$Graphic1){var sa=this.getDimensions(),ta=this.photoEditor.getGraphicsLayer(),ua=s.getElementPosition(ta),va=s.getElementDimensions(ta),wa=new m(ua.y-sa.y,ua.x+va.x+sa.x,ua.y+va.y+sa.y,ua.x-sa.x);this.$Graphic1.setBoundingBox(wa);}};ia.prototype.onBeforeSuddenTransformation=function(){"use strict";};ia.prototype.onAfterSuddenTransformation=function(){"use strict";};ia.prototype.getElement=function(){"use strict";return this.root;};ia.prototype.getInitialDimensions=function(){"use strict";return new s(this.maxWidth,this.maxHeight,'document').mul(aa);};ia.prototype.getPos=function(){"use strict";return this.$Graphic0;};ia.prototype.getCenterPos=function(){"use strict";return this.getPos().add(this.getDimensions().div(2));};ia.prototype.getCenterCoordinates=function(){"use strict";return s.getElementPosition(this.root).add(this.getDimensions().div(2));};ia.prototype.setPos=function(sa){"use strict";this.$Graphic0=sa;o.apply(this.root,{left:this.$Graphic0.x+'px',top:this.$Graphic0.y+'px'});};ia.prototype.updatePos=function(){"use strict";this.setPos((new s(o.get(this.root,'left'),o.get(this.root,'top'))));};ia.prototype.setDimensions=function(sa){"use strict";o.apply(this.root,{width:sa.x+'px',height:sa.y+'px'});this.updateDraggableBoundingBox();};ia.prototype.remove=function(event){"use strict";this.subscriptionsHandler.release();j.remove(this.root);this.photoEditor.removeGraphic(this);};ia.prototype.getDrawableObj=function(){"use strict";};ia.prototype.getDimensions=function(){"use strict";return s.getElementDimensions(this.root);};ia.prototype.getDimensionsForDrawable=function(){"use strict";return this.getDimensions();};ia.prototype.getRotation=function(){"use strict";return 0;};ia.prototype.setRotation=function(sa){"use strict";};ia.prototype.onDragStart=function(sa){"use strict";if(r.firefox()){this.$Graphic2=sa.layerX;this.$Graphic3=sa.layerY;}else{this.$Graphic2=sa.offsetX;this.$Graphic3=sa.offsetY;}sa.dataTransfer.setData('graphic_id',this.id);};ia.prototype.onDrop=function(sa,ta){"use strict";if(this.id!==parseInt(sa.dataTransfer.getData('graphic_id'),10))return;if(!ta)ta=new s(0,0,'document');this.$Graphic0=new s(ta.x+sa.layerX-this.$Graphic2,ta.y+sa.layerY-this.$Graphic3,'document');this.setPos(this.$Graphic0);sa.kill();};ia.prototype.setCanvasAsBackground=function(sa){"use strict";o.set(this.root,'backgroundImage','url('+sa.toDataURL()+')');};for(var ja in ia)if(ia.hasOwnProperty(ja))la[ja]=ia[ja];var ka=ia===null?null:ia.prototype;la.prototype=Object.create(ka);la.prototype.constructor=la;la.__superConstructor__=ia;function la(sa,ta,ua,va){"use strict";ka.constructor.call(this,sa,ua,va);this.$ImageGraphic0=j.create('div');i.addClass(this.$ImageGraphic0,"_36wa");this.root.appendChild(this.$ImageGraphic0);this.$ImageGraphic1=ua/va;this.$ImageGraphic2=0;this.$ImageGraphic3=0;this.$ImageGraphic4=false;this.$ImageGraphic5=new Image();this.$ImageGraphic5.crossOrigin='anonymous';o.apply(this.$ImageGraphic5,{maxWidth:ua+'px',maxHeight:va+'px'});i.addClass(this.root,"_55jn");i.addClass(this.root,'loading');this.$ImageGraphic6=j.create('div');i.addClass(this.$ImageGraphic6,"_5a2y");var wa=j.create('div');i.addClass(wa,"_5g8y");i.addClass(wa,"_5a2z");this.$ImageGraphic7=j.create('div');i.addClass(this.$ImageGraphic7,"_2fb7");i.addClass(this.$ImageGraphic7,"_5a2-");wa.appendChild(this.$ImageGraphic7);this.$ImageGraphic6.appendChild(wa);this.root.appendChild(this.$ImageGraphic6);this.subscriptionsHandler.addSubscriptions(l.listen(this.$ImageGraphic5,'load',this.$ImageGraphic8.bind(this)),l.listen(this.root,'dragenter',l.prevent),l.listen(this.root,'dragover',l.prevent),l.listen(this.$ImageGraphic0,'mousedown',this.$ImageGraphic9.bind(this)),l.listen(wa,'mousedown',function(event){event.stopPropagation();}));var xa=new n(wa);xa.subscribe('start',function(ya,event){if(event.button!==0)return false;this.$ImageGraphic4=true;this.$ImageGraphicb=this.getCenterCoordinates();this.$ImageGraphicc();i.addClass(wa,"_2fb8");}.bind(this));xa.subscribe('update',w(this.$ImageGraphicd,ba,this));xa.subscribe('end',function(ya,event){this.$ImageGraphic2=this.$ImageGraphic3;this.$ImageGraphic4=false;i.removeClass(wa,"_2fb8");this.$ImageGraphice();this.$ImageGraphicf();o.apply(this.$ImageGraphic7,ea('translate(-50%, -50%)'));}.bind(this));this.$ImageGraphic5.src=ta;this.imageURL=ta;this.setDimensions(this.getInitialDimensions());}la.prototype.serialize=function(){"use strict";return Object.assign({},ka.serialize.call(this),{imageURL:this.imageURL});};la.prototype.getDrawableObj=function(){"use strict";return this.$ImageGraphic5;};la.prototype.onDragStart=function(sa){"use strict";ka.onDragStart.call(this,sa);sa.dataTransfer.setData('text/plain',this.$ImageGraphic5.src);};la.prototype.$ImageGraphicd=function(sa,event){"use strict";if(!this.$ImageGraphic4)return;var ta=s.getEventPosition(event),ua=this.$ImageGraphicb,va=ua.distanceTo(ta),wa=this.photoEditor.getCanvasDimensions(),xa=Math.max(wa.x,wa.y),ya=t(ca,va*2,xa),za=new s(ya,ya),ab=za.sub(this.getDimensions());if(ab.magnitude()>da){var bb=this.getPos().sub(ab.div(2));this.setDimensions(za);this.setPos(bb);}var cb=ta.sub(ua),db=new s(Math.cos(Math.PI*3/4),-1*Math.sin(Math.PI*3/4)),eb=db.x*cb.x+db.y*cb.y,fb=eb/(db.magnitude()*cb.magnitude());fb=t(-1,fb,1);var gb=Math.acos(fb)*(180/Math.PI),hb=db.x*cb.y-cb.x*db.y;if(hb<0)gb*=-1;this.$ImageGraphicg(gb);};la.prototype.$ImageGraphicg=function(sa){"use strict";this.$ImageGraphic3=this.$ImageGraphic2+sa;o.apply(this.$ImageGraphic0,ea('rotate('+this.$ImageGraphic3+'deg)'));this.$ImageGraphich(225+sa);o.apply(this.$ImageGraphic7,ea('translate(-50%, -50%) rotate('+sa+'deg)'));};la.prototype.$ImageGraphicf=function(){"use strict";this.$ImageGraphich(225);};la.prototype.$ImageGraphice=function(){"use strict";o.set(this.$ImageGraphic6,'transition','transform 0.3s cubic-bezier(.08,.98,.15,1.09)');};la.prototype.$ImageGraphicc=function(){"use strict";o.set(this.$ImageGraphic6,'transition','');};la.prototype.$ImageGraphich=function(sa){"use strict";o.apply(this.$ImageGraphic6,ea('rotate('+sa+'deg) '+'translateX('+this.getDimensions().x/2+'px) '+'rotate('+-1*sa+'deg)'));};la.prototype.$ImageGraphic9=function(event){"use strict";this.photoEditor.setActiveGraphic(this);};la.prototype.$ImageGraphic8=function(){"use strict";i.removeClass(this.root,'loading');i.addClass(this.root,'loaded');this.$ImageGraphic1=this.$ImageGraphic5.width/this.$ImageGraphic5.height;var sa=new h();sa.setImageContent(this.$ImageGraphic5);o.set(this.$ImageGraphic0,'backgroundImage','url('+sa.toDataURL()+')');this.setDimensions(this.getDimensions());this.updatePos();this.photoEditor.setActiveGraphic(this);};la.prototype.setPos=function(sa){"use strict";ka.setPos.call(this,sa);var ta=this.$ImageGraphici();o.apply(this.$ImageGraphic0,{left:ta.x+'px',top:ta.y+'px'});};la.prototype.setDimensions=function(sa){"use strict";o.apply(this.root,{height:sa.x+'px',width:sa.x+'px'});var ta=(new s(sa.x,sa.x)).div(1,this.$ImageGraphic1).mul(z);o.apply(this.$ImageGraphic0,{height:Math.round(ta.y)+'px',width:Math.round(ta.x)+'px'});this.$ImageGraphicf();this.updateDraggableBoundingBox();};la.prototype.$ImageGraphici=function(){"use strict";var sa=this.getDimensions(),ta=this.getDimensionsForDrawable();return sa.sub(ta).div(2);};la.prototype.getInitialDimensions=function(){"use strict";var sa=Math.min(this.maxWidth,this.maxHeight);return new s(sa,sa,'document').mul(aa);};la.prototype.getDimensionsForDrawable=function(){"use strict";return s.getElementDimensions(this.$ImageGraphic0);};la.prototype.getRotation=function(){"use strict";return this.$ImageGraphic2;};la.prototype.setRotation=function(sa){"use strict";this.$ImageGraphic2=sa;o.apply(this.$ImageGraphic0,ea('rotate('+this.$ImageGraphic2+'deg)'));};la.prototype.onBeforeSuddenTransformation=function(){"use strict";this.$ImageGraphicc();};la.prototype.onAfterSuddenTransformation=function(){"use strict";this.$ImageGraphice();};for(var ma in la)if(la.hasOwnProperty(ma))oa[ma]=la[ma];var na=la===null?null:la.prototype;oa.prototype=Object.create(na);oa.prototype.constructor=oa;oa.__superConstructor__=la;function oa(sa,ta,ua,va,wa){"use strict";na.constructor.call(this,sa,ua,va,wa);this.$StickerGraphic0=ta;}oa.prototype.serialize=function(){"use strict";return Object.assign({},na.serialize.call(this),{sticker_id:this.$StickerGraphic0});};for(ja in ia)if(ia.hasOwnProperty(ja))pa[ja]=ia[ja];pa.prototype=Object.create(ka);pa.prototype.constructor=pa;pa.__superConstructor__=ia;function pa(sa,ta,ua,va,wa,xa,ya){"use strict";ka.constructor.call(this,sa,xa,ya);this.$TextGraphic0=new h();this.$TextGraphic1=va;this.$TextGraphic2=ua;this.$TextGraphic3=ta;this.$TextGraphic4=ta;this.$TextGraphic5=false;this.$TextGraphic6=j.create('input',{className:"_5g78",type:'text'});i.addClass(this.root,"_5g79");this.root.appendChild(this.$TextGraphic6);this.$TextGraphic7=wa.appendChild(j.create('div'));i.addClass(this.$TextGraphic7,"_55jo");this.subscriptionsHandler.addSubscriptions(l.listen(this.root,'click',function(){this.$TextGraphic6.focus();}.bind(this)),l.listen(this.$TextGraphic6,'blur',function(){i.removeClass(this.root,"_5g7a");if(!this.$TextGraphic5||!this.$TextGraphic3.length){this.updateText(this.$TextGraphic4);this.$TextGraphic5=false;}}.bind(this)),l.listen(this.$TextGraphic6,'focus',function(){i.addClass(this.root,"_5g7a");this.inform('focus');if(!this.$TextGraphic5)this.updateText('');}.bind(this)),l.listen(this.$TextGraphic6,'keyup',w(this.$TextGraphic8,50,this)));this.updateText(ta,ua);}pa.prototype.$TextGraphic8=function(){"use strict";this.updateText(this.$TextGraphic6.value);this.$TextGraphic5=true;};pa.prototype.getDrawableObj=function(){"use strict";var sa=new h().setWidth(this.root.offsetWidth).setHeight(this.root.offsetHeight);sa.fillText(this.$TextGraphic3,this.$TextGraphic2,this.$TextGraphic1,0,0);return sa.getElement();};pa.prototype.getFont=function(){"use strict";return this.$TextGraphic2;};pa.prototype.getText=function(){"use strict";return this.$TextGraphic3;};pa.prototype.getFillStyle=function(){"use strict";return this.$TextGraphic1;};pa.prototype.updateText=function(sa,ta,ua){"use strict";if(ua)this.$TextGraphic1=ua;if(ta)this.$TextGraphic2=ta;if(typeof sa=='string')this.$TextGraphic3=sa;this.$TextGraphic6.value=this.$TextGraphic3;o.set(this.$TextGraphic7,'font',this.$TextGraphic2);var va=new q(this.$TextGraphic7,true).measure(this.$TextGraphic3);this.$TextGraphic0.clear().setWidth(va.width).setHeight(va.height).fillText(this.$TextGraphic3,this.$TextGraphic2,this.$TextGraphic1,0,0,true);o.apply(this.root,{width:va.width+'px',height:va.height+'px'});this.setCanvasAsBackground(this.$TextGraphic0);};pa.prototype.getTextHasChanged=function(){"use strict";return this.$TextGraphic5;};pa.prototype.setText=function(sa){"use strict";this.$TextGraphic3=sa;this.updateText();};pa.prototype.setFont=function(sa){"use strict";this.$TextGraphic2=sa;this.updateText();};pa.prototype.setFontFamily=function(sa){"use strict";this.$TextGraphic2.setFamily(sa);this.updateText();};pa.prototype.setFontSize=function(sa){"use strict";this.$TextGraphic2.setSize(sa);this.updateText();};pa.prototype.setFillStyle=function(sa){"use strict";this.$TextGraphic1=sa;this.updateText();};for(ma in la)if(la.hasOwnProperty(ma))qa[ma]=la[ma];qa.prototype=Object.create(na);qa.prototype.constructor=qa;qa.__superConstructor__=la;function qa(){"use strict";if(la!==null)la.apply(this,arguments);}qa.prototype.remove=function(){"use strict";na.remove.call(this);a.URL.revokeObjectURL(this.imageURL);};function ra(sa,ta){if(y[sa])y[sa].onDrop(ta);}e.exports={Image:la,Sticker:oa,Text:pa,Blob:qa,onDrop:ra};},null);
__d("PhotoEditorFont",["sprintf","PhotoEditorConfig"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=b('PhotoEditorConfig').Constants;function i(j,k,l){"use strict";this.$PhotoEditorFont0=j||h.DEFAULT_FONT_FAMILY;this.$PhotoEditorFont1=k||h.DEFAULT_FONT_SIZE;this.$PhotoEditorFont2=l||h.DEFAULT_FONT_METRIC;}i.prototype.setFamily=function(j){"use strict";this.$PhotoEditorFont0=j;};i.prototype.getFamily=function(){"use strict";return this.$PhotoEditorFont0;};i.prototype.setSize=function(j){"use strict";this.$PhotoEditorFont1=j;};i.prototype.getSize=function(){"use strict";return this.$PhotoEditorFont1;};i.prototype.setMetric=function(j){"use strict";this.$PhotoEditorFont2=j;};i.prototype.getMetric=function(){"use strict";return this.$PhotoEditorFont2;};i.prototype.toString=function(){"use strict";return g('%s%s %s',this.$PhotoEditorFont1,this.$PhotoEditorFont2,this.$PhotoEditorFont0);};i.prototype.copy=function(){"use strict";return new i(this.$PhotoEditorFont0,this.$PhotoEditorFont1,this.$PhotoEditorFont2);};i.getDefault=function(){return new i();};e.exports=i;},null);
__d("PhotoEditorDialogs",["Dialog","PhotoEditorFont","Form","DOM","React","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();function m(q,r,s){if(!s){s=r;r={};}var t=j.create('div'),u=k.createElement("form",{action:"#"},l._("Tama\u00f1o de la letra"),k.createElement("br",null),k.createElement("input",{name:"size",defaultValue:r.size})," px ",k.createElement("br",null),l._("Familia de tipo de letra"),k.createElement("br",null),k.createElement("select",{name:"family"},k.createElement("option",{value:"arial"},"Arial"),k.createElement("option",{value:"verdana"},"Verdana"),k.createElement("option",{value:"tahoma"},"Tahoma")),k.createElement("br",null),l._("Texto"),k.createElement("br",null),k.createElement("input",{name:"text",defaultValue:r.text}));u=k.render(u,t);u=t.firstChild;new g().setTitle(l._("Configurar texto")).setBody(t).setButtons(g.OK_AND_CANCEL).setHandler(function(){s(i.serialize(u));}).setCausalElement(q).show();}function n(q){m(q.getRoot(),function(r){q.addTextGraphic(r.text,new h(r.family,r.size,'px'));});}function o(q){var r=q.getFont().getSize(),s={text:q.getText(),size:r[1],family:r[2]};m(q.getElement(),s,function(t){q.updateText(t.text,new h(t.family,t.size,'px'));});}function p(q,r,s){new g().setBody(l._("\u00bfSeguro que quieres hacerlo?")).setTitle(r).setButtons(g.OK_AND_CANCEL).setHandler(s).setCausalElement(q.getRoot()).show();}e.exports={addText:n,editText:o,confirmation:p};},null);
__d("PhotoEditorShareDialog",["DOM"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(i,j){"use strict";this._editor=i;this._dialog=j;this._insertCanvasInput();this._insertImagePreview();}h.prototype._insertCanvasInput=function(){"use strict";var i=g.find(this._dialog.getRoot(),'form');i.appendChild(g.create('input',{type:'hidden',name:'stage',value:this._editor.toBase64()}));};h.prototype._insertImagePreview=function(){"use strict";var i=g.find(this._dialog.getRoot(),'.UIShareStage_Image');i.appendChild(this._editor.getPreviewCanvas(200/this._editor.getWorkingCanvas().getWidth()).getElement());};e.exports=h;},null);
__d("PhotoEditorButtonHandler",["PhotoEditorFilters","PhotoEditorDrawingHandlers","cx","CSS","PhotoEditorDialogs","Arbiter","AsyncDialog","AsyncRequest","PhotoEditorShareDialog","copyProperties","PhotoEditorConfig"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();var q=b('PhotoEditorConfig').Constants,r=b('PhotoEditorConfig').Actions;function s(v){"use strict";this.$ButtonHandler0=v;this.$ButtonHandler1=new l();}s.prototype.subscribe=function(v,w){"use strict";if(!Array.isArray(v))v=[v];v=v.map(function(x){return x.toString();});return this.$ButtonHandler1.subscribe(v,this.$ButtonHandler2.bind(null,w));};s.prototype.$ButtonHandler2=function(v,w,x){"use strict";v.apply(this,x);};s.prototype.handleAction=function(v,w){"use strict";return this.$ButtonHandler1.inform(v.toString(),[this.$ButtonHandler0,w]);};s.prototype.subscribeToStandardActions=function(){"use strict";this.subscribeToStandardActionsExcept();};s.prototype.subscribeToStandardActionsExcept=function(v){"use strict";var w=u;w=p({},w);if(v)for(var x=0;x<v.length;x++)delete w[v[x]];for(var y in w)this.subscribe(y,w[y]);};function t(v){return function(w,x){k.confirmation(w,x.getAttribute('aria-label'),v.bind(this,w));};}var u={};u[r.BW_FILTER]=function(v){v.getWorkingCanvas().applyFilter(g.BlackAndWhiteFilter);};u[r.REVERT]=function(v){v.revert();};u[r.PAINT_BRUSH]=function(v){v.enableDrawing(h.CircularBrush,v.getCurrentFillStyle());v.updateBrushConfigVisibility({color:true,size:true});j.addClass(v.getWorkingCanvas().getElement(),"_55g1");};u[r.PENCIL]=function(v){v.enableDrawing(h.SquareBrush,v.getCurrentFillStyle());v.updateBrushConfigVisiblity({color:true,size:true});j.addClass(v.getWorkingCanvas().getElement(),"_55g1");};u[r.REVERT_BRUSH]=function(v){v.enableDrawing(h.CircularBrush,v.getOriginalImage());v.updateBrushConfigVisiblity({color:false,size:true});j.addClass(v.getWorkingCanvas().getElement(),"_55g1");};u[r.SAVE_AS_PROFILE]=t(function(v){v.saveAsProfPic();});u[r.SAVE_IN_ALBUM]=function(v){m.send(new n().setURI(q.BROWSE_ALBUMS_SAVE).setData({save_on_click:1}));};u[r.ADD_TEXT]=function(v){k.addText(v);};u[r.IMPORT_IMAGE]=function(v){m.send(new n().setURI(q.BROWSE_ALBUMS_IMPORT));};u[r.SHARE]=function(v){new m.send(new n().setURI(q.SHARE_DIALOG_PATH),function(w){new o(v,w);});};u[r.ROTATE_CW]=function(v){v.rotate(true);};u[r.ROTATE_CCW]=function(v){v.rotate(false);};e.exports=s;},null);
__d("PhotoEditor",["ArbiterMixin","AsyncDialog","AsyncRequest","PhotoEditorButtonHandler","PhotoEditorCanvas","CSS","DOM","DragDropTarget","Event","PhotoEditorFont","PhotoEditorGraphic","PhotoEditorDOM","Style","SubscriptionsHandler","URI","Vector","cx","mixin","removeFromArray","PhotoEditorConfig"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){b.__markCompiled&&b.__markCompiled();var z=b('PhotoEditorConfig').Constants,aa=null,ba=90,ca=Math.PI/2,da=x(g);for(var ea in da)if(da.hasOwnProperty(ea))ga[ea]=da[ea];var fa=da===null?null:da.prototype;ga.prototype=Object.create(fa);ga.prototype.constructor=ga;ga.__superConstructor__=da;function ga(ha){"use strict";this.root=ha;this.workingCanvas=new k(this);this.layers=[];this.activeGraphic=null;this.rotations=0;this.buttonHandler=new j(this);this.originalImage=null;this.canvasWrapperEl=null;this.drawingSubscriptionsHandler=new t();this.stickerProxyPath=z.STICKER_PROXY_PATH;this.setCurrentFillStyle('black');this.setCurrentBrushSize(5);this.initDOM();this.reset();aa=this;l.addClass(this.canvasWrapperEl,"_5981");l.addClass(this.workingCanvas.getElement(),this.getCanvasClass());}ga.prototype.serialize=function(){"use strict";var ha=this.layers.map(function(ia){return ia.serialize();});return {graphics:ha,numRotations:this.getNumRotations()};};ga.prototype.getCanvasClass=function(){"use strict";return "_5982";};ga.prototype.initDOM=function(){"use strict";};ga.prototype.updateBrushConfigVisibility=function(ha){"use strict";};ga.prototype.getRoot=function(){"use strict";return this.root;};ga.prototype.getCanvasWrapper=function(){"use strict";return this.canvasWrapperEl;};ga.prototype.getGraphicsLayer=function(){"use strict";return this.canvasWrapperEl;};ga.prototype.setActiveGraphic=function(ha){"use strict";if(this.activeGraphic===ha)return;this.activeGraphic&&this.activeGraphic.onInactive();this.activeGraphic=ha;this.activeGraphic&&this.activeGraphic.onActive();};ga.prototype.setImage=function(ha){"use strict";this.workingCanvas.setImageContent(ha);s.apply(this.canvasWrapperEl,{width:ha.width+'px',height:ha.height+'px'});m.appendContent(this.canvasWrapperEl,this.workingCanvas.getElement());if(this._drawingHandler)this.canvasWrapperEl.appendChild(this._drawingHandler.getCursorElement());this.originalImage=ha;};ga.prototype.registerEventDelegate=function(ha){"use strict";return o.listen(ha,'click',this.handleDelegateClick.bind(this),o.Priority.URGENT);};ga.prototype.handleDelegateClick=function(ha){"use strict";var ia=ha.getTarget(),ja=r.getActionFromElement(ia);if(!ja)return;var ka=this.buttonHandler.handleAction(ja,ia);if(!ka)ha.prevent();};ga.prototype.getButtonHandler=function(ha,ia){"use strict";return this.buttonHandler;};ga.prototype.loadPhoto=function(ha){"use strict";var ia=new Image();ia.crossOrigin='anonymous';if(this.imageLoadRef)this.imageLoadRef.remove();this.imageLoadRef=o.listen(ia,'load',this.onImageLoaded.bind(this,ia));ia.src=ha;};ga.prototype.onImageLoaded=function(ha){"use strict";this.setImage(ha);this.inform('resize',ha);};ga.prototype.getImageDimensions=function(){"use strict";if(this.isInverted){return new v(this.workingCanvas.getHeight(),this.workingCanvas.getWidth());}else return new v(this.workingCanvas.getWidth(),this.workingCanvas.getHeight());};ga.prototype.getCanvasDimensions=function(){"use strict";if(this.isInverted){return new v(this.canvasWrapperEl.offsetHeight,this.canvasWrapperEl.offsetWidth);}else return new v(this.canvasWrapperEl.offsetWidth,this.canvasWrapperEl.offsetHeight);};ga.prototype.reset=function(){"use strict";l.removeClass(this.canvasWrapperEl,this.getRotateClass());this.workingCanvas.clear();this.rotations=0;this.isInverted=false;};ga.prototype.rotate=function(ha){"use strict";l.removeClass(this.canvasWrapperEl,this.getRotateClass());this.rotations+=ha?1:3;this.rotations%=4;if(this.rotations)l.addClass(this.canvasWrapperEl,this.getRotateClass());this.rotateGraphics(ha);this.isInverted=!this.isInverted;};ga.prototype.rotateGraphics=function(ha){"use strict";var ia=ha?Math.PI/2:Math.PI/-2;this.layers.forEach(function(ja){var ka=this.getCanvasDimensions().div(2),la=ja.getPos().sub(ka),ma=new v(la.x*Math.cos(ia)-la.y*Math.sin(ia),la.x*Math.sin(ia)+la.y*Math.cos(ia));if(ha){ma=ma.sub(ja.getDimensions().x,0);}else ma=ma.sub(0,ja.getDimensions().y);var na=new v(ka.y,ka.x);ja.setPos(na.add(ma));ja.setRotation(ja.getRotation()+ia*180/Math.PI);}.bind(this));};ga.prototype.getIsInverted=function(){"use strict";return this.isInverted;};ga.prototype.getNumRotations=function(){"use strict";return this.rotations;};ga.prototype.getRotationAngle=function(){"use strict";return this.rotations*ca;};ga.prototype.getRotateClass=function(){"use strict";return 'rot'+(this.rotations*ba);};ga.prototype.removeGraphic=function(ha){"use strict";if(this.activeGraphic===ha)this.setActiveGraphic(null);y(this.layers,ha);};ga.prototype._getRandomPosForGraphic=function(ha){"use strict";return v.getElementDimensions(this.getGraphicsLayer()).sub(ha.getInitialDimensions()).mul(Math.random(),Math.random());};ga.prototype.addGraphic=function(ha,ia){"use strict";this.layers.push(ha);if(!ia)ia=this._getRandomPosForGraphic(ha);this.getGraphicsLayer().appendChild(ha.getElement());ha.setPos(ia);this._enableGraphicsDragDrop();return ha;};ga.prototype.addBlobGraphic=function(ha,ia){"use strict";var ja=this.getCanvasDimensions();return this.addGraphic(new q.Blob(this,ha,ja.x,ja.y),ia);};ga.prototype.addImageGraphic=function(ha,ia){"use strict";var ja=this.getCanvasDimensions();return this.addGraphic(new q.Image(this,ha,ja.x,ja.y),ia);};ga.prototype.addStickerGraphic=function(ha,ia,ja){"use strict";var ka=this.getCanvasDimensions();return this.addGraphic(new q.Sticker(this,ha,ia,ka.x,ka.y),ja);};ga.prototype.addTextGraphic=function(ha,ia,ja){"use strict";var ka=this.getCanvasDimensions();return this.addGraphic(new q.Text(this,ha,ia,this.getCurrentFillStyle(),this.canvasWrapperEl,ka.x,ka.y),ja);};ga.prototype.crop=function(ha,ia,ja,ka){"use strict";this.workingCanvas.crop(ha,ia,ja,ka);this.inform('resize');};ga.prototype.getWorkingCanvas=function(){"use strict";return this.workingCanvas;};ga.prototype.getOriginalImage=function(){"use strict";return this.originalImage;};ga.prototype.setCurrentFillStyle=function(ha){"use strict";this.fillStyle=ha;if(this._drawingHandler)this._drawingHandler.setFillStyle(ha);};ga.prototype.getCurrentFillStyle=function(){"use strict";return this.fillStyle;};ga.prototype.setCurrentBrushSize=function(ha){"use strict";this.brushSize=ha;if(this._drawingHandler)this._drawingHandler.setBrushSize(ha);};ga.prototype.getCurrentBrushSize=function(){"use strict";return this.brushSize;};ga.prototype.getPreviewCanvas=function(ha){"use strict";return this.getFlattenedCanvas().scaledCopy(ha);};ga.prototype.getResizeFactor=function(){"use strict";return this.canvasWrapperEl.offsetWidth/this.workingCanvas.getWidth();};ga.prototype.revert=function(){"use strict";this.workingCanvas.setImageContent(this.originalImage);for(var ha=0;ha<this.layers.length;ha++)this.layers[ha].remove();this.layers=[];};ga.prototype.toDataURL=function(){"use strict";return this.getFlattenedCanvas().toDataURL();};ga.prototype.toBase64=function(){"use strict";return this.getFlattenedCanvas().toBase64();};ga.prototype.toBlob=function(ha){"use strict";this.getFlattenedCanvas().toBlob(ha);};ga.prototype.toBlobURI=function(ha){"use strict";this.getFlattenedCanvas().toBlobURI(ha);};ga.prototype.toURL=function(ha){"use strict";this.getFlattenedCanvas().toURL(ha);};ga.prototype.getFlattenedCanvas=function(){"use strict";var ha=this.workingCanvas.getWidth(),ia=this.workingCanvas.getHeight(),ja=new k(),ka=ja.getContext(),la,ma;if(this.rotations){if(this.rotations%2){la=ia/2;ma=ha/2;ja.setWidth(ia).setHeight(ha);}else{la=ha/2;ma=ia/2;ja.setWidth(ha).setHeight(ia);}ka.translate(la,ma);ka.rotate(this.rotations*ca);if(this.rotations%2){ka.translate(-ma,-la);}else ka.translate(-la,-ma);ja.drawGraphic(this.workingCanvas.getElement(),0,0);if(this.rotations%2){ka.translate(ma,la);}else ka.translate(la,ma);ka.rotate(-1*this.rotations*ca);ka.translate(-la,-ma);}else ja.setImageContent(this.workingCanvas.getElement());var na,oa,pa,qa,ra;for(var sa=0;sa<this.layers.length;sa++){na=this.layers[sa];pa=na.getCenterPos().div(this.getResizeFactor());qa=na.getDimensionsForDrawable().div(this.getResizeFactor());oa=na.getDrawableObj();ra=na.getRotation();ka.save();ka.translate(pa.x,pa.y);ka.rotate(ra*Math.PI/180);ja.drawGraphic(oa,qa.x/-2,qa.y/-2,qa.x,qa.y);ka.restore();}return ja;};ga.prototype.save=function(ha){"use strict";ha.stage=this.getFlattenedCanvas().toBase64();var ia=new i().setURI(u(z.SAVE_PATH).getPath()).setData(ha).setMethod('POST').setRelativeTo(this.root);h.send(ia);};ga.prototype.saveInAlbum=function(ha){"use strict";this.save({album_id:ha});};ga.prototype.saveAsProfPic=function(){"use strict";this.save({profile_pic:1});};ga.prototype.enableDrawing=function(ha,ia,ja){"use strict";this.drawingSubscriptionsHandler.engage();this.drawingSubscriptionsHandler.addSubscriptions(o.listen(this.canvasWrapperEl,'mousemove',this._onMouseMove.bind(this)),o.listen(this.canvasWrapperEl,'mouseleave',this._onMouseLeave.bind(this)));this._drawingHandler=this.workingCanvas.enableDrawing(ha,ia);l.hide(this._drawingHandler.getCursorElement());l.addClass(this.canvasWrapperEl,"_5ewy");this.canvasWrapperEl.appendChild(this._drawingHandler.getCursorElement());};ga.prototype.disableDrawing=function(){"use strict";this.drawingSubscriptionsHandler.release();this.workingCanvas.disableDrawing();l.removeClass(this.canvasWrapperEl,"_5ewy");m.remove(this._drawingHandler.getCursorElement());this._drawingHandler=null;};ga.prototype._onMouseLeave=function(){"use strict";l.hide(this._drawingHandler.getCursorElement());};ga.prototype._onMouseMove=function(ha){"use strict";v.getEventPosition(ha).sub(v.getElementPosition(this.canvasWrapperEl)).sub(this._drawingHandler.getDrawingCursor().getDimensions().div(2)).setElementPosition(this._drawingHandler.getCursorElement());l.show(this._drawingHandler.getCursorElement());};ga.prototype._enableGraphicsDragDrop=function(){"use strict";if(this._isGraphicDragDropEnabled)return;o.listen(this.canvasWrapperEl,'dragenter',o.prevent);o.listen(this.canvasWrapperEl,'dragover',o.prevent);o.listen(this.canvasWrapperEl,'drop',this._onDrop.bind(this));};ga.prototype._onDrop=function(ha){"use strict";var ia=ha.dataTransfer.getData('graphic_id');if(ia)q.onDrop(ia,ha);};ga.prototype.enableTextAndImageFileDragDrop=function(){"use strict";if(!this._dragDropTarget)this._dragDropTarget=new n(this.canvasWrapperEl).setOnDropCallback(function(ha,ia){var ja=ha.files||[],ka=ha.plainText,la=ia.dataTransfer.getData('graphic_id');if(la)return;var ma=v.getEventPosition(ia).sub(v.getElementPosition(this.canvasWrapperEl));if(ja.length==1){this.addBlobGraphic(a.URL.createObjectURL(ja[0]),ma);}else if(ja.length){for(var na=0;na<ja.length;na++)this.addBlobGraphic(a.URL.createObjectURL(ja[na]));}else if(ka)this.addTextGraphic(ka,new p('Arial',30,'px'),ma);}.bind(this)).setFileFilter(function(ha){var ia=[];for(var ja=0;ja<ha.length;ja++)if(ha[ja].type.match('image/*'))ia.push(ha[ja]);return ia;});this._dragDropTarget.enable();};ga.prototype.disableTextAndImageFileDragDrop=function(){"use strict";if(this._dragDropTarget)this._dragDropTarget.disable();};ga.addImageGraphic=function(ha){ga.getInstance().addImageGraphic(ha);};ga.addGraphicFromBrowser=function(ha){var ia=ha.getElementsByTagName('IMG')[0].getAttribute('src');return ga.getInstance().addImageGraphic(ia);};ga.saveInAlbum=function(ha){ga.getInstance().saveInAlbum(ha.getAttribute('data-albumid'));};ga.getInstance=function(){return aa;};e.exports=ga;},null);
__d("PhotoEditorSessionLogging",["AsyncRequest","PhotoEditorConfig"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=b('PhotoEditorConfig').Constants;function i(j,k){"use strict";this.$PhotoEditorSessionLogging0={context:j,is_editing:k,events:{},photo_saved:false};this.$PhotoEditorSessionLogging1=0;this.$PhotoEditorSessionLogging2=false;}i.prototype.start=function(){"use strict";this.$PhotoEditorSessionLogging1=Date.now();return this;};i.prototype.end=function(j){"use strict";if(this.$PhotoEditorSessionLogging2)return;this.$PhotoEditorSessionLogging2=true;this.$PhotoEditorSessionLogging0.duration=Date.now()-this.$PhotoEditorSessionLogging1;new g().setURI(h.LOGGING_PATH).setAllowCrossPageTransition(true).setOption('suppressErrorHandlerWarning',true).setOption('asynchronous',j).setData(this.$PhotoEditorSessionLogging0).send();return this;};i.prototype.logPhotoSaved=function(){"use strict";this.$PhotoEditorSessionLogging0.photo_saved=true;};i.prototype.logEvent=function(j){"use strict";if(!(j in this.$PhotoEditorSessionLogging0.events)){this.$PhotoEditorSessionLogging0.events[j]=1;}else this.$PhotoEditorSessionLogging0.events[j]++;return this;};e.exports=i;},null);
__d("FontSelectorPopover",["CSS","Event","JSXDOM","Parent","PhotoEditorPopover","cx","PhotoEditorConfig"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=b('PhotoEditorConfig').Constants,n='data-fontfamily';for(var o in k)if(k.hasOwnProperty(o))q[o]=k[o];var p=k===null?null:k.prototype;q.prototype=Object.create(p);q.prototype.constructor=q;q.__superConstructor__=k;function q(r,s){"use strict";p.constructor.call(this,r);this.$FontSelectorPopover0=s;this.$FontSelectorPopover1={};this.$FontSelectorPopover2=null;h.listen(this.flyoutRoot,'click',this.$FontSelectorPopover3.bind(this));}q.prototype.renderFlyoutContent=function(){"use strict";this.flyoutRoot.appendChild(i.ul({className:"_5g8f"},this.$FontSelectorPopover4()));this.setActive(this.$FontSelectorPopover2);};q.prototype.$FontSelectorPopover4=function(){"use strict";var r=m.FONTS,s=[],t,u;for(var v in r){t=r[v];u=i.li({"data-fontfamily":t,style:{fontFamily:t}},v);s.push(u);this.$FontSelectorPopover1[t]=u;}return s;};q.prototype.$FontSelectorPopover3=function(r){"use strict";var s=j.byAttribute(r.getTarget(),n);if(!s)return;var t=s.getAttribute(n);this.inform('selection',t);this.setActive(t);};q.prototype.setActive=function(r){"use strict";var s="_5g8g";for(var t in this.$FontSelectorPopover1)if(t==r){g.addClass(this.$FontSelectorPopover1[r],s);}else g.removeClass(this.$FontSelectorPopover1[t],s);this.$FontSelectorPopover2=r;};e.exports=q;},null);
__d("PhotoEditorTextPalette",["ColorSelectorPopover","DOM","Event","PhotoEditorFont","FontSelectorPopover","SizeSelectorPopover","PhotoEditorGraphic","JSXDOM","PhotoEditorPaletteBase","Style","csx","cx","fbt","PhotoEditorConfig"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();var t=b('PhotoEditorConfig').Constants;for(var u in o)if(o.hasOwnProperty(u))w[u]=o[u];var v=o===null?null:o.prototype;w.prototype=Object.create(v);w.prototype.constructor=w;w.__superConstructor__=o;function w(x,y){"use strict";v.constructor.call(this,x,y);this.$PhotoEditorTextPalette0=t.DEFAULT_FILL_STYLE;}w.prototype.initDOM=function(){"use strict";v.initDOM.call(this);this.$PhotoEditorTextPalette1();this.$PhotoEditorTextPalette2();this.$PhotoEditorTextPalette3();};w.prototype.$PhotoEditorTextPalette1=function(){"use strict";this.$PhotoEditorTextPalette4=h.find(this.palette,"._5g74");this.$PhotoEditorTextPalette5=this.$PhotoEditorTextPalette4.appendChild(n.span({className:"_5g8h"},j.getDefault().getSize()));this.$PhotoEditorTextPalette6=new l(this.$PhotoEditorTextPalette4,j.getDefault().getSize(),t.MIN_FONT_SIZE,t.MAX_FONT_SIZE);this.$PhotoEditorTextPalette6.subscribe('selection',this.$PhotoEditorTextPalette7.bind(this));};w.prototype.$PhotoEditorTextPalette2=function(){"use strict";this.$PhotoEditorTextPalette8=h.find(this.palette,"._5g76");this.$PhotoEditorTextPalette9=n.span({className:"_5g71"});p.set(this.$PhotoEditorTextPalette9,'background',t.DEFAULT_FILL_STYLE);this.$PhotoEditorTextPalette8.appendChild(this.$PhotoEditorTextPalette9);this.$PhotoEditorTextPalettea=new g(this.$PhotoEditorTextPalette8,t.DEFAULT_FILL_STYLE);this.$PhotoEditorTextPalettea.subscribe('selection',this.$PhotoEditorTextPaletteb.bind(this));};w.prototype.$PhotoEditorTextPalette3=function(){"use strict";this.$PhotoEditorTextPalettec=h.find(this.palette,"._5g75");p.set(this.$PhotoEditorTextPalettec,'font-family',j.getDefault().getFamily());this.$PhotoEditorTextPaletted=this.$PhotoEditorTextPalettec.appendChild(n.span({className:"_5g8i"},"T"));this.$PhotoEditorTextPalettee=new k(this.$PhotoEditorTextPalettec,t.DEFAULT_FONT_FAMILY);this.$PhotoEditorTextPalettee.subscribe('selection',this.$PhotoEditorTextPalettef.bind(this));this.$PhotoEditorTextPalettee.setActive(j.getDefault().getFamily());};w.prototype.onEnable=function(x){"use strict";this.subscriptionsHandler.addSubscriptions(i.listen(this.confirmButton,'click',this.disable.bind(this,true)));if(x){this.enableForExistingText(x);}else this.enableForNewText(x);};w.prototype.$PhotoEditorTextPaletteb=function(x,y){"use strict";this.$PhotoEditorTextPaletteh(y);};w.prototype.$PhotoEditorTextPaletteh=function(x){"use strict";this.$PhotoEditorTextPalette0=x;p.set(this.$PhotoEditorTextPalette9,'background',x);this.currentTextGraphic.setFillStyle(x);this.inform('setcolor');};w.prototype.$PhotoEditorTextPalettef=function(x,y){"use strict";this.$PhotoEditorTextPalettei(y);};w.prototype.$PhotoEditorTextPalettei=function(x){"use strict";this.currentTextGraphic.setFontFamily(x);p.set(this.$PhotoEditorTextPalettec,'font-family',x);this.inform('setfontfamily');};w.prototype.$PhotoEditorTextPalette7=function(x,y){"use strict";this.$PhotoEditorTextPalettej(y);};w.prototype.$PhotoEditorTextPalettej=function(x){"use strict";this.currentTextGraphic.setFontSize(x);h.setContent(this.$PhotoEditorTextPalette5,x);this.inform('setsize');};w.prototype.$PhotoEditorTextPalettek=function(x){"use strict";p.set(this.$PhotoEditorTextPalettec,'font-family',x.getFamily());h.setContent(this.$PhotoEditorTextPalette5,x.getSize());};w.prototype.enableForExistingText=function(x){"use strict";this.currentTextGraphic=x;this.$PhotoEditorTextPalettel=this.$PhotoEditorTextPalettem.bind(this,x.getText(),x.getFont().copy(),x.getFillStyle());var y=this.currentTextGraphic.getFont();this.$PhotoEditorTextPaletteh(this.currentTextGraphic.getFillStyle());this.$PhotoEditorTextPalettea.setColor(this.currentTextGraphic.getFillStyle());this.$PhotoEditorTextPalettek(y);this.$PhotoEditorTextPalettee.setActive(y.getFamily());this.$PhotoEditorTextPalette6.setSize(y.getSize());};w.prototype.enableForNewText=function(x){"use strict";var y=s._("[HAZ CLIC PARA EDITAR]"),z=j.getDefault(),aa=this.photoEditor.getCanvasDimensions();this.currentTextGraphic=this.photoEditor.addGraphic(new m.Text(this.photoEditor,y,j.getDefault(),t.DEFAULT_FILL_STYLE,this.photoEditor.getCanvasWrapper(),aa.x,aa.y));this.$PhotoEditorTextPalettel=this.$PhotoEditorTextPaletten.bind(this);this.$PhotoEditorTextPaletteh(t.DEFAULT_FILL_STYLE);this.$PhotoEditorTextPalettea.setColor(t.DEFAULT_FILL_STYLE);this.$PhotoEditorTextPalettek(z);this.$PhotoEditorTextPalettee.setActive(z.getFamily());this.$PhotoEditorTextPalette6.setSize(z.getSize());};w.prototype.$PhotoEditorTextPalettem=function(x,y,z){"use strict";this.currentTextGraphic.updateText(x,y,z);};w.prototype.$PhotoEditorTextPaletten=function(){"use strict";this.currentTextGraphic.remove();};w.prototype.onDisable=function(x){"use strict";if(!x)this.$PhotoEditorTextPalettel();this.$PhotoEditorTextPalettea.hide();this.$PhotoEditorTextPalettee.hide();this.$PhotoEditorTextPalette6.hide();};e.exports=w;},null);
__d("DialogPhotoEditor",["AsyncRequest","PhotoEditorCanvas","CSS","DOM","PhotoEditorDrawingPalette","Event","PhotoEditorFilterPalette","PhotoEditorFilters","PhotoEditorGraphic","PhotoEditor","PhotoEditorDOM","React","Run","PhotoEditorSessionLogging","StickersFlyout.react","SubscriptionsHandler","PhotoEditorTextPalette","Vector","XHPTemplate","clamp","curry","cx","csx","PhotoEditorConfig"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca){b.__markCompiled&&b.__markCompiled();var da=b('PhotoEditorConfig').Actions,ea=b('PhotoEditorConfig').Constants,fa=b('PhotoEditorConfig').Contexts,ga=b('PhotoEditorConfig').Events,ha=30,ia=new x(620,430),ja=new x(500,500),ka={CLOSE:1,UNLOAD:2,LEAVE:3};for(var la in p)if(p.hasOwnProperty(la))na[la]=p[la];var ma=p===null?null:p.prototype;na.prototype=Object.create(ma);na.prototype.constructor=na;na.__superConstructor__=p;function na(oa,pa){"use strict";ma.constructor.call(this,oa.getRoot(),pa);this.spotlight=oa;this.isNewPhoto=!pa;if(this.isNewPhoto){this._initForBlankCanvas();}else this.loadPhoto(pa);this._subscriptionsHandler=new v();this._subscriptionsHandler.addSubscriptions(this.registerEventDelegate(this.root));this.buttonHandler.subscribeToStandardActionsExcept([da.ADD_TEXT]);this.setCurrentBrushSize(ea.DEFAULT_BRUSH_SIZE);this._lastPalette=null;this.isEnabled=false;this.enable();}na.prototype.addGraphic=function(oa,pa){"use strict";ma.addGraphic.call(this,oa,pa);this.logAddGraphic(oa);if(!(oa instanceof o.Text))return oa;oa.subscribe('focus',function(){this._textPalette.disable(true);this._textPalette.enable(oa);}.bind(this));return oa;};na.prototype.logAddGraphic=function(oa){"use strict";if(oa instanceof o.Blob){this._logEvent(ga.ADD_BLOB);}else if(oa instanceof o.Sticker){this._logEvent(ga.ADD_STICKER);}else if(oa instanceof o.Image){this._logEvent(ga.ADD_IMAGE);}else if(oa instanceof o.Text)this._logEvent(ga.ADD_TEXT);};na.prototype.removeGraphic=function(oa){"use strict";ma.removeGraphic.call(this,oa);this.logRemoveGraphic(oa);};na.prototype.logRemoveGraphic=function(oa){"use strict";if(oa instanceof o.Blob){this._logEvent(ga.REMOVE_BLOB);}else if(oa instanceof o.Sticker){this._logEvent(ga.REMOVE_STICKER);}else if(oa instanceof o.Image){this._logEvent(ga.REMOVE_IMAGE);}else if(oa instanceof o.Text)this._logEvent(ga.REMOVE_TEXT);};na.prototype.initDOM=function(){"use strict";this.canvasWrapperEl=j.find(this.root,"._5cou");this.stage=j.find(this.root,"._5cow");this._mainPalette=j.find(this.root,"._5c-r");this._closeButton=j.find(this._mainPalette,"._5c-p");this._saveButton=j.find(this.root,"._5cov");this._addSticker=j.find(this.root,"._5c_i");this._drawButton=j.find(this.root,"._5g8k");this._addText=q.getElementForAction(this._mainPalette,da.ADD_TEXT);this._filterButton=q.getElementForAction(this._mainPalette,da.FILTER_DROPDOWN);};na.prototype.enable=function(){"use strict";if(this.isEnabled)return;var oa=y.getNode(this._addSticker,'stickers');if(oa)this._stickersFlyout=r.render(r.createElement(u,{onPackSelect:function(pa){if(this._stickersFlyout&&this._stickersFlyout.isMounted())this._stickersFlyout.setProps({packID:pa});}.bind(this),onStickerSelect:this._onStickerSelected.bind(this)}),oa);this._subscriptionsHandler.engage();this._subscriptionsHandler.addSubscriptions(l.listen(this._closeButton,'click',this.disable.bind(this,ka.CLOSE)),l.listen(this._filterButton,'click',this._showFilterPalette.bind(this)),l.listen(this._drawButton,'click',this._showDrawingPalette.bind(this)),l.listen(this._addText,'click',this._showTextPalette.bind(this)),l.listen(this._saveButton,'click',this.onClickSave.bind(this)),l.listen(window,'resize',this.resize.bind(this)),this.spotlight.subscribe('hide',function(){this.disable(ka.CLOSE);}.bind(this)));this.enableTextAndImageFileDragDrop();this.sessionLogging=new t(this.getLoggingContext(),!this.isNewPhoto).start();s.onLeave(this.disable.bind(this,ka.LEAVE));s.onUnload(this.disable.bind(this,ka.UNLOAD));this.isEnabled=true;};na.prototype.getLoggingContext=function(){"use strict";return fa.DIALOG;};na.prototype.loadPhoto=function(oa){"use strict";ma.loadPhoto.call(this,oa);ia.setElementDimensions(this.stage);};na.prototype._initForBlankCanvas=function(){"use strict";i.addClass(this.canvasWrapperEl,"_5c_9");ja.setElementDimensions(this.canvasWrapperEl);this.workingCanvas=new h(this).setWidth(ja.x).setHeight(ja.y);this.unfilteredImage=this.workingCanvas.copy().getElement();this.originalImage=this.workingCanvas.copy().getElement();j.setContent(this.canvasWrapperEl,this.workingCanvas.getElement());this.resize();};na.prototype.rotate=function(oa){"use strict";ma.rotate.call(this,oa);this.resize();};na.prototype.setImage=function(oa){"use strict";ma.setImage.call(this,oa);this.unfilteredImage=oa;this.resize();};na.prototype.getUnfilteredImage=function(){"use strict";return this.unfilteredImage;};na.prototype.onClickSave=function(){"use strict";};na.prototype.disable=function(oa){"use strict";if(!this.isEnabled)return;if(!oa)oa=ka.CLOSE;this.isEnabled=false;this.spotlight.hide();this._subscriptionsHandler.release();if(this._lastPalette)this._lastPalette.disable();this.disableTextAndImageFileDragDrop();this.canvasWrapperEl.appendChild(r.createElement("div",{className:"_5g8j"}));this.sessionLogging.end(oa===ka.CLOSE);};na.prototype._logEvent=function(oa){"use strict";this.sessionLogging.logEvent(oa);};na.prototype._onStickerSelected=function(oa){"use strict";new g(ea.ADD_STICKER_PATH).setData({id:oa}).setHandler(function(pa){this.addStickerGraphic(oa,pa.payload.sticker_src);}.bind(this)).send();};na.prototype._showFilterPalette=function(){"use strict";if(!this._filterPalette){var oa=new m(this,j.find(this.root,"._5c-t"));this._subscriptionsHandler.addSubscriptions(oa.subscribe('enabled',i.hide.bind(null,this._mainPalette)),oa.subscribe('disabled',function(pa,qa){i.show(this._mainPalette);this.workingCanvas.setImageContent(this.unfilteredImage);if(qa){this.workingCanvas.applyFilter(qa.filter,qa.args);this._logApplyFilter(qa.filter);}else this._logEvent(ga.REVERT_FILTER);}.bind(this)));this._filterPalette=oa;}this._filterPalette.enable();this._lastPalette=this._filterPalette;this._logEvent(ga.OPEN_FILTER_MENU);};na.prototype._logApplyFilter=function(oa){"use strict";if(oa===n.BlackAndWhiteFilter)this._logEvent(ga.APPLY_BW_FILTER);};na.prototype._showDrawingPalette=function(){"use strict";if(!this._drawingPalette){var oa=new k(this,j.find(this.root,"._5g8l"));this._subscriptionsHandler.addSubscriptions(oa.subscribe('enabled',i.hide.bind(null,this._mainPalette)),oa.subscribe('disabled',aa(i.show,this._mainPalette)),oa.subscribe('setcolor',this._logEvent.bind(this,ga.CHOOSE_BRUSH_COLOR)),oa.subscribe('setsize',this._logEvent.bind(this,ga.CHOOSE_BRUSH_SIZE)));this._drawingPalette=oa;}this._drawingPalette.enable();this._lastPalette=this._drawingPalette;this._logEvent(ga.OPEN_DRAWING_MENU);};na.prototype._showTextPalette=function(){"use strict";if(!this._textPalette){var oa=new w(this,j.find(this.root,"._5g6-"));this._subscriptionsHandler.addSubscriptions(oa.subscribe('enabled',i.hide.bind(null,this._mainPalette)),oa.subscribe('disabled',aa(i.show,this._mainPalette)),oa.subscribe('setcolor',this._logEvent.bind(this,ga.CHOOSE_TEXT_COLOR)),oa.subscribe('setfontfamily',this._logEvent.bind(this,ga.CHOOSE_FONT_FAMILY)),oa.subscribe('setsize',this._logEvent.bind(this,ga.CHOOSE_FONT_SIZE)));this._textPalette=oa;}this._textPalette.enable();this._lastPalette=this._textPalette;this._logEvent(ga.OPEN_TEXT_MENU);};na.prototype.getControlPanelHeight=function(){"use strict";return 0;};na.prototype.resize=function(){"use strict";var oa=this.getResizeFactor(),pa=this.getImageDimensions(),qa=this.getControlPanelHeight(),ra=x.getViewportDimensions().sub(ha*2,ha*2+qa),sa=new x(z(ia.x,pa.x,ra.x),z(ia.y,pa.y,ra.y),'document');if(pa.x>=sa.x||pa.y>=sa.y){var ta=pa.x/pa.y,ua=sa.x/sa.y;if(ua<ta){pa=new x(sa.x,Math.round(sa.x/ta));}else if(ua>ta){pa=new x(Math.round(sa.y*ta),sa.y);}else pa=sa;sa=new x(Math.max(ia.x,pa.x),Math.max(ia.y,pa.y),'document');}pa.setElementDimensions(this.getGraphicsLayer());sa.sub(pa).div(2).setElementPosition(this.getGraphicsLayer());if(this.isInverted)pa=new x(pa.y,pa.x);pa.setElementDimensions(this.canvasWrapperEl);sa.sub(pa).div(2).setElementPosition(this.canvasWrapperEl);sa.add(0,qa).setElementDimensions(this.stage);this._resizeGraphics(oa);};na.prototype._resizeGraphics=function(oa){"use strict";var pa=this.getResizeFactor()/oa;this.layers.forEach(function(qa){qa.onBeforeSuddenTransformation();qa.setPos(qa.getPos().mul(pa));qa.setDimensions(qa.getDimensions().mul(pa));qa.updatePos();qa.onAfterSuddenTransformation();});};e.exports=na;e.exports.DISABLE_TYPES=ka;},null);
__d("StickerButton.react",["React","StickerInterfaces","UFIStickerButton.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=g,m=l.PropTypes,n=g.createClass({displayName:"StickerButton",propTypes:{onStickerSelected:m.func.isRequired},render:function(){return (g.createElement(i,{showTooltip:false,stickerInterface:h.COMPOSER,onStickerSelected:this.props.onStickerSelected},g.createElement("div",{className:"_3pjh"},k._("STICKERS"))));}});e.exports=n;},null);
__d("StickerPhotoEditorControls.react",["Link.react","React","StickerButton.react","XUIOverlayButton.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=h,n=m.PropTypes,o=h.createClass({displayName:"StickerPhotoEditorControls",propTypes:{onDoneClicked:n.func.isRequired,onRotateClicked:n.func.isRequired,onStickerSelected:n.func.isRequired,useNewControlPanel:n.bool},_renderDoneButton:function(){if(this.props.useNewControlPanel)return (h.createElement(j,{className:"_1mp5",label:l._("Cerrar"),onClick:this.props.onDoneClicked}));return null;},render:function(){return (h.createElement("div",{className:(("_2nna")+(this.props.useNewControlPanel?' '+"_1mp6":''))},h.createElement(g,{className:"_2cgk",onClick:this.props.onRotateClicked},h.createElement("div",{className:"_2cgl"}),h.createElement("div",{className:"_3pjh"},l._("GIRAR"))),h.createElement("div",{className:"_2cgk"},h.createElement(i,{onStickerSelected:this.props.onStickerSelected})),this._renderDoneButton()));}});e.exports=o;},null);
__d("StickerPhotoEditor",["Arbiter","AsyncRequest","CSS","DialogPhotoEditor","DOM","Event","PhotoEditorSessionLogging","React","StickerPhotoEditorControls.react","SubscriptionsHandler","Vector","areEqual","cx","csx","PhotoEditorConfig"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();var u=b('PhotoEditorConfig').Constants,v=b('PhotoEditorConfig').Contexts,w=b('PhotoEditorConfig').Events,x={};for(var y in j)if(j.hasOwnProperty(y))aa[y]=j[y];var z=j===null?null:j.prototype;aa.prototype=Object.create(z);aa.prototype.constructor=aa;aa.__superConstructor__=j;function aa(ba){"use strict";z.constructor.call(this,ba.spotlight,ba.photoURI);this.photoFBID=ba.photoFBID;this.gridID=ba.gridID;g.inform('AttachmentsPhotoEditor/logPhotoEditorLaunched'+this.gridID);}aa.prototype.initDOM=function(){"use strict";this.canvasWrapperEl=k.find(this.root,"._5x68");this.$StickerPhotoEditor0=k.find(this.root,"._45q6");this.stage=k.find(this.root,"._40iu");this.$StickerPhotoEditor1=k.find(this.root,"._5cgk");var ba=k.scry(this.root,"._1wsu");this.$StickerPhotoEditor2=(!!ba.length)?ba[0]:(void 0);var ca=k.scry(this.root,"._388e");this.$StickerPhotoEditor3=(!!ca.length)?ca[0]:(void 0);this.$StickerPhotoEditor4=k.find(this.root,"._5x69");var da=n.createElement(o,{onDoneClicked:this.$StickerPhotoEditor5.bind(this),onRotateClicked:this.rotate.bind(this,false),onStickerSelected:this.$StickerPhotoEditor6.bind(this),useNewControlPanel:!ba.length});n.render(da,this.$StickerPhotoEditor4);};aa.prototype.onImageLoaded=function(ba){"use strict";i.removeClass(this.$StickerPhotoEditor1,"_ovf");z.onImageLoaded.call(this,ba);var ca=x[this.photoFBID];if(ca){for(var da=0;da<ca.numRotations;da++)this.rotate(true);ca.graphics.forEach(function(ea){var fa=this.addStickerGraphic(ea.sticker_id,ea.imageURL);fa.initFromSerializedState(ea);}.bind(this));}this.$StickerPhotoEditor7=ca||this.serialize();};aa.prototype.getGraphicsLayer=function(){"use strict";return this.$StickerPhotoEditor0;};aa.prototype.getControlPanelHeight=function(){"use strict";if(!!this.$StickerPhotoEditor2)return 0;return q.getElementDimensions(this.$StickerPhotoEditor4).y;};aa.prototype.enable=function(){"use strict";if(this.isEnabled)return;this.spotlight.show();this.$StickerPhotoEditor8=new p();this.$StickerPhotoEditor8.addSubscriptions(l.listen(window,'resize',this.resize.bind(this)),l.listen(this.$StickerPhotoEditor0,'mousedown',this.$StickerPhotoEditor9.bind(this)),this.spotlight.subscribe('hide',this.disable.bind(this)));if(!!this.$StickerPhotoEditor2)this.$StickerPhotoEditor8.addSubscriptions(l.listen(this.$StickerPhotoEditor2,'click',this.$StickerPhotoEditor5.bind(this)));if(!!this.$StickerPhotoEditor3)this.$StickerPhotoEditor8.addSubscriptions(l.listen(this.$StickerPhotoEditor3,'click',this.$StickerPhotoEditora.bind(this)));this.isEnabled=true;this.$StickerPhotoEditorb=new m(v.COMPOSER,true).start();};aa.prototype.$StickerPhotoEditor9=function(event){"use strict";if(!i.hasClass(event.target,"_45q6"))return;this.setActiveGraphic(null);};aa.prototype.rotate=function(ba){"use strict";z.rotate.call(this,ba);this.$StickerPhotoEditorc(w.ROTATE_IMAGE);};aa.prototype.disable=function(){"use strict";if(!this.isEnabled)return;this.isEnabled=false;this.$StickerPhotoEditorb.end(true);this.$StickerPhotoEditor8.release();};aa.prototype.$StickerPhotoEditord=function(){"use strict";x[this.photoFBID]=this.serialize();this.disable();this.spotlight.destroy();};aa.prototype.logAddGraphic=function(ba){"use strict";this.$StickerPhotoEditorc(w.ADD_STICKER);};aa.prototype.logRemoveGraphic=function(ba){"use strict";this.$StickerPhotoEditorc(w.REMOVE_STICKER);};aa.prototype.$StickerPhotoEditorc=function(ba){"use strict";this.$StickerPhotoEditorb.logEvent(ba);};aa.prototype.$StickerPhotoEditore=function(){"use strict";var ba=this.serialize();return !r(this.$StickerPhotoEditor7,ba);};aa.prototype.$StickerPhotoEditor6=function(ba){"use strict";new h(u.ADD_STICKER_PATH).setData({id:ba}).setHandler(function(ca){this.addStickerGraphic(ba,ca.payload.sticker_src);}.bind(this)).send();};aa.prototype.$StickerPhotoEditor5=function(){"use strict";if(this.$StickerPhotoEditore()){this.$StickerPhotoEditorb.logPhotoSaved();this.toBlob(function(ba){g.inform('AttachmentsPhotoEditor/newImage'+this.gridID,{blob:ba,fbid:this.photoFBID});g.inform('AttachmentsPhotoEditor/imageEdited'+this.photoFBID);this.$StickerPhotoEditord();}.bind(this));}else this.$StickerPhotoEditord();};aa.prototype.$StickerPhotoEditora=function(){"use strict";this.spotlight.hide();};aa.getMapOfStickersOnPhoto=function(ba){var ca={};if(x[ba]){var da=x[ba].graphics;da.forEach(function(ea){var fa=ea.sticker_id;if(!(fa in ca)){ca[fa]=1;}else ca[fa]++;});}return ca;};aa.getTotalNumOfStickersOnPhoto=function(ba){if(x[ba])return x[ba].graphics.length;return 0;};e.exports=aa;},null);
__d("ComposerXMediaUploadPlusAttachment",["Event","Arbiter","ComposerXAttachmentUtils","ComposerXController","ComposerXDragDrop","ComposerXMediaUploadAttachment","CSS","DOM","Lockable","Parent","PhotosMultiUploadInput","PUWApplications","VaultComposerController","AsyncRequest","csx","cx","ge","mixin","classWithMixins","AttachmentWithPhotosTaggingFlyoutMixin","PUWSteps","StickerPhotoEditor","SubscriptionsHandler","XComposerXAddPhotoItemController"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da){b.__markCompiled&&b.__markCompiled();var ea=y(l,x(z));for(var fa in ea)if(ea.hasOwnProperty(fa))ha[fa]=ea[fa];var ga=ea===null?null:ea.prototype;ha.prototype=Object.create(ga);ha.prototype.constructor=ha;ha.__superConstructor__=ea;function ha(ia,ja,ka,la,ma){"use strict";if(ma&&ma.getUploadInput().getGrid)this._grid=ma.getUploadInput().getGrid();ea.call(this,ia,ja,ka);this._gridID=this._uploadArea.id;this._controller=null;this._cameraIcon=null;this._eventSuggestionQuerySent=false;this._submitButtonLockable=null;this._cleaningUp=false;this._resetting=false;this._photoCount=0;this._scrollableArea=la;if(this._config.warningDialog)this._config.warningDialog.setContext(this._submitButton);this.initTaggingFlyoutMixin(this,ka);this._photosToInit=this._config.existingPhotos;if(this._config.qualityChooser)this._config.qualityChooser.addListener('checkboxChanged',function(na){ma.getUploadInput().onQualitySettingChanged(na);new t().setURI('/ajax/photos/upload/settings/').setData({composer_resolution:na?'high':'standard'}).send();});}ha.prototype.getGrid=function(){"use strict";return this._grid;};ha.prototype.getGridID=function(){"use strict";return this._gridID;};ha.prototype.getWaterfallID=function(){"use strict";if(this._grid){return this._grid.getWaterfallID();}else return q.getWaterfallID(this._gridID);};ha.prototype.getWaterfallAppName=function(){"use strict";return r.WEB_COMPOSER;};ha.prototype.getScrollableArea=function(){"use strict";return this._scrollableArea;};ha.prototype.initWithComponents=function(){"use strict";ga.initWithComponents.call(this);this.addSubscriptions(h.subscribe('multi-upload/images-upload-start/'+this._gridID,this._onUploadStart.bind(this)),h.subscribe('multi-upload/composer-reset/'+this._gridID,this._handleMultiUploadComposerReset.bind(this)),h.subscribe('multi-upload/images-added/'+this._gridID,this._handleImageAdded.bind(this)),h.subscribe('multi-upload/image-removed/'+this._gridID,this._handleImageRemoved.bind(this)),g.listen(this._root,'submit',this._onSubmit.bind(this),g.Priority.URGENT));if(this._supportsDragDrop()&&!this._dragdrop)this._dragdrop=new k(this._root,this.getComposerID());this.initTaggingFlyoutWithComponents();this._cameraIcon=this.getComponent('cameraicon');this._moreLink=n.find(this._root,"._2oh");m.conditionShow(this._moreLink,this._config.isMediaModifiable);var ia=[this._moreLink];this._cameraIcon&&ia.push(this._cameraIcon.element);this._controller=new s(this._gridID,ia).setSingleSelect(this._config.maxSelect===1).setPlaceholderHandler(this._setPlaceholders.bind(this));j.registerConditionForComposerCancel(this.getComposerID(),function(){return this._controller.hasChanges();}.bind(this));this._resetSubmitButtonLockable();var ja;if(!this._config.allowNoMedia){ja=this._submitButtonLockable.getLock().lock();this._controller.setEnableComposerHandler(function(ka){if(ka){ja.unlock();}else ja.lock();}).setAllMediaRemovedHandler(function(){if(!this._cleaningUp&&!this._resetting)if(j.hasAttachmentWithClassName(this._root,"_4j")){j.getAttachment(this._root,'/ajax/composerx/attachment/status/');}else if(this._config.editPostID)j.getAttachment(this._root,this._config.statusAttachmentEndpoint);}.bind(this));}else{ja=this._submitButtonLockable.getLock().unlock();this._controller.setEnableComposerHandler(function(ka){ja.unlock();});}if(!this._fileHandler)this._fileHandler=h.subscribe('ComposerXFilesStore/filesAdded/'+this._composerID+'/mediaupload',function(ka,la){if(!la.fileInput.getValue())return;if(this._grid){this._grid.doFileUpload(la.fileInput);}else q.doFileUpload(this._gridID,la.fileInput);}.bind(this));if(!this._cameraPhotoHandler)this._cameraPhotoHandler=h.subscribe('ComposerXFilesStore/filesAdded/'+this._composerID+'/cameraphoto',function(ka,la){var ma=da.getURIBuilder().setInt('photo_fbid',la.photoFBID).setString('grid_id',this._gridID).setInt('image_width',this._config.thumbnailSize.width).setInt('image_height',this._config.thumbnailSize.height).getURI();new t(ma).send();}.bind(this));if(this._supportsDragDrop()&&!this._dragdropHandler){this._dragdropHandler=h.subscribe('ComposerXFilesStore/filesDropped/'+this._composerID+'/mediaupload',function(ka,la){if(this._grid){this._grid.onFilesDrop(la.files,la.method);}else q.onFilesDrop(this._gridID,la.files);}.bind(this));k.handleDragEnterAndLeave(this._root);}if(this._photosToInit){this._photosToInit.forEach(function(ka){h.inform(['multi-upload/images-added/'+this._gridID,'multi-upload/images-added'],{fbids:{'0':''+ka},tagInfo:{},disableRecognition:true,initialPhoto:true});}.bind(this));this._photosToInit=null;}m.conditionShow(this._scrollableArea.getRoot(),this._config.isMediaModifiable||this._photoCount>0);if(this._config.postActionsButton!=null)this._config.postActionsButton.initHiddenInputs(this.getComponent('pabhiddeninputs').instance);};ha.prototype.reset=function(){"use strict";this._resetting=true;this.resetTaggingFlyout();this._removeAllImages();this.getTagger().reset();this._eventSuggestionQuerySent=false;if(this._config.isAutoEventSuggestionEnabled){var ia=w('event_tagging_auto_suggestion');ia&&m.hide(ia);}this._resetting=false;if(this._config.prefill)this._resetPrefill();};ha.prototype._handleImageAdded=function(ia,ja){"use strict";this._setPhotoCount(this._photoCount+Object.keys(ja.fbids).length);if(this._config.preShowWithTagger&&this.getComponent('withtagger'))this.getTagger().eventuallySwitchToTagger('with');if(ja.tagInfo.exifLocation&&ja.tagInfo.exifLocation.latitude&&ja.tagInfo.exifLocation.longitude){this.getTagger()._placeTagger.instance.getCore().setLocation(ja.tagInfo.exifLocation);if(this._config.exifUsePlaceComposerFlow)this.getTagger().eventuallySwitchToTagger('place');}if(!this._config.isAutoEventSuggestionEnabled)return;if(this.getComponent('hiddenplaceinput').element.value)return;if(this._eventSuggestionQuerySent)return;this._sendEventsSuggestionRequest({fbid:ja.fbids[Object.keys(ja.fbids)[0]],anchor_id:'composerCityTagger'});this._eventSuggestionQuerySent=true;};ha.prototype._handleImageRemoved=function(ia,ja){"use strict";this._setPhotoCount(this._photoCount-1);};ha.prototype._handleMultiUploadComposerReset=function(){"use strict";this._resetting=true;this._removeAllImages();this._resetting=false;};ha.prototype.cleanup=function(){"use strict";this._cleaningUp=true;this.cleanupTaggingFlyout();ga.cleanup.call(this);h.inform('multi-upload/video-removed/'+this._gridID);this._removeAllImages();this._controller.cleanup();this._moreLinkListener&&this._moreLinkListener.remove();if(this.getComponent('withtagger'))this._withTaggerIconListener&&this._withTaggerIconListener.remove();if(this._fileHandler){this._fileHandler.unsubscribe();this._fileHandler=null;}if(this._dragdrop){this._dragdrop.deactivate();this._dragdrop=null;}this._cleaningUp=false;};ha.prototype.canSwitchAway=function(){"use strict";return !p.byClass(this._root,'async_saving');};ha.prototype._supportsDragDrop=function(){"use strict";return this._config.maxSelect!==1;};ha.prototype._setPlaceholders=function(ia,ja){"use strict";i.setStickyPlaceholderForMentions(this.getComponent('maininput'),ia);i.setStickyPlaceholderForTypeahead(this.getComponent('placetagger').element,ja);this._cameraIcon&&m.conditionClass(this._cameraIcon.element,"_1dsx",this._controller.getTotalImageCount()>0);};ha.prototype._resetSubmitButtonLockable=function(){"use strict";this._submitButtonLockable=new o(this._setSubmitButtonEnabled.bind(this,true),this._setSubmitButtonEnabled.bind(this,false));this._overImageSelectionLimitLock=this._submitButtonLockable.getLock();this.setFaceRecSubmitButtonLock(this._submitButtonLockable.getLock());};ha.prototype._onUploadStart=function(){"use strict";var ia=n.find(this._root,'.fbScrollableAreaWrap');ia.scrollLeft=Math.max(0,n.find(this._root,'.fbScrollableAreaBody').offsetWidth-ia.offsetWidth);};ha.prototype._sendEventsSuggestionRequest=function(ia){"use strict";new t('ajax/events/tagging/suggestion_query').setData(ia).setHandler(null).send();};ha.prototype._initFileInput=function(){"use strict";};ha.prototype._getTotalNumberOfStickersOnPhotos=function(){"use strict";var ia=n.scry(this._root,".fbVaultGridItem"),ja=0;ia.forEach(function(ka){ja+=ba.getTotalNumOfStickersOnPhoto(ka.getAttribute('data-originalfbid'));});return ja;};ha.prototype._onSubmit=function(){"use strict";var ia=Date.now(),ja=this.logWithTaggingData(this._photoCount,this.getComposerID()),ka={volume:this._photoCount,with_tag_count:ja,sticker_count:this._getTotalNumberOfStickersOnPhotos()};this.logStep(aa.CLIENT_PUBLISH_BEGIN,ka);var la=new ca();la.addSubscriptions(g.listen(this._root,'success',function(ma){ka.dt=Date.now()-ia;this.logStep(aa.CLIENT_PUBLISH_SUCCESS,ka);this.logStep(aa.CLIENT_FLOW_SUCCESS);la.release();}.bind(this)),g.listen(this._root,'error',function(ma){ka.dt=Date.now()-ia;ma=ma.getData().response;if(ma){ka.error_code=ma.getError();ka.error_info=ma.getErrorDescription();}this.logStep(aa.CLIENT_PUBLISH_FAIL,ka);la.release();}.bind(this)));};ha.prototype._removeAllImages=function(){"use strict";this._setPhotoCount(0);n.scry(this._root,"._yr").forEach(function(ia){if(!m.hasClass(ia,"_2oh"))n.remove(ia);});if(this._grid){this._grid.clearSession();}else q.clearSession(this._gridID);h.inform(['multi-upload/all-images-removed/'+this._gridID,'multi-upload/all-images-removed']);};ha.prototype._setPhotoCount=function(ia){"use strict";this._photoCount=ia;if(this._config.maxSelect>1)if(this._photoCount>this._config.maxSelect){this._config.warningDialog.show();if(this._overImageSelectionLimitLock)this._overImageSelectionLimitLock.lock();}else{this._config.warningDialog.hide();if(this._overImageSelectionLimitLock)this._overImageSelectionLimitLock.unlock();}};e.exports=ha;},null);
__d("GroupSellLogger",["BanzaiLogger","GroupSellUserActionEvents"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i={logComposerTooltipNUXSeen:function(j){g.log('GroupSellUserActionsLoggerConfig',{event:h.COMPOSER_TOOLTIP_NUX_SEEN,group_id:j});},logComposerLoad:function(j){g.log('GroupSellUserActionsLoggerConfig',{event:h.COMPOSER_LOAD,group_id:j});},logLaunchSellComposer:function(j,k){g.log('GroupSellUserActionsLoggerConfig',{event:h.LAUNCH_SELL_COMPOSER,group_id:j,is_edit:k});},logLaunchNormalComposer:function(j){g.log('GroupSellUserActionsLoggerConfig',{event:h.LAUNCH_NORMAL_COMPOSER,group_id:j});},logComposerFillTitle:function(j,k){g.log('GroupSellUserActionsLoggerConfig',{event:h.COMPOSER_FILL_TITLE,group_id:j,is_edit:k});},logComposerFillPrice:function(j,k){g.log('GroupSellUserActionsLoggerConfig',{event:h.COMPOSER_FILL_PRICE,group_id:j,is_edit:k});},logComposerFillDescription:function(j,k){g.log('GroupSellUserActionsLoggerConfig',{event:h.COMPOSER_FILL_DESCRIPTION,group_id:j,is_edit:k});},logComposerFillPickupNote:function(j,k){g.log('GroupSellUserActionsLoggerConfig',{event:h.COMPOSER_FILL_PICKUP_NOTE,group_id:j,is_edit:k});},logComposerDeletePhoto:function(j,k){g.log('GroupSellUserActionsLoggerConfig',{event:h.COMPOSER_DELETE_PHOTO,group_id:j});},logComposerSubmit:function(j,k,l,m,n,o,p,q){g.log('GroupSellUserActionsLoggerConfig',{event:h.COMPOSER_SUBMIT,group_id:j,title:k,price_currency:l,price_amount:m,description:n,pickup_note:o,num_photos:p,is_edit:q});},_formatComposerInterceptWords:function(j,k){var l=[];if(k)l=k.slice();if(j>0)l.push(j.toString()+' prices count');return l.join(',');},logComposerInterceptDetected:function(j,k,l){g.log('GroupSellUserActionsLoggerConfig',{event:h.GROUP_NON_FOR_SALE_POST_INTERCEPT_DETECTED,group_id:j,intercept_words:i._formatComposerInterceptWords(k,l)});},logComposerInterceptAccepted:function(j,k,l){g.log('GroupSellUserActionsLoggerConfig',{event:h.GROUP_NON_FOR_SALE_POST_INTERCEPT_ACCEPTED,group_id:j,intercept_words:i._formatComposerInterceptWords(k,l)});},logComposerInterceptDeclined:function(j,k,l){g.log('GroupSellUserActionsLoggerConfig',{event:h.GROUP_NON_FOR_SALE_POST_INTERCEPT_DECLINED,group_id:j,intercept_words:i._formatComposerInterceptWords(k,l)});}};e.exports=i;},null);
__d("ComposerXSellAttachmentMixin",["Arbiter","ComposerXController","CSS","DOM","Focus","Input","Event","GroupSellLogger","Parent","SubscriptionsHandler","URI","URLScraper","csx","cx","setImmediate"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b.__markCompiled&&b.__markCompiled();var v={initSellInputs:function(){this._isUploadingPhotos=false;this._composerSubmitted=false;var w=this.getComponent('forsale').instance,x=this.getComponent('forsaleextras').instance;if(this._linkShare){k.set(this._getDescriptionTextarea());}else if(!this._config.isDefaultComposer)k.set(w.getTitleInput());this._inputsEverChanged={title:false,price:false,description:false,pickupNote:false};if(this._sellInputListeners){this._sellInputListeners.release();this._sellInputListeners=null;}if(this._descriptionFocusListener){this._descriptionFocusListener.remove();this._descriptionFocusListener=null;}this._sellInputListeners=new p();this._sellInputListeners.addSubscriptions(m.listen(w.getTitleInput(),'input',this._inputsChanged.bind(this)),m.listen(w.getTitleInput(),'change',this._inputsChanged.bind(this)),m.listen(w.getPriceInput(),'input',this._inputsChanged.bind(this)),m.listen(w.getPriceInput(),'change',this._inputsChanged.bind(this)),m.listen(w.getMultipleItemsCheckbox(),'change',this._inputsChanged.bind(this)),m.listen(this.getComponent('maininput').element,'input',this._inputsChanged.bind(this)),m.listen(this.getComponent('maininput').element,'change',this._inputsChanged.bind(this)),m.listen(w.getPickupNoteInput(),'input',this._inputsChanged.bind(this)),m.listen(w.getPickupNoteInput(),'change',this._inputsChanged.bind(this)),x.subscribe('categoryChanged',this._inputsChanged.bind(this)),m.listen(this.getSubmitButton(),'click',this._submitButtonClicked.bind(this)));if(this._taggingFlyoutData&&this._taggingFlyoutData.recognitionController)this._sellInputListeners.addSubscriptions(this._taggingFlyoutData.recognitionController.subscribe('done',this._inputsChanged.bind(this)));var y=j.scry(this._root,"._9s")[0];if(y)this._sellInputListeners.addSubscriptions(m.listen(y,'click',this._removeLinkAttachment.bind(this)));this._urlScraper=new r(this.getComponent('maininput').element,function(){return this.getComponent('maininput').instance.getValue();}.bind(this));this._scraperListener=this._urlScraper.subscribe('match',function(z,aa){if(this._hasPhotos||y||this._config.isEditComposer)return;var ba=new q(this._config.scraperEndpoint);ba.addQueryData({scrape_url:encodeURIComponent(aa.url)});h.getAttachment(this._root,ba.toString());}.bind(this));this.setHasPhotos(this.getPhotoCount()>0);this._controller.setPlaceholderHandler(function(){});if(!this._config.isEditComposer)n.logComposerLoad(this._config.targetID);this._logLaunchSellComposer();this._sellComposerInited=true;this._inputsChanged();},resetSellInputs:function(){if(this._sellInputListeners){this._sellInputListeners.release();this._sellInputListeners=null;}if(this._urlScraper){this._urlScraper.disable();this._urlScraper.reset();this._urlScraper=null;}if(this._descriptionFocusListener){this._descriptionFocusListener.remove();this._descriptionFocusListener=null;}var w=o.byClass(this._root,"child_was_focused");if(w)i.removeClass(w,"child_was_focused");this._isUploadingPhotos=false;this._composerSubmitted=false;},cleanupSellInputs:function(){if(this._scraperListener){this._scraperListener.unsubscribe();this._scraperListener=null;}if(!this._descriptionFocusListener)this._descriptionFocusListener=m.listen(this._getDescriptionTextarea(),'focus',function(){n.logLaunchNormalComposer(this._config.targetID);this._descriptionFocusListener.remove();this._descriptionFocusListener=null;if(this._nuxTooltip)this._nuxTooltip.show();}.bind(this));},_inputsChanged:function(){if(!this._sellComposerInited)return;var w=this.getComponent('forsale').instance,x=l.isEmpty(w.getTitleInput()),y=l.isEmpty(w.getHiddenPriceInput()),z=w.isMultipleItems(),aa=this.getComponent('forsaleextras').instance,ba=aa.requiresCategory(),ca=aa.hasCategory(),da=this.getComponent('maininput').instance,ea=!da.getValue(),fa=l.isEmpty(w.getPickupNoteInput());if(!this._inputsEverChanged.title&&!x){n.logComposerFillTitle(this._config.targetID,this._config.isEditComposer);this._inputsEverChanged.title=true;}if(!this._inputsEverChanged.price&&!y){n.logComposerFillPrice(this._config.targetID,this._config.isEditComposer);this._inputsEverChanged.price=true;}if(!this._inputsEverChanged.description&&!ea){n.logComposerFillDescription(this._config.targetID,this._config.isEditComposer);this._inputsEverChanged.description=true;}if(!this._inputsEverChanged.pickupNote&&!fa){n.logComposerFillPickupNote(this._config.targetID,this._config.isEditComposer);this._inputsEverChanged.pickupNote=true;}var ga=!this._isUploadingPhotos&&!this._composerSubmitted&&!x&&(!y||z)&&(!ba||ca),ha=this.getSubmitButton().parentNode,ia=j.find(ha,"._314l");i.conditionShow(ia,!ga);this._setSubmitButtonEnabled(ga);},_removeLinkAttachment:function(){if(!this._linkShare)return;j.remove(this._linkShare);this._linkShare=null;this._urlScraper.disable();},startedUploadingPhotos:function(){this._isUploadingPhotos=true;this._inputsChanged();},finishedUploadingPhotos:function(){this._isUploadingPhotos=false;this._inputsChanged();},setHasPhotos:function(w){this._hasPhotos=w;if(w)this._removeLinkAttachment();},_getDescriptionTextarea:function(){return j.find(this.getComponent('maininput').element,'textarea.input');},_submitButtonClicked:function(){this._composerSubmitted=true;this._logComposerSubmitted();u(this._inputsChanged.bind(this));},_logLaunchSellComposer:function(){var w=o.byClass(this._root,"focus_target");if(i.hasClass(w,'child_was_focused')){n.logLaunchSellComposer(this._config.targetID,this._config.isEditComposer);g.inform('GroupSellComposer/launchedComposer');}else var x=this.getComponent('forsale').instance,y=m.listen(x.getTitleInput(),'focus',function(){y.remove();n.logLaunchSellComposer(this._config.targetID,this._config.isEditComposer);g.inform('GroupSellComposer/launchedComposer');}.bind(this));},_logComposerSubmitted:function(){var w=this.getComponent('forsale').instance,x=this.getComponent('maininput').instance,y=parseFloat(l.getValue(w.getHiddenPriceInput()))*100;n.logComposerSubmit(this._config.targetID,l.getValue(w.getTitleInput()),l.getValue(w.getCurrencyInput()),y,x.getValue(),l.getValue(w.getPickupNoteInput()),this.getPhotoCount(),this._config.isEditComposer);}};e.exports=v;},null);
__d("ComposerXSellPlusAttachment",["ComposerXMediaUploadPlusAttachment","ComposerXSellAttachmentMixin","GroupSellLogger","Parent","classWithMixins","cx","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n=k(g,m(h));for(var o in n)if(n.hasOwnProperty(o))q[o]=n[o];var p=n===null?null:n.prototype;q.prototype=Object.create(p);q.prototype.constructor=q;q.__superConstructor__=n;function q(r,s,t,u,v,w,x){"use strict";n.call(this,r,s,t,u,v);this.attachmentClassName="_4_7-";this._linkShare=w;this._nuxTooltip=x;}q.prototype.initWithComponents=function(){"use strict";p.initWithComponents.call(this);this.getTagger().hideTaggerIcons();this._root.action=this._config.statusEndpoint;this.initSellInputs();};q.prototype.reset=function(){"use strict";this.resetSellInputs();p.reset.call(this);};q.prototype.cleanup=function(){"use strict";this.cleanupSellInputs();this.getTagger().showTaggerIcons();p.cleanup.call(this);};q.prototype.canSwitchAway=function(){"use strict";return !j.byClass(this._root,'async_saving');};q.prototype._onUploadStart=function(){"use strict";p._onUploadStart.call(this);this.setHasPhotos(true);this.startedUploadingPhotos();};q.prototype._handleImageRemoved=function(r,s){"use strict";p._handleImageRemoved.call(this,r,s);this.updateEndpoints();i.logComposerDeletePhoto(this._config.targetID,this._isEdit);};q.prototype._handleImageAdded=function(r,s){"use strict";p._handleImageAdded.call(this,r,s);this.finishedUploadingPhotos();this.updateEndpoints();};q.prototype.updateEndpoints=function(){"use strict";if(this._photoCount>0){this._root.action=this._config.photoEndpoint;this.setHasPhotos(true);}else{this._root.action=this._config.statusEndpoint;this.setHasPhotos(false);}};q.prototype.getPhotoCount=function(){"use strict";return this._photoCount;};e.exports=q;},null);
__d("ComposerXCameraIconBehavior",["Arbiter","ComposerXMediaUploadHandler","CSS","Event","cx"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l={initCameraIcon:function(m){this._cameraIcon=m.getComponent('cameraicon');if(!this._config.showCameraIcon){i.hide(this._cameraIcon.element);return;}i.show(this._cameraIcon.element);var n=this._cameraIcon.instance,o=new h(this._config.composerID,{imagesOnly:this._config.imagesOnly,isEditComposer:this._config.isEditComposer,photoUploadOverrideEndpoint:this._config.photoUploadOverrideEndpoint});this._listeners.push(j.listen(this._cameraIcon.element,'click',function(){o.fetchAttachments();g.inform('cameraicon/click');}.bind(this)));this._subscriptions.push(n.subscribe('change',function(){o.handleFileSelected(n);i.addClass(this._cameraIcon.element,"_19_a");}.bind(this)));}};e.exports=l;},null);
__d("ComposerXPlusTagger",["ComposerXCameraIconBehavior","ComposerXStandardTagger","classWithMixins","mixin"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=i(h,j(g));for(var l in k)if(k.hasOwnProperty(l))n[l]=k[l];var m=k===null?null:k.prototype;n.prototype=Object.create(m);n.prototype.constructor=n;n.__superConstructor__=k;function n(o){"use strict";k.call(this,o);this._eventuallyTagger=null;}n.prototype.init=function(o){"use strict";m.init.call(this,o);if(o.getComponent('cameraicon'))this.initCameraIcon(o);};n.prototype._nonObstrusiveSwitchToTagger=function(o){"use strict";var p=this._onTaggerShowCallbacks[o];delete this._onTaggerShowCallbacks[o];this.switchToTagger(o);this._dontHideTaggerOnMentionsFocus=o;this._onTaggerShowCallbacks[o]=p;};n.prototype.eventuallySwitchToTagger=function(o){"use strict";if(!this.isAnyTaggerShown()){this._nonObstrusiveSwitchToTagger(o);}else if(this._currentTagger!==o)this._eventuallyTagger=o;};n.prototype.switchToTagger=function(o){"use strict";if(this._eventuallyTagger===o)this._eventuallyTagger=null;this._nonEventuallyHideTaggers();this._showTagger(o);};n.prototype.hideTaggers=function(){"use strict";m.hideTaggers.call(this);if(this._eventuallyTagger){this._nonObstrusiveSwitchToTagger(this._eventuallyTagger);this._eventuallyTagger=null;}};n.prototype._nonEventuallyHideTaggers=function(){"use strict";m.hideTaggers.call(this);};n.prototype._hideTaggersFromMentionsInputClick=function(){"use strict";if(this._currentTagger!=this._dontHideTaggerOnMentionsFocus){this.eventuallySwitchToTagger(this._dontHideTaggerOnMentionsFocus);m._hideTaggersFromMentionsInputClick.call(this);}};e.exports=n;},null);
__d("ComposerXPlusTaggerWithOG",["ComposerXOGTaggerBehavior","ComposerXPlusTagger","classWithMixins","mixin"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=i(h,j(g));for(var l in k)if(k.hasOwnProperty(l))n[l]=k[l];var m=k===null?null:k.prototype;n.prototype=Object.create(m);n.prototype.constructor=n;n.__superConstructor__=k;function n(){"use strict";if(k!==null)k.apply(this,arguments);}n.prototype.init=function(o){"use strict";m.init.call(this,o);this.initOGTagger(o);};n.prototype.cleanup=function(){"use strict";m.cleanup.call(this);this.cleanupOGTagger();};e.exports=n;},null);
__d("ComposerXInstanceResetter",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(h){h.instance.reset();}e.exports=g;},null);
__d("ComposerXOGTaggerReset",["CSS"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(i){i.instance.reset();g.hide(i.element);}e.exports=h;},null);
__d("ComposerXPeopleTaggerReset",["CSS"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(i){i.instance.reset();g.hide(i.element);}e.exports=h;},null);
__d("ComposerXPlaceTaggerReset",["CSS"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(i){i.instance.getCore().reset();g.hide(i.element);}e.exports=h;},null);
__d("ComposerXForSaleComponent",["AdsCurrency","AdsCurrencyFormatter","CSS","DOM","Event","Input","Parent","SubscriptionsHandler","cx","getActiveElement","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();function r(s,t,u){"use strict";this._inputs=s;this._charCounts=t;this._options=u;this._currency=u.currencies[0];q(this._currency);this._currencySymbol=g.getSymbol(this._currency);q(this._currencySymbol);var v=this._inputs.title,w=this._inputs.price,x=this._inputs.pickupNote;this._subscriptions=new n();this._subscriptions.addSubscriptions(k.listen(v,'input',this._titleChanged.bind(this)),k.listen(v,'change',this._titleChanged.bind(this)),k.listen(v,'focus',this._titleFocusChanged.bind(this)),k.listen(v,'blur',this._titleFocusChanged.bind(this)),k.listen(w,'focus',this._priceFocused.bind(this)),k.listen(w,'input',this._priceChanged.bind(this)),k.listen(w,'change',this._priceChanged.bind(this)),k.listen(w,'blur',this._priceBlurred.bind(this)),k.listen(this._inputs.multipleItems,'change',this._multipleItemsChanged.bind(this)),k.listen(x,'input',this._pickupNoteChanged.bind(this)),k.listen(x,'change',this._pickupNoteChanged.bind(this)),k.listen(x,'focus',this._pickupNoteFocusChanged.bind(this)),k.listen(x,'blur',this._pickupNoteFocusChanged.bind(this)));l.setValue(this._inputs.hiddenCurrency,this._currency);this._priceChanged();this._priceBlurred();this._titleChanged();this._titleFocusChanged();this._pickupNoteChanged();this._pickupNoteFocusChanged();}r.prototype._titleChanged=function(){"use strict";this._charCounts.title.innerText=this._options.inputMaxChars-l.getValue(this._inputs.title).length;};r.prototype._titleFocusChanged=function(){"use strict";i.conditionShow(this._charCounts.title,p()===this._inputs.title);};r.prototype._priceFocused=function(){"use strict";if(l.isEmpty(this._inputs.price)&&!this.isMultipleItems())l.setValue(this._inputs.price,this._currencySymbol);};r.prototype._priceChanged=function(){"use strict";var s=this._getPriceValue();if(s==null){l.setValue(this._inputs.hiddenPrice,'');l.setValue(this._inputs.price,this._currencySymbol);return;}l.setValue(this._inputs.hiddenPrice,''+s);var t=g.getOffset(this._currency),u=h.formatCurrencyWithOptionalDecimals(this._currency,s*t);if(u!==l.getValue(this._inputs.price))l.setValue(this._inputs.price,u);};r.prototype._priceBlurred=function(){"use strict";var s=this._getPriceValue();if(s==null)l.reset(this._inputs.price);};r.prototype._getPriceValue=function(){"use strict";var s=l.getValue(this._inputs.price),t=s.replace(/\D/g,'');if(!t.length){return null;}else return parseInt(t,10);};r.prototype._multipleItemsChanged=function(){"use strict";var s=this.isMultipleItems();this._inputs.price.disabled=s;i.conditionClass(m.byClass(this._inputs.price,"_29m4"),"_2t7t",s);};r.prototype._pickupNoteChanged=function(){"use strict";var s=this._inputs.pickupNote;this._charCounts.pickupNote.innerText=this._options.inputMaxChars-l.getValue(s).length;};r.prototype._pickupNoteFocusChanged=function(){"use strict";i.conditionShow(this._charCounts.pickupNote,p()===this._inputs.pickupNote);};r.prototype.reset=function(){"use strict";l.reset(this._inputs.title);l.reset(this._inputs.price);l.reset(this._inputs.hiddenPrice);l.reset(this._inputs.pickupNote);this._charCounts.title.innerText=this._options.inputMaxChars;this._charCounts.pickupNote.innerText=this._options.inputMaxChars;this.getMultipleItemsCheckbox().checked=false;this._multipleItemsChanged();};r.prototype.getTitleInput=function(){"use strict";return this._inputs.title;};r.prototype.getPriceInput=function(){"use strict";return this._inputs.price;};r.prototype.getCurrencyInput=function(){"use strict";return this._inputs.hiddenCurrency;};r.prototype.getHiddenPriceInput=function(){"use strict";return this._inputs.hiddenPrice;};r.prototype.getMultipleItemsCheckbox=function(){"use strict";return j.find(this._inputs.multipleItems,'input');};r.prototype.isMultipleItems=function(){"use strict";return !!this.getMultipleItemsCheckbox().checked;};r.prototype.getPickupNoteInput=function(){"use strict";return this._inputs.pickupNote;};e.exports=r;},null);
__d("ComposerXForSaleExtrasComponent",["ArbiterMixin","ContextualLayer","CSS","DataStore","Event","Input","LayerHideOnBlur","SubscriptionsHandler","cx","mixin","fbt","getElementText","setTextContent"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();var t=p(g);for(var u in t)if(t.hasOwnProperty(u))w[u]=t[u];var v=t===null?null:t.prototype;w.prototype=Object.create(v);w.prototype.constructor=w;w.__superConstructor__=t;function w(x){"use strict";this.$ComposerXForSaleExtrasComponent0=x;if(this.$ComposerXForSaleExtrasComponent0.selectCategory){i.removeClass(this.$ComposerXForSaleExtrasComponent0.categoriesDropdown,"hidden_elem");this.$ComposerXForSaleExtrasComponent1=new n();this.$ComposerXForSaleExtrasComponent1.addSubscriptions(k.listen(this.$ComposerXForSaleExtrasComponent0.selectCategory,'click',this.$ComposerXForSaleExtrasComponent2.bind(this)),k.listen(this.$ComposerXForSaleExtrasComponent0.categoriesDropdown,'click',this.$ComposerXForSaleExtrasComponent3.bind(this)));this.$ComposerXForSaleExtrasComponent4=new h({context:this.$ComposerXForSaleExtrasComponent0.selectCategory,position:'below',alignment:'left'},this.$ComposerXForSaleExtrasComponent0.categoriesDropdown);this.$ComposerXForSaleExtrasComponent4.enableBehavior(m);}}w.prototype.requiresCategory=function(){"use strict";return !!this.$ComposerXForSaleExtrasComponent0.selectCategory;};w.prototype.hasCategory=function(){"use strict";if(!this.$ComposerXForSaleExtrasComponent0.categoryIDInput)return false;return !!l.getValue(this.$ComposerXForSaleExtrasComponent0.categoryIDInput);};w.prototype.$ComposerXForSaleExtrasComponent2=function(){"use strict";this.$ComposerXForSaleExtrasComponent4.show();};w.prototype.$ComposerXForSaleExtrasComponent3=function(event){"use strict";var x=j.get(event.target,'categoryID');if(x){this.$ComposerXForSaleExtrasComponent5(x,r(event.target));this.$ComposerXForSaleExtrasComponent4.hide();}};w.prototype.$ComposerXForSaleExtrasComponent5=function(x,y){"use strict";l.setValue(this.$ComposerXForSaleExtrasComponent0.categoryIDInput,x);s(this.$ComposerXForSaleExtrasComponent0.selectCategory,y);i.addClass(this.$ComposerXForSaleExtrasComponent0.selectCategory,"_4oxb");this.inform('categoryChanged');};w.prototype.reset=function(){"use strict";if(this.$ComposerXForSaleExtrasComponent0.categoryIDInput){l.reset(this.$ComposerXForSaleExtrasComponent0.categoryIDInput);s(this.$ComposerXForSaleExtrasComponent0.selectCategory,q._("Selecciona una categor\u00eda"));i.removeClass(this.$ComposerXForSaleExtrasComponent0.selectCategory,"_4oxb");}};e.exports=w;},null);
__d("Network",["mixInEventEmitter"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=true,i=a.navigator.connection,j={0:'unknown',1:'ethernet',2:'wifi',3:'2g',4:'3g'};function k(){return h;}function l(q){if(q==h)return;h=q;p.emit(q?'online':'offline');}function m(){return i?i.bandwidth:(h?Infinity:0);}function n(){return i?i.metered:false;}function o(){var q=i?String(i.type):'0';return j[q]||q;}var p={getBandwidth:m,getType:o,isMetered:n,isOnline:k,setOnline:l};g(p,{online:true,offline:true});if(a.addEventListener){a.addEventListener('online',l.bind(null,true));a.addEventListener('offline',l.bind(null,false));}else if(a.attachEvent){a.attachEvent('online',l.bind(null,true));a.attachEvent('offline',l.bind(null,false));}e.exports=p;},null);
__d("FileHasher",["WebWorker","fileSliceName","emptyFunction","FileHashWorkerResource"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();j.isSupported=function(){"use strict";return g.isSupported();};function j(){"use strict";var k=b('FileHashWorkerResource');g.prepareResource(k);this.$FileHasher0=new g(k).setMessageHandler(function(l){this.$FileHasher1(l);}.bind(this)).execute();}j.prototype.hash=function(k,l){"use strict";this.$FileHasher1=l;this.$FileHasher0.postMessage({file:k,fileSliceName:h});return this;};j.prototype.destroy=function(){"use strict";this.$FileHasher1=i;this.$FileHasher0.terminate();};e.exports=j;},null);
__d("XGroupSellNUXMarkAsSeenController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/groups\/sell\/_nuxMarkAsSeen\/",{tooltip_seen:{type:"Bool",defaultValue:false}});},null);
__d("GroupSellNUX",["Arbiter","AsyncRequest","Event","GroupSellLogger","SubscriptionsHandler","XGroupSellNUXMarkAsSeenController"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();function m(o){var p=(l.getURIBuilder()).setBool('tooltip_seen',true).getURI();(new h(p)).send();j.logComposerTooltipNUXSeen(o);}var n={markToolTipAsSeen:function(o,p,q){var r=new k();r.addSubscriptions(i.listen(o,'click',function(){p.hide();m(q);}),g.subscribe('GroupSellComposer/launchedComposer',function(){if(p.isShown())p.hide();m(q);}),g.subscribe('page_transition',function(){r.release();if(p.isShown())p.hide();}));}};e.exports=n;},null);
__d("GroupYourPosts",["CSS","DOM","Event"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j={setupShowMorePosts:function(k,l){var m=i.listen(k,'click',function(){m.remove();h.remove(k);l.forEach(function(n){g.show(n);});});}};e.exports=j;},null);
__d("ComposerPhotoSorter",["Arbiter","CSS","DOM","Rect","SortableGroup","arrayContains"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m={init:function(n){this._container=n;this._reset();var o=this._update.bind(this);g.subscribe('multi-upload/images-added/'+n.id,o);g.subscribe('multi-upload/image-removed/'+n.id,o);},_reset:function(){this._ids=[];this._sortableGroup=new k();h.removeClass(this._container,'fbVaultPhotoSorter');},_update:function(){var n=i.scry(this._container,'.fbVaultGridItem').filter(function(o){return !h.hasClass(o,'fbVaultEditableGridMoreLink');});if(n.length<2){if(this._ids.length>1){this._sortableGroup.destroy();this._reset();}return;}h.addClass(this._container,'fbVaultPhotoSorter');n.forEach(function(o){var p=i.scry(o,'input[type="hidden"]')[0];if(p&&!l(this._ids,p.value)){this._ids.push(p.value);this._sortableGroup.addSortable(p.value,o);}}.bind(this));this._sortableGroup.setBoundingBox(new j(this._container));}};e.exports=m;},null);
__d("VaultGridUploadItem",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(h){"use strict";this.$VaultGridUploadItem0=h;}g.prototype.getUploadInput=function(){"use strict";return this.$VaultGridUploadItem0;};e.exports=g;},null);
__d("VideoUploadLogger",["Banzai","copyProperties"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(j){this._source=j.source;this._waterfallID=j.waterfall_id;this._targetID=j.target_id;this._delay=j.delay;this._times=[];this._isChunkedUpload=j.is_chunked_upload;}h(i,{BANZAI_GK:'videos',BANZAI_ROUTE:'video_waterfall',SOURCE_SIMPLE:'simple',SOURCE_COMPOSER:'composer',EVENT_STARTED_FLOW:'upload.client.started_flow',EVENT_FINISHED_FLOW:'upload.client.finished_flow',EVENT_FAILED_FLOW:'upload.client.failed_flow',EVENT_CANCELED_FLOW:'upload.client.canceled_flow',EVENT_RESIGNED_FLOW:'upload.client.resigned_flow',EVENT_REQUESTED_UPLOADING:'upload.client.requested_uploading',EVENT_INVALIDATED_UPLOADING:'upload.client.invalidated_uploading',EVENT_STARTED_UPLOADING:'upload.client.started_uploading',EVENT_PROGRESS_UPLOADING_START_REQUEST:'upload.client.progress_uploading_start_request',EVENT_FINISHED_UPLOADING:'upload.client.finished_uploading',EVENT_CANCELED_UPLOADING:'upload.client.canceled_uploading',EVENT_ABANDONED_UPLOADING:'upload.client.abandoned_uploading',EVENT_FAILED_UPLOADING:'upload.client.failed_uploading',EVENT_STARTED_SENDING_BYTES:'upload.client.started_sending_bytes',EVENT_FINISHED_SENDING_BYTES:'upload.client.finished_sending_bytes',EVENT_CANCELED_SENDING_BYTES:'upload.client.canceled_sending_bytes',EVENT_FAILED_SENDING_BYTES:'upload.client.failed_sending_bytes',EVENT_STARTED_SENDING_CHUNK_BYTES:'upload.client.started_sending_chunk_bytes',EVENT_FINISHED_SENDING_CHUNK_BYTES:'upload.client.finished_sending_chunk_bytes',EVENT_CANCELED_SENDING_CHUNK_BYTES:'upload.client.canceled_sending_chunk_bytes',EVENT_FAILED_SENDING_CHUNK_BYTES:'upload.client.failed_sending_chunk_bytes',EVENT_TIMEOUT_SENDING_CHUNK_BYTES:'upload.client.timeout_sending_chunk_bytes',EVENT_ENCODING_START_OBSERVED:'encode.client.encoding_start_observed',EVENT_ENCODING_SUCCESS_OBSERVED:'encode.client.encoding_success_observed',EVENT_ENCODING_FAIL_OBSERVED:'encode.client.encoding_fail_observed',EVENT_RECEIVED_RESPONSE:'upload.client.received_response'});h(i.prototype,{logEvent:function(event,j){var k=h({},j);if(k.elapsed_time==null)if(event.indexOf('started')!==-1){this._times[event]=Date.now();}else if(event.indexOf('finished')!==-1){k.elapsed_time=this._computeElapsedTime(event,'finished');}else if(event.indexOf('canceled')!==-1){k.elapsed_time=this._computeElapsedTime(event,'canceled');}else if(event.indexOf('failed')!==-1)k.elapsed_time=this._computeElapsedTime(event,'failed');k.event=event;k.source=this._source;k.waterfall_id=this._waterfallID;k.target_id=this._targetID;k.is_chunked_upload=this._isChunkedUpload;g.post(i.BANZAI_ROUTE,k,{delay:this._delay});},_computeElapsedTime:function(event,j){var k=event.replace(j,'started'),l=this._times[k];return l?Date.now()-l:null;}});e.exports=i;},null);
__d("VideoUploadFileValidator",["ErrorDialog","JSXDOM","fbt"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(k){"use strict";this.$VideoUploadFileValidator0=k;}j.prototype.validate=function(k,l){"use strict";return this.$VideoUploadFileValidator1(k)&&this.$VideoUploadFileValidator2(k)&&this.$VideoUploadFileValidator3(l);};j.prototype.$VideoUploadFileValidator1=function(k){"use strict";if(!this.$VideoUploadFileValidator0.extensions[k.getExtension()]){var l="http://www.facebook.com/help/"+"?faq=218673814818907#What-formats-of-video-files-can-I-upload?",m=h.a({href:l},i._("recommended formats"));g.show(i._("Formato de archivo no compatible"),i._("Sorry, the file you selected is in a format that we don't support. Please use one of our {link} for video files.",[i.param("link",m)]));return false;}return true;};j.prototype.$VideoUploadFileValidator2=function(k){"use strict";if(k.getSize()===null)return true;if(k.getSize()<this.$VideoUploadFileValidator0.minSize){var l=h.strong(null,i._("{kilobytes} KB",[i.param("kilobytes",Math.round(this.$VideoUploadFileValidator0.minSize/1024))]));g.show(i._("El archivo de video es demasiado peque\u00f1o"),i._("The video file you tried to upload is too small. The minimum size for a video file is {min-size}. Please try again with a larger file.",[i.param("min-size",l)]));return false;}if(k.getSize()>this.$VideoUploadFileValidator0.maxSize){var m=h.strong(null,i._("{max-size} MB",[i.param("max-size",Math.round(this.$VideoUploadFileValidator0.maxSize/1024/1024))]));g.show(i._("El archivo de video es demasiado grande"),i._("The video file you tried to upload is too large. The maximum size for a video file is {max-size}. Please try again with a smaller file.",[i.param("max-size",m)]));return false;}return true;};j.prototype.$VideoUploadFileValidator3=function(k){"use strict";if(!k)return true;var l=k.format.duration;if(l>this.$VideoUploadFileValidator0.maxLength){g.show(i._("La duraci\u00f3n del video es demasiada larga"),i._("The duration of the video you tried to upload is too long. The maximum duration for a video is {max-length} minutes. Please upload a shorter video.",[i.param("max-length",Math.round(this.$VideoUploadFileValidator0.maxLength/60))]));return false;}if(l<this.$VideoUploadFileValidator0.minLength){g.show(i._("Archivo de Video Demasiado Corto"),i._("La duraci\u00f3n del video que intentaste subir es demasiado corta. La extensi\u00f3n m\u00ednima para un video es {min-length} minutos. Por favor, sube un video m\u00e1s largo.",[i.param("min-length",Math.round(this.$VideoUploadFileValidator0.minLength/60))]));return false;}if(!k.streams.primaryVideo&&k.streams.primaryAudio){var m="http://www.facebook.com/help/"+"?faq=218673814818907#What-formats-of-video-files-can-I-upload?",n=h.a({href:m},i._("supported video format"));g.show(i._("No Video Detected"),i._("It looks like you're trying to upload a file that isn't a video. Please try uploading a {supported-video-format link}",[i.param("supported-video-format link",n)]));return false;}if(k.streams.primaryVideo.width<this.$VideoUploadFileValidator0.minWidth){g.show(i._("Video Width Too Narrow"),i._("La anchura del video para subirlo es demasiado corta. La minima anchura para un video es {min-width}. por favor sube un video m\u00e1s amplio.",[i.param("min-width",this.$VideoUploadFileValidator0.minWidth)]));return false;}if(k.streams.primaryVideo.height<this.$VideoUploadFileValidator0.minHeight){g.show(i._("Video Height Too Short"),i._("El peso del video que intentaste subir es muy liviano. El peso m\u00ednimo para un video es {min-height}. Por favor sube un video m\u00e1s pesado.",[i.param("min-height",this.$VideoUploadFileValidator0.minHeight)]));return false;}return true;};e.exports=j;},null);
__d("VideoUploadProgressBar",["CSS","VideoUploadFeatureDetector","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(k){"use strict";this.$VideoUploadProgressBar0=k.progress_bar;this.$VideoUploadProgressBar1=k.throbber;this.$VideoUploadProgressBar2=k.uploader;this.$VideoUploadProgressBar3=k.start_margin;this.$VideoUploadProgressBar4=k.start_delay;this.$VideoUploadProgressBar5=k.end_margin;this.$VideoUploadProgressBar6=k.end_delay;this.$VideoUploadProgressBar7=k.progress_bar_label;this.$VideoUploadProgressBar8();}j.prototype.reset=function(){"use strict";this.$VideoUploadProgressBar0.setPosition(0);};j.computeProgress=function(k,l,m,n,o){"use strict";var p=Math.min(k+l,m);return (p)/m*(100-n-o)+n;};j.prototype.$VideoUploadProgressBar8=function(){"use strict";if(h.supportsFileAPI()){this.$VideoUploadProgressBar2.subscribe('upload-requested',this.$VideoUploadProgressBar9.bind(this));this.$VideoUploadProgressBar2.subscribe('upload-progressed',this.$VideoUploadProgressBara.bind(this));this.$VideoUploadProgressBar2.subscribe('online',this.$VideoUploadProgressBarb.bind(this));this.$VideoUploadProgressBar2.subscribe('offline',this.$VideoUploadProgressBarc.bind(this));}else this.$VideoUploadProgressBar2.subscribe('upload-requested',this.$VideoUploadProgressBard.bind(this));};j.prototype.$VideoUploadProgressBar9=function(event){"use strict";g.show(this.$VideoUploadProgressBar0.getRoot());g.removeClass(this.$VideoUploadProgressBar0.getRoot(),"_5r5a");this.$VideoUploadProgressBar0.setTarget(this.$VideoUploadProgressBar3,this.$VideoUploadProgressBar4);this.$VideoUploadProgressBare(0);};j.prototype.$VideoUploadProgressBare=function(k){"use strict";if(this.$VideoUploadProgressBar7)this.$VideoUploadProgressBar0.changeLabel(''+k.toFixed(1)+'%');};j.prototype.$VideoUploadProgressBara=function(event,k){"use strict";g.removeClass(this.$VideoUploadProgressBar0.getRoot(),"_5r5a");var l=j.computeProgress(k.start_offset,k.sent_bytes,k.file_size,this.$VideoUploadProgressBar3,this.$VideoUploadProgressBar5);this.$VideoUploadProgressBar0.setPosition(l);this.$VideoUploadProgressBare(l);if(l>=100-this.$VideoUploadProgressBar5){this.$VideoUploadProgressBar0.setTarget(100,this.$VideoUploadProgressBar6);this.$VideoUploadProgressBare(100);}};j.prototype.$VideoUploadProgressBarb=function(event){"use strict";g.removeClass(this.$VideoUploadProgressBar0.getRoot(),"_5r5a");};j.prototype.$VideoUploadProgressBarc=function(event){"use strict";g.addClass(this.$VideoUploadProgressBar0.getRoot(),"_5r5a");};j.prototype.$VideoUploadProgressBard=function(event){"use strict";g.show(this.$VideoUploadProgressBar1);};e.exports=j;},null);
__d("VideoUploadRequest",["AsyncRequest","DOM","DTSG","FileForm","Form","VideoUploadFeatureDetector","copyProperties","emptyFunction","submitForm"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p='video';function q(r){"use strict";this.$VideoUploadRequest0=r;this.$VideoUploadRequest1=null;this.$VideoUploadRequest2=false;this.$VideoUploadRequest3=null;this.$VideoUploadRequest4=null;this.$VideoUploadRequest5=null;this.$VideoUploadRequest6=n;this.$VideoUploadRequest7=n;this.$VideoUploadRequest8=n;this.$VideoUploadRequest9=n;this.$VideoUploadRequesta=null;}q.prototype.setAllowCrossOrigin=function(r){"use strict";this.$VideoUploadRequest2=r;return this;};q.prototype.setData=function(r){"use strict";this.$VideoUploadRequest3=r;return this;};q.prototype.setWaterfallID=function(r){"use strict";this.$VideoUploadRequest4=r;return this;};q.prototype.setSuccessHandler=function(r){"use strict";this.$VideoUploadRequest6=r;return this;};q.prototype.setErrorHandler=function(r){"use strict";this.$VideoUploadRequest7=r;return this;};q.prototype.setTransportErrorHandler=function(r){"use strict";this.$VideoUploadRequest8=r;return this;};q.prototype.setUploadProgressHandler=function(r){"use strict";this.$VideoUploadRequest9=r;return this;};q.prototype.setTimeoutHandler=function(r,s){"use strict";this.$VideoUploadRequest5=r;this.$VideoUploadRequesta=s;return this;};q.prototype.send=function(){"use strict";if(this.$VideoUploadRequest1)throw new Error('An upload request is already in progress.');if(l.supportsXHR()){this.$VideoUploadRequest1=this.$VideoUploadRequestb();this.$VideoUploadRequest1.send();}else{this.$VideoUploadRequest1=this.$VideoUploadRequestc();this.$VideoUploadRequestd(this.$VideoUploadRequest1);}};q.prototype.sendChunk=function(r){"use strict";if(this.$VideoUploadRequest1)throw new Error('An upload request is already in progress.');var s=new FormData();s.append('video_file_chunk',r);this.$VideoUploadRequest1=this.$VideoUploadRequestb();this.$VideoUploadRequest1.setRawData(s);this.$VideoUploadRequest1.send();};q.prototype.sendFile=function(r){"use strict";if(this.$VideoUploadRequest1)throw new Error('An upload request is already in progress.');this.$VideoUploadRequest1=this.$VideoUploadRequestc();var s=r.cloneNode(false);r.name=p;h.replace(r,s);h.appendContent(this.$VideoUploadRequest1.getRoot(),r);this.$VideoUploadRequestd(this.$VideoUploadRequest1);r.name=s.name;h.replace(s,r);};q.prototype.abort=function(){"use strict";if(!this.$VideoUploadRequest1)throw new Error('There is no upload request in progress.');this.$VideoUploadRequest1.abort();this.$VideoUploadRequest1=null;};q.prototype.$VideoUploadRequestb=function(){"use strict";var r=this.__getAsyncRequest().setAllowCrossOrigin(this.$VideoUploadRequest2).setURI(this.$VideoUploadRequest0).setData(this.$VideoUploadRequest3).setRequestHeader('X_FB_VIDEO_WATERFALL_ID',this.$VideoUploadRequest4).setHandler(this.$VideoUploadRequest6).setErrorHandler(this.$VideoUploadRequest7).setTransportErrorHandler(this.$VideoUploadRequest8).setUploadProgressHandler(this.$VideoUploadRequest9);if(this.$VideoUploadRequesta)r.setTimeoutHandler(this.$VideoUploadRequest5,this.$VideoUploadRequesta);return r;};q.prototype.__getAsyncRequest=function(){"use strict";return new g();};q.prototype.$VideoUploadRequestc=function(){"use strict";var r=h.create('form',{action:this.$VideoUploadRequest0,method:'POST'});k.createHiddenInputs(m({fb_dtsg:i.getToken()},this.$VideoUploadRequest3),r);var s=new j(r,null,{allowCrossOrigin:this.$VideoUploadRequest2});s.subscribe('success',this.$VideoUploadRequeste.bind(this));s.subscribe('failure',this.$VideoUploadRequestf.bind(this));s.subscribe('progress',this.$VideoUploadRequestg.bind(this));return s;};q.prototype.$VideoUploadRequestd=function(r){"use strict";h.appendContent(document.body,r.getRoot());o(r.getRoot());};q.prototype.$VideoUploadRequeste=function(event,r){"use strict";this.$VideoUploadRequest6(r.response);};q.prototype.$VideoUploadRequestf=function(event,r){"use strict";this.$VideoUploadRequest7(r.response);};q.prototype.$VideoUploadRequestg=function(event,r){"use strict";this.$VideoUploadRequest9(r.event);};e.exports=q;},null);
__d("VideoUploadRequestContext",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();function g(){"use strict";this.reset();}g.prototype.setFile=function(h){"use strict";this.$VideoUploadRequestContext0=h;return this;};g.prototype.getFile=function(){"use strict";return this.$VideoUploadRequestContext0;};g.prototype.setMetadata=function(h){"use strict";this.$VideoUploadRequestContext1=h;return this;};g.prototype.getMetadata=function(){"use strict";return this.$VideoUploadRequestContext1;};g.prototype.setVideoID=function(h){"use strict";this.$VideoUploadRequestContext2=h;return this;};g.prototype.getVideoID=function(){"use strict";return this.$VideoUploadRequestContext2;};g.prototype.setStartOffset=function(h){"use strict";this.$VideoUploadRequestContext3=h;return this;};g.prototype.getStartOffset=function(){"use strict";return this.$VideoUploadRequestContext3;};g.prototype.setEndOffset=function(h){"use strict";this.$VideoUploadRequestContext4=h;return this;};g.prototype.getEndOffset=function(){"use strict";return this.$VideoUploadRequestContext4;};g.prototype.setPartitionStartOffset=function(h){"use strict";this.$VideoUploadRequestContext5=h;return this;};g.prototype.getPartitionStartOffset=function(){"use strict";return this.$VideoUploadRequestContext5;};g.prototype.setPartitionEndOffset=function(h){"use strict";this.$VideoUploadRequestContext6=h;return this;};g.prototype.getPartitionEndOffset=function(){"use strict";return this.$VideoUploadRequestContext6;};g.prototype.setTargetID=function(h){"use strict";this.$VideoUploadRequestContext7=h;return this;};g.prototype.getTargetID=function(){"use strict";return this.$VideoUploadRequestContext7;};g.prototype.setSource=function(h){"use strict";this.$VideoUploadRequestContext8=h;return this;};g.prototype.getSource=function(){"use strict";return this.$VideoUploadRequestContext8;};g.prototype.setWaterfallID=function(h){"use strict";this.$VideoUploadRequestContext9=h;return this;};g.prototype.getWaterfallID=function(){"use strict";return this.$VideoUploadRequestContext9;};g.prototype.setSupportsChunking=function(h){"use strict";this.$VideoUploadRequestContexta=h;return this;};g.prototype.getSupportsChunking=function(){"use strict";return this.$VideoUploadRequestContexta;};g.prototype.setSupportsFileAPI=function(h){"use strict";this.$VideoUploadRequestContextb=h;return this;};g.prototype.getSupportsFileAPI=function(){"use strict";return this.$VideoUploadRequestContextb;};g.prototype.reset=function(){"use strict";this.$VideoUploadRequestContext0=null;this.$VideoUploadRequestContext2=null;this.$VideoUploadRequestContext3=null;this.$VideoUploadRequestContext4=null;this.$VideoUploadRequestContext7=null;this.$VideoUploadRequestContext8=null;this.$VideoUploadRequestContext9=null;this.$VideoUploadRequestContexta=null;this.$VideoUploadRequestContextb=null;this.$VideoUploadRequestContext5=null;this.$VideoUploadRequestContext6=null;};e.exports=g;},null);
__d("VideoUploadPostRequestManager",["ArbiterMixin","VideoUploadRequest","copyProperties","mixin"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=j(g);for(var l in k)if(k.hasOwnProperty(l))n[l]=k[l];var m=k===null?null:k.prototype;n.prototype=Object.create(m);n.prototype.constructor=n;n.__superConstructor__=k;function n(o){"use strict";this.$VideoUploadPostRequestManager0=o;}n.prototype.getRequest=function(){"use strict";return this.$VideoUploadPostRequestManager1;};n.prototype.sendRequest=function(o){"use strict";if(this.$VideoUploadPostRequestManager1)return;var p=i(o.getMetadata(),this.__createRequestData(o));this.$VideoUploadPostRequestManager1=this.__getVideoUploadRequest(this.$VideoUploadPostRequestManager0).setAllowCrossOrigin(true).setData(p).setWaterfallID(o.getWaterfallID()).setSuccessHandler(this.$VideoUploadPostRequestManager2.bind(this)).setErrorHandler(this.$VideoUploadPostRequestManager3.bind(this)).setTransportErrorHandler(this.$VideoUploadPostRequestManager3.bind(this));this.$VideoUploadPostRequestManager1.send();this.inform('request-started');};n.prototype.__createRequestData=function(o){"use strict";return {video_id:o.getVideoID(),target_id:o.getTargetID(),source:o.getSource(),waterfall_id:o.getWaterfallID(),supports_chunking:o.getSupportsChunking()};};n.prototype.__getVideoUploadRequest=function(o){"use strict";return new h(o);};n.prototype.clearRequest=function(){"use strict";this.$VideoUploadPostRequestManager1=null;};n.prototype.isInProgress=function(){"use strict";return !!this.$VideoUploadPostRequestManager1;};n.prototype.$VideoUploadPostRequestManager2=function(o){"use strict";this.inform('request-finished',{video_id:o.getPayload().video_id});this.clearRequest();};n.prototype.$VideoUploadPostRequestManager3=function(o){"use strict";this.inform('request-failed',{error_code:o.getError(),error_description:o.getErrorDescription(),error_summary:o.getErrorSummary()});this.clearRequest();};e.exports=n;},null);
__d("VideoUploadConnectionMonitor",["ArbiterMixin","Network","VideoUploadFeatureDetector","debounce","mixin"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=k(g);for(var m in l)if(l.hasOwnProperty(m))o[m]=l[m];var n=l===null?null:l.prototype;o.prototype=Object.create(n);o.prototype.constructor=o;o.__superConstructor__=l;function o(){"use strict";this.$VideoUploadConnectionMonitor0=false;this.$VideoUploadConnectionMonitor1=[];this.$VideoUploadConnectionMonitor2=false;this.$VideoUploadConnectionMonitor3=true;this.$VideoUploadConnectionMonitor4=j(function(){this.$VideoUploadConnectionMonitor5(false);}.bind(this),2000);}o.prototype.notifyStart=function(){"use strict";if(this.$VideoUploadConnectionMonitor2)return;if(this.$VideoUploadConnectionMonitor1.length===0){this.$VideoUploadConnectionMonitor1.push(h.addListener('online',function(){this.$VideoUploadConnectionMonitor5(true);}.bind(this)));this.$VideoUploadConnectionMonitor1.push(h.addListener('offline',function(){if(this.$VideoUploadConnectionMonitor0){this.$VideoUploadConnectionMonitor4();}else{this.$VideoUploadConnectionMonitor4.reset();setTimeout(this.$VideoUploadConnectionMonitor4,2000);}}.bind(this)));}this.$VideoUploadConnectionMonitor2=true;};o.prototype.notifyProgress=function(event){"use strict";if(!this.$VideoUploadConnectionMonitor2)return;if(!event)return;if(i.supportsFullProgress()){this.$VideoUploadConnectionMonitor0=true;if(event.total&&event.loaded===event.total){this.$VideoUploadConnectionMonitor4.reset();}else this.$VideoUploadConnectionMonitor4();}};o.prototype.notifySuccess=function(){"use strict";if(!this.$VideoUploadConnectionMonitor2)return;this.reset();this.$VideoUploadConnectionMonitor5(true);};o.prototype.notifyTransportError=function(){"use strict";if(!this.$VideoUploadConnectionMonitor2)return;this.$VideoUploadConnectionMonitor2=false;this.$VideoUploadConnectionMonitor5(false);};o.prototype.notifyError=function(){"use strict";if(!this.$VideoUploadConnectionMonitor2)return;this.reset();this.$VideoUploadConnectionMonitor5(true);};o.prototype.isOnline=function(){"use strict";return this.$VideoUploadConnectionMonitor3;};o.prototype.reset=function(){"use strict";while(this.$VideoUploadConnectionMonitor1.length)this.$VideoUploadConnectionMonitor1.pop().remove();this.$VideoUploadConnectionMonitor4.reset();this.$VideoUploadConnectionMonitor2=false;};o.prototype.$VideoUploadConnectionMonitor5=function(p){"use strict";this.$VideoUploadConnectionMonitor4.reset();if(this.$VideoUploadConnectionMonitor3!==p){this.$VideoUploadConnectionMonitor3=p;if(this.$VideoUploadConnectionMonitor3){this.inform('online');}else this.inform('offline');}};e.exports=o;},null);
__d("VideoUploadReceiveRequestManager",["ArbiterMixin","VideoUploadConnectionMonitor","VideoUploadRequest","mixin","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=1363037,m=j(g);for(var n in m)if(m.hasOwnProperty(n))p[n]=m[n];var o=m===null?null:m.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=m;function p(q,r,s,t,u,v,w,x,y){"use strict";this.$VideoUploadReceiveRequestManager0=q;this.$VideoUploadReceiveRequestManager1=r;this.$VideoUploadReceiveRequestManager2=s;this.$VideoUploadReceiveRequestManager3=t;this.$VideoUploadReceiveRequestManager4=u;this.$VideoUploadReceiveRequestManager5=v;this.$VideoUploadReceiveRequestManager6=w;this.$VideoUploadReceiveRequestManager7=x;this.$VideoUploadReceiveRequestManager8=y;this.$VideoUploadReceiveRequestManager9=0;this.$VideoUploadReceiveRequestManagera=0;this.$VideoUploadReceiveRequestManagerb=0;this.$VideoUploadReceiveRequestManagerc=null;this.$VideoUploadReceiveRequestManagerd=null;this.$VideoUploadReceiveRequestManagere=0;this.$VideoUploadReceiveRequestManagerf=new h();this.$VideoUploadReceiveRequestManagerf.subscribe('online',this.$VideoUploadReceiveRequestManagerg.bind(this));this.$VideoUploadReceiveRequestManagerf.subscribe('offline',this.$VideoUploadReceiveRequestManagerh.bind(this));}p.prototype.sendRequest=function(q){"use strict";if(this.$VideoUploadReceiveRequestManageri)return;this.$VideoUploadReceiveRequestManagere=q.getEndOffset()-q.getStartOffset();this.$VideoUploadReceiveRequestManagerj=q;this.$VideoUploadReceiveRequestManagerk();};p.prototype.cancelRequest=function(){"use strict";if(!this.$VideoUploadReceiveRequestManageri)return;this.$VideoUploadReceiveRequestManageri.abort();this.$VideoUploadReceiveRequestManagerl();};p.prototype.$VideoUploadReceiveRequestManagerl=function(){"use strict";this.$VideoUploadReceiveRequestManageri=null;this.$VideoUploadReceiveRequestManagerm=null;this.$VideoUploadReceiveRequestManager9=0;this.$VideoUploadReceiveRequestManagera=0;this.$VideoUploadReceiveRequestManagerb=0;this.$VideoUploadReceiveRequestManagerc=null;this.$VideoUploadReceiveRequestManagerd=null;this.$VideoUploadReceiveRequestManagere=0;this.$VideoUploadReceiveRequestManagerj.reset();this.$VideoUploadReceiveRequestManagerf.reset();clearTimeout(this.$VideoUploadReceiveRequestManagern);this.$VideoUploadReceiveRequestManagern=null;};p.prototype.$VideoUploadReceiveRequestManagerk=function(q){"use strict";clearTimeout(this.$VideoUploadReceiveRequestManagern);this.$VideoUploadReceiveRequestManagern=null;if(this.$VideoUploadReceiveRequestManagerj.getSupportsChunking()&&(this.$VideoUploadReceiveRequestManagerj.getStartOffset()>=this.$VideoUploadReceiveRequestManagerj.getPartitionEndOffset())){if(!q)this.inform('request-finished',{start_offset:this.$VideoUploadReceiveRequestManagerj.getEndOffset()-1,end_offset:this.$VideoUploadReceiveRequestManagerj.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager9,server_retries:this.$VideoUploadReceiveRequestManagera,upload_speed:this.$VideoUploadReceiveRequestManagerd});return;}this.$VideoUploadReceiveRequestManageri=this.__getVideoUploadRequest(this.$VideoUploadReceiveRequestManager0).setAllowCrossOrigin(true).setData(this.__createRequestData(this.$VideoUploadReceiveRequestManagerj)).setWaterfallID(this.$VideoUploadReceiveRequestManagerj.getWaterfallID()).setSuccessHandler(this.__handleSuccessResponse.bind(this)).setErrorHandler(this.__handleServerFailureResponse.bind(this)).setTransportErrorHandler(this.$VideoUploadReceiveRequestManagero.bind(this)).setUploadProgressHandler(this.$VideoUploadReceiveRequestManagerp.bind(this));this.$VideoUploadReceiveRequestManagerc=Date.now();if(this.$VideoUploadReceiveRequestManagerj.getSupportsChunking()){if(this.$VideoUploadReceiveRequestManager3){var r=this.$VideoUploadReceiveRequestManagerq(this.$VideoUploadReceiveRequestManagerj.getEndOffset()-this.$VideoUploadReceiveRequestManagerj.getStartOffset(),this.$VideoUploadReceiveRequestManagerd);this.$VideoUploadReceiveRequestManageri.setTimeoutHandler(r,this.__handleResponseTimeout.bind(this));}this.$VideoUploadReceiveRequestManageri.sendChunk(this.$VideoUploadReceiveRequestManagerr());}else this.$VideoUploadReceiveRequestManageri.sendFile(this.$VideoUploadReceiveRequestManagerj.getFile().getFileInput());this.$VideoUploadReceiveRequestManagerf.notifyStart();this.inform('request-started',{start_offset:this.$VideoUploadReceiveRequestManagerj.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManagerj.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager9,server_retries:this.$VideoUploadReceiveRequestManagera,upload_speed:this.$VideoUploadReceiveRequestManagerd});};p.prototype.__getVideoUploadRequest=function(q){"use strict";return new i(q);};p.prototype.$VideoUploadReceiveRequestManagers=function(q){"use strict";clearTimeout(this.$VideoUploadReceiveRequestManagern);this.$VideoUploadReceiveRequestManagern=setTimeout(this.$VideoUploadReceiveRequestManagerk.bind(this),q);};p.prototype.$VideoUploadReceiveRequestManagerr=function(){"use strict";if(this.$VideoUploadReceiveRequestManagerm)return this.$VideoUploadReceiveRequestManagerm;this.$VideoUploadReceiveRequestManagerm=this.$VideoUploadReceiveRequestManagerj.getFile().getChunk(this.$VideoUploadReceiveRequestManagerj.getStartOffset(),this.$VideoUploadReceiveRequestManagerj.getEndOffset());return this.$VideoUploadReceiveRequestManagerm;};p.prototype.__createRequestData=function(q){"use strict";return {video_id:q.getVideoID(),start_offset:q.getStartOffset(),source:q.getSource(),target_id:q.getTargetID(),waterfall_id:q.getWaterfallID(),supports_chunking:q.getSupportsChunking(),upload_speed:this.$VideoUploadReceiveRequestManagerd,partition_start_offset:q.getPartitionStartOffset(),partition_end_offset:q.getPartitionEndOffset()};};p.prototype.__handleSuccessResponse=function(q){"use strict";var r=Date.now()-this.$VideoUploadReceiveRequestManagerc;r=(r===0)?1:r;var s=q.getPayload();if(s.start_offset===this.$VideoUploadReceiveRequestManagerj.getEndOffset()){var t=this.$VideoUploadReceiveRequestManagerj.getEndOffset()-this.$VideoUploadReceiveRequestManagerj.getStartOffset();this.$VideoUploadReceiveRequestManagerd=Math.floor(t/r);}else this.$VideoUploadReceiveRequestManagerd=null;this.$VideoUploadReceiveRequestManagerf.notifySuccess();this.inform('request-finished',{start_offset:this.$VideoUploadReceiveRequestManagerj.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManagerj.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager9,server_retries:this.$VideoUploadReceiveRequestManagera,upload_speed:this.$VideoUploadReceiveRequestManagerd});this.$VideoUploadReceiveRequestManagerj.setStartOffset(s.start_offset);this.$VideoUploadReceiveRequestManagerj.setEndOffset(s.end_offset);this.$VideoUploadReceiveRequestManageri=null;this.$VideoUploadReceiveRequestManagerm=null;this.$VideoUploadReceiveRequestManager9=0;this.$VideoUploadReceiveRequestManagera=0;this.$VideoUploadReceiveRequestManagerb=0;if(this.$VideoUploadReceiveRequestManagerj.getSupportsChunking())this.$VideoUploadReceiveRequestManagerk(true);};p.prototype.__handleServerFailureResponse=function(q){"use strict";this.$VideoUploadReceiveRequestManageri=null;this.$VideoUploadReceiveRequestManager9=0;this.$VideoUploadReceiveRequestManagerd=null;this.$VideoUploadReceiveRequestManagerb=0;this.$VideoUploadReceiveRequestManagerf.notifyError();if(this.__hasInvalidStartOffsetAndHasRetries(q.getError())){var r=q.getPayload();if(this.$VideoUploadReceiveRequestManagerj.getStartOffset()!=r.start_offset||this.$VideoUploadReceiveRequestManagerj.getEndOffset()!=r.end_offset){this.$VideoUploadReceiveRequestManagerj.setStartOffset(r.start_offset);this.$VideoUploadReceiveRequestManagerj.setEndOffset(r.end_offset);this.$VideoUploadReceiveRequestManagerm=null;}this.$VideoUploadReceiveRequestManagerk();}else if((q.isTransient()||this.$VideoUploadReceiveRequestManager8)&&++this.$VideoUploadReceiveRequestManagera<=this.$VideoUploadReceiveRequestManager2){this.$VideoUploadReceiveRequestManagers(this.$VideoUploadReceiveRequestManagert(this.$VideoUploadReceiveRequestManager7,this.$VideoUploadReceiveRequestManagera));}else this.$VideoUploadReceiveRequestManageru(q);};p.prototype.__handleResponseTimeout=function(q){"use strict";this.inform('request-timeout',{start_offset:this.$VideoUploadReceiveRequestManagerj.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManagerj.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager9,server_retries:this.$VideoUploadReceiveRequestManagera,timeout_retries:this.$VideoUploadReceiveRequestManagerb,upload_speed:this.$VideoUploadReceiveRequestManagerd});this.$VideoUploadReceiveRequestManageri.abort();this.$VideoUploadReceiveRequestManageri=null;this.$VideoUploadReceiveRequestManagerd=null;this.$VideoUploadReceiveRequestManagerf.notifyTransportError();if(++this.$VideoUploadReceiveRequestManagerb<=this.$VideoUploadReceiveRequestManager4){var r=this.$VideoUploadReceiveRequestManagerj.getEndOffset()-this.$VideoUploadReceiveRequestManagerj.getStartOffset();r=Math.floor(r/2);r=Math.max(r,this.$VideoUploadReceiveRequestManagere);var s=this.$VideoUploadReceiveRequestManagerj.getEndOffset();s=Math.min(s,this.$VideoUploadReceiveRequestManagerj.getStartOffset()+r);this.$VideoUploadReceiveRequestManagerj.setEndOffset(s);this.$VideoUploadReceiveRequestManagerm=null;this.$VideoUploadReceiveRequestManagerk();}else this.$VideoUploadReceiveRequestManagerv({error_code:1006,error_description:k._("Parece que tu navegador est\u00e1 desconectado. Comprueba la conexi\u00f3n de internet y vuelve a intentarlo."),error_summary:k._("No hay conexi\u00f3n de red")});};p.prototype.__hasInvalidStartOffsetAndHasRetries=function(q){"use strict";return q===l&&++this.$VideoUploadReceiveRequestManagera<=this.$VideoUploadReceiveRequestManager2;};p.prototype.$VideoUploadReceiveRequestManagero=function(q){"use strict";this.$VideoUploadReceiveRequestManagerf.notifyTransportError();this.$VideoUploadReceiveRequestManagerd=null;this.$VideoUploadReceiveRequestManagerb=0;if(++this.$VideoUploadReceiveRequestManager9<=this.$VideoUploadReceiveRequestManager1){this.$VideoUploadReceiveRequestManageri=null;this.$VideoUploadReceiveRequestManagers(this.$VideoUploadReceiveRequestManagert(this.$VideoUploadReceiveRequestManager6,this.$VideoUploadReceiveRequestManager9));}else this.$VideoUploadReceiveRequestManageru(q);};p.prototype.$VideoUploadReceiveRequestManageru=function(q){"use strict";this.$VideoUploadReceiveRequestManagerv({error_code:q.getError(),error_description:q.getErrorDescription(),error_summary:q.getErrorSummary()});};p.prototype.$VideoUploadReceiveRequestManagerv=function(q){"use strict";this.inform('request-failed',q);this.$VideoUploadReceiveRequestManagerl();};p.prototype.$VideoUploadReceiveRequestManagerp=function(event){"use strict";this.$VideoUploadReceiveRequestManagerf.notifyProgress(event);this.inform('request-progressed',{file_size:this.$VideoUploadReceiveRequestManagerj.getFile().getSize(),start_offset:this.$VideoUploadReceiveRequestManagerj.getStartOffset(),sent_bytes:event.loaded});};p.prototype.$VideoUploadReceiveRequestManagerg=function(event){"use strict";this.inform('online');this.$VideoUploadReceiveRequestManager9=0;this.$VideoUploadReceiveRequestManagerb=0;if(this.$VideoUploadReceiveRequestManagern)this.$VideoUploadReceiveRequestManagerk();};p.prototype.$VideoUploadReceiveRequestManagerh=function(event){"use strict";this.inform('offline');};p.prototype.$VideoUploadReceiveRequestManagert=function(q,r){"use strict";return Math.pow(q,r)*1000;};p.prototype.$VideoUploadReceiveRequestManagerq=function(q,r){"use strict";var s;if(r>0){s=r;}else s=10;var t=Math.floor((q/s)*this.$VideoUploadReceiveRequestManager5/100);return Math.max(t,30000);};e.exports=p;},null);
__d("VideoUploadStartRequestManager",["ArbiterMixin","VideoUploadRequest","FileHasher","performanceNow","mixin","Assert"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=k(g);for(var n in m)if(m.hasOwnProperty(n))p[n]=m[n];var o=m===null?null:m.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=m;function p(q,r,s,t,u){"use strict";this.$VideoUploadStartRequestManager0=q;this.$VideoUploadStartRequestManager1=r;this.$VideoUploadStartRequestManager2=s;this.$VideoUploadStartRequestManager3=0;this.$VideoUploadStartRequestManager4=t;this.$VideoUploadStartRequestManager5=u;}p.prototype.getRequest=function(){"use strict";return this.$VideoUploadStartRequestManager6;};p.prototype.sendRequest=function(q){"use strict";if(this.$VideoUploadStartRequestManager7||this.$VideoUploadStartRequestManager6)return;this.$VideoUploadStartRequestManager8=q;if(this.$VideoUploadStartRequestManager4&&this.$VideoUploadStartRequestManager8.getFile().getFile()&&(this.$VideoUploadStartRequestManager8.getFile().getFile().size<this.$VideoUploadStartRequestManager5)&&i.isSupported()){this.$VideoUploadStartRequestManager9=j();this.$VideoUploadStartRequestManager7=new i();this.$VideoUploadStartRequestManager7.hash(this.$VideoUploadStartRequestManager8.getFile().getFile(),function(r){this.$VideoUploadStartRequestManager9=j()-this.$VideoUploadStartRequestManager9;this.$VideoUploadStartRequestManagera=r.hash;this.$VideoUploadStartRequestManager7.destroy();this.$VideoUploadStartRequestManager7=null;if(!r.hash)this.$VideoUploadStartRequestManagerb=r.exception;this.$VideoUploadStartRequestManagerc();}.bind(this));}else this.$VideoUploadStartRequestManagerc();};p.prototype.$VideoUploadStartRequestManagerc=function(){"use strict";this.$VideoUploadStartRequestManagerd();this.inform('request-started',{hash_time:this.$VideoUploadStartRequestManager9,hash_exception:this.$VideoUploadStartRequestManagerb});};p.prototype.$VideoUploadStartRequestManagerd=function(){"use strict";clearTimeout(this.$VideoUploadStartRequestManagere);this.$VideoUploadStartRequestManagere=null;this.$VideoUploadStartRequestManager6=this.__getVideoUploadRequest(this.$VideoUploadStartRequestManager0).setAllowCrossOrigin(true).setData(this.__getDataToSend(this.$VideoUploadStartRequestManager8,this.$VideoUploadStartRequestManagera)).setWaterfallID(this.$VideoUploadStartRequestManager8.getWaterfallID()).setSuccessHandler(this.$VideoUploadStartRequestManagerf.bind(this)).setErrorHandler(this.$VideoUploadStartRequestManagerg.bind(this)).setTransportErrorHandler(this.$VideoUploadStartRequestManagerh.bind(this));this.$VideoUploadStartRequestManager6.send();};p.prototype.__getVideoUploadRequest=function(q){"use strict";return new h(q);};p.prototype.__getDataToSend=function(q,r){"use strict";return {file_size:q.getFile().getSize(),file_extension:q.getFile().getExtension(),target_id:q.getTargetID(),source:q.getSource(),waterfall_id:q.getWaterfallID(),supports_chunking:q.getSupportsChunking(),supports_file_api:q.getSupportsFileAPI(),partition_start_offset:q.getPartitionStartOffset(),partition_end_offset:q.getPartitionEndOffset(),original_file_hash:r};};p.prototype.cancelRequest=function(){"use strict";this.$VideoUploadStartRequestManageri();};p.prototype.$VideoUploadStartRequestManagerj=function(q){"use strict";clearTimeout(this.$VideoUploadStartRequestManagere);this.$VideoUploadStartRequestManagere=setTimeout(this.$VideoUploadStartRequestManagerd.bind(this),q);};p.prototype.$VideoUploadStartRequestManageri=function(){"use strict";if(this.$VideoUploadStartRequestManager7){this.$VideoUploadStartRequestManager7.destroy();this.$VideoUploadStartRequestManager7=null;}if(this.$VideoUploadStartRequestManager6){this.$VideoUploadStartRequestManager6.abort();this.$VideoUploadStartRequestManager6=null;}this.$VideoUploadStartRequestManager3=0;this.$VideoUploadStartRequestManager8=null;clearTimeout(this.$VideoUploadStartRequestManagere);this.$VideoUploadStartRequestManagere=null;};p.prototype.$VideoUploadStartRequestManagerk=function(q,r){"use strict";return Math.pow(q,r)*1000;};p.prototype.$VideoUploadStartRequestManagerf=function(q){"use strict";var r=q.getPayload();this.inform('request-finished',this.__getSuccessInformData(r));this.$VideoUploadStartRequestManager6=null;l.isTrue(this.$VideoUploadStartRequestManager7==null,'Unexpected: if file hasher is not null, clean up is required.');};p.prototype.__getSuccessInformData=function(q){"use strict";return {video_id:q.video_id,start_offset:q.start_offset,end_offset:q.end_offset,transport_retries:this.$VideoUploadStartRequestManager3,skip_upload:q.skip_upload,hash_time:this.$VideoUploadStartRequestManager9};};p.prototype.$VideoUploadStartRequestManagerg=function(q){"use strict";this.inform('request-failed',this.$VideoUploadStartRequestManagerl(q));this.$VideoUploadStartRequestManager6=null;l.isTrue(this.$VideoUploadStartRequestManager7==null,'Unexpected: if file hasher is not null, clean up is required.');};p.prototype.$VideoUploadStartRequestManagerh=function(q){"use strict";if((this.$VideoUploadStartRequestManager1===0)||(++this.$VideoUploadStartRequestManager3>this.$VideoUploadStartRequestManager1)){this.$VideoUploadStartRequestManagerg(q);}else{this.$VideoUploadStartRequestManager6=null;this.$VideoUploadStartRequestManagerj(this.$VideoUploadStartRequestManagerk(this.$VideoUploadStartRequestManager2,this.$VideoUploadStartRequestManager3));}};p.prototype.$VideoUploadStartRequestManagerl=function(q){"use strict";return {error_code:q.getError(),error_description:q.getErrorDescription(),error_summary:q.getErrorSummary(),transport_retries:this.$VideoUploadStartRequestManager3};};e.exports=p;},null);
__d("VideoUploadMetadataParser",["VideoUploadFeatureDetector","fileSlice"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=4,j=4,k=5242880,l=24,m=88,n=20,o=16,p=4,q=84;function r(s,t){"use strict";this.$VideoUploadMetadataParser0=s;this.$VideoUploadMetadataParser1=t;}r.prototype.getHandler=function(){"use strict";return this.$VideoUploadMetadataParser1;};r.prototype.parse=function(){"use strict";if(!g.supportsFileReading()){this.$VideoUploadMetadataParser1(null);return;}switch(this.$VideoUploadMetadataParser0.getExtension()){case 'mp4':case 'mov':case 'm4v':case '3gp':case '3g2':break;default:this.$VideoUploadMetadataParser1(null);return;}this.$VideoUploadMetadataParser2(0,Math.min(k,this.$VideoUploadMetadataParser0.getSize()),null);};r.prototype.$VideoUploadMetadataParser2=function(s,t,u){"use strict";var v=new FileReader();v.onload=(function(event){try{var y=this.$VideoUploadMetadataParser3(new DataView(v.result),0,t-s,s,u);if(y.completed){y=this.$VideoUploadMetadataParser4(y);this.$VideoUploadMetadataParser1(y);}else this.$VideoUploadMetadataParser2(s+y.nextOffset,Math.min(this.$VideoUploadMetadataParser0.getSize(),s+y.nextOffset+k),y);}catch(x){this.$VideoUploadMetadataParser1(null);}}.bind(this));var w=this.$VideoUploadMetadataParser0.getFile();v.readAsArrayBuffer(h.call(w,s,t));};r.prototype.$VideoUploadMetadataParser5=function(s,t,u){"use strict";var v=[];for(var w=0;w<u;w++)v.push(String.fromCharCode(s.getUint8(t+w)));return v.join('');};r.prototype.$VideoUploadMetadataParser3=function(s,t,u,v,w){"use strict";if(!w)w={widths:[],heights:[],streamTypes:[],streamDurations:[]};while(t<u){var x=s.getUint32(t),y=this.$VideoUploadMetadataParser5(s,t+i,j);if(t+x>u){w.completed=false;w.nextOffset=t;if(x>u)w.nextOffset+=x;return w;}if(t+v===0&&y!=='ftyp')throw new Error('No ftyp atom');if(x===0)throw new Error('len is 0');var z=function(){var da=s.getUint32(t+n),ea=s.getUint32(t+l);return ea/da;};switch(y){case 'moov':case 'trak':case 'mdia':t+=i+j;break;case 'mvhd':w.duration=z();t+=x;break;case 'tkhd':var aa=s.getUint16(t+q),ba=s.getUint16(t+m);w.widths.push(aa);w.heights.push(ba);t+=x;break;case 'hdlr':var ca=this.$VideoUploadMetadataParser5(s,t+o,p);switch(ca){case 'vide':ca='video';break;case 'soun':ca='audio';break;case 'subt':ca='subtitle';break;default:ca='data';}w.streamTypes.push(ca);t+=x;break;case 'mdhd':w.streamDurations.push(z());t+=x;break;default:t+=x;}}w.completed=true;return w;};r.prototype.$VideoUploadMetadataParser4=function(s){"use strict";var t={streams:{},format:{}},u=s.widths.length,v=s.heights.length,w=s.streamTypes.length,x=s.streamDurations.length;if(u!==v||u!==w||u!==x)return null;for(var y=0;y<u;y++){var z={width:s.widths[y],height:s.heights[y],duration:s.streamDurations[y],type:s.streamTypes[y]};if(z.type==='video'){var aa=z.width*z.height,ba=t.streams.primaryVideo;if(!ba||(ba.width*ba.height)>aa)t.streams.primaryVideo=z;}else if(z.type==='audio'){var ca=t.streams.primaryAudio;if(!ca||ca.duration<z.duration)t.streams.primaryAudio=z;}}t.format.duration=s.duration;return t;};e.exports=r;},null);
__d("VideoUploadSession",["ArbiterMixin","AsyncRequest","VideoUploadFeatureDetector","VideoUploadFile","VideoUploadFileValidator","VideoUploadLogger","VideoUploadMetadataParser","VideoUploadPostRequestManager","VideoUploadReceiveRequestManager","VideoUploadRequestContext","VideoUploadStartRequestManager","WaterfallIDGenerator","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();var t=s(g);for(var u in t)if(t.hasOwnProperty(u))w[u]=t[u];var v=t===null?null:t.prototype;w.prototype=Object.create(v);w.prototype.constructor=w;w.__superConstructor__=t;function w(x){"use strict";this.$VideoUploadSession0=x.source;this.$VideoUploadSession1=x.target_id;this.$VideoUploadSession2=x.logging_delay;this.$VideoUploadSession3=new k({minSize:x.min_size,maxSize:x.max_size,minLength:x.min_length,maxLength:x.max_length,minWidth:x.min_width,minHeight:x.min_height,extensions:x.extensions});this.$VideoUploadSession4=i.supportsChunking();this.$VideoUploadSession5=i.supportsFileAPI();if(this.$VideoUploadSession4){this.$VideoUploadSession6=x.parallel_chunk_uploads;if(this.$VideoUploadSession6){this.$VideoUploadSession7=x.parallel_chunk_upload_filesize;this.$VideoUploadSession8=x.default_chunk_size;}}else this.$VideoUploadSession6=false;this.$VideoUploadSession9=this.$VideoUploadSessiona(x);this.$VideoUploadSessionb=this.$VideoUploadSessionc(x);if(this.$VideoUploadSession6)this.$VideoUploadSessiond=this.$VideoUploadSessionc(x);this.$VideoUploadSessione=this.$VideoUploadSessionf(x);}w.prototype.start=function(x){"use strict";this.$VideoUploadSessiong=null;this.$VideoUploadSessionh=false;this.$VideoUploadSessioni=r.generate();this.$VideoUploadSessionj=new j(x);this.$VideoUploadSessionk=new l({source:this.$VideoUploadSession0,waterfall_id:this.$VideoUploadSessioni,target_id:this.$VideoUploadSession1,delay:this.$VideoUploadSession2,is_chunked_upload:this.$VideoUploadSession4});this.__logEvent(l.EVENT_REQUESTED_UPLOADING);this.inform('upload-requested');var y=new m(this.$VideoUploadSessionj,this.$VideoUploadSessionl.bind(this));y.parse();};w.prototype.post=function(x){"use strict";var y=this.__createPostRequestContext(x);this.$VideoUploadSessione.sendRequest(y);};w.prototype.__createPostRequestContext=function(x){"use strict";var y=new p();this.__setupPostRequestContext(y,x);return y;};w.prototype.__setupPostRequestContext=function(x,y){"use strict";x.setMetadata(y).setVideoID(this.$VideoUploadSessiong).setTargetID(this.$VideoUploadSession1).setSource(this.$VideoUploadSession0).setWaterfallID(this.$VideoUploadSessioni).setSupportsChunking(this.$VideoUploadSession4).setFile(this.$VideoUploadSessionj);};w.prototype.cancel=function(){"use strict";if(!this.$VideoUploadSessionh)return;this.$VideoUploadSessionm();this.__logEvent(l.EVENT_CANCELED_UPLOADING);this.__logEvent(l.EVENT_CANCELED_FLOW);};w.prototype.abandon=function(){"use strict";if(!this.$VideoUploadSessionh)return;this.$VideoUploadSessionm();this.__logEvent(l.EVENT_ABANDONED_UPLOADING);this.__logEvent(l.EVENT_FAILED_FLOW);};w.prototype.isPostInProgress=function(){"use strict";return this.$VideoUploadSessione.isInProgress();};w.prototype.isInProgress=function(){"use strict";return this.$VideoUploadSessionh;};w.prototype.getVideoID=function(){"use strict";return this.$VideoUploadSessiong;};w.prototype.getUploadTime=function(){"use strict";return this.$VideoUploadSessionn;};w.prototype.$VideoUploadSessionl=function(x){"use strict";if(!this.$VideoUploadSession3.validate(this.$VideoUploadSessionj,x)){this.__logEvent(l.EVENT_INVALIDATED_UPLOADING);this.inform('upload-failed');return;}this.__logEvent(l.EVENT_STARTED_FLOW);this.$VideoUploadSessiono=this.$VideoUploadSession6&&(this.$VideoUploadSessionj.getSize()>=this.$VideoUploadSession7);this.$VideoUploadSessionp=false;this.$VideoUploadSessionq=false;this.$VideoUploadSessionr=0;this.$VideoUploadSessions=this.$VideoUploadSessionr;this.$VideoUploadSessiont=0;if(this.$VideoUploadSessiono){this.$VideoUploadSessionu=Math.floor(this.$VideoUploadSessionj.getSize()/2);this.$VideoUploadSessionv=this.$VideoUploadSessionu;this.$VideoUploadSessionw=this.$VideoUploadSessionv;this.$VideoUploadSessionx=0;this.$VideoUploadSessiony=this.$VideoUploadSessionj.getSize();}else this.$VideoUploadSessionu=this.$VideoUploadSessionj.getSize();var y=new p().setFile(this.$VideoUploadSessionj).setTargetID(this.$VideoUploadSession1).setSource(this.$VideoUploadSession0).setWaterfallID(this.$VideoUploadSessioni).setSupportsChunking(this.$VideoUploadSession4).setSupportsFileAPI(this.$VideoUploadSession5).setPartitionStartOffset(this.$VideoUploadSessionr).setPartitionEndOffset(this.$VideoUploadSessionu);this.$VideoUploadSessionh=true;this.$VideoUploadSession9.sendRequest(y);};w.prototype.$VideoUploadSessiona=function(x){"use strict";var y=this.$VideoUploadSession4?x.chunk_start_uri:x.start_uri,z=this.__getVideoUploadStartRequestManager(y,x.start_max_transport_retries,x.start_transport_retry_interval_base,x.skip_upload_enabled,x.skip_upload_file_size_limit);z.subscribe('request-started',this.$VideoUploadSessionz.bind(this));z.subscribe('request-finished',this.$VideoUploadSessionA.bind(this));z.subscribe('request-failed',this.$VideoUploadSessionB.bind(this));return z;};w.prototype.$VideoUploadSessionc=function(x){"use strict";var y=this.$VideoUploadSession4?x.chunk_receive_uri:x.receive_uri,z=this.__getVideoUploadReceiveRequestManager(y,x);z.subscribe('request-started',this.$VideoUploadSessionC.bind(this));z.subscribe('request-progressed',this.$VideoUploadSessionD.bind(this));z.subscribe('request-finished',this.$VideoUploadSessionE.bind(this));z.subscribe('request-failed',this.$VideoUploadSessionF.bind(this));z.subscribe('request-timeout',this.$VideoUploadSessionG.bind(this));z.subscribe('online',this.$VideoUploadSessionH.bind(this));z.subscribe('offline',this.$VideoUploadSessionI.bind(this));return z;};w.prototype.$VideoUploadSessionf=function(x){"use strict";var y=this.$VideoUploadSession4?x.chunk_post_uri:x.post_uri,z=this.__getVideoUploadPostRequestManager(y);z.subscribe('request-finished',this.__handlePostRequestFinished.bind(this));z.subscribe('request-failed',this.$VideoUploadSessionJ.bind(this));return z;};w.prototype.$VideoUploadSessionz=function(event,x){"use strict";this.__logEvent(l.EVENT_STARTED_UPLOADING,{hash_time:x.hash_time,hash_exception:x.hash_exception});this.$VideoUploadSessionK=Date.now();this.inform('upload-started');};w.prototype.$VideoUploadSessionA=function(event,x){"use strict";this.__logEvent(l.EVENT_PROGRESS_UPLOADING_START_REQUEST,{transport_retries:x.transport_retries,hash_time:x.hash_time,skip_upload:(x.skip_upload)?1:null});this.$VideoUploadSessiong=x.video_id;this.$VideoUploadSessionL=x.skip_upload;if(!x.skip_upload){var y;y=this.__createReceiveRequestContext(x,false);this.$VideoUploadSessionb.sendRequest(y);if(this.$VideoUploadSessiono){y=this.__createReceiveRequestContext(x,true);this.$VideoUploadSessiond.sendRequest(y);}}else{this.inform('upload-progressed',{start_offset:0,end_offset:this.$VideoUploadSessionj.getSize()});this.inform('upload-finished',{start_offset:0,end_offset:this.$VideoUploadSessionj.getSize()});}};w.prototype.__createReceiveRequestContext=function(x,y){"use strict";if(!y)y=false;var z=new p();this.__setupReceiveRequestContext(z,x,y);return z;};w.prototype.__setupReceiveRequestContext=function(x,y,z){"use strict";var aa,ba,ca,da;if(!z){aa=this.$VideoUploadSessionr;ba=this.$VideoUploadSessionu;ca=y.start_offset;da=y.end_offset;}else{aa=this.$VideoUploadSessionv;ba=this.$VideoUploadSessiony;ca=this.$VideoUploadSessionv;da=((this.$VideoUploadSessionv+this.$VideoUploadSession8)>=this.$VideoUploadSessiony)?this.$VideoUploadSessiony:(this.$VideoUploadSessionv+this.$VideoUploadSession8);}x.setFile(this.$VideoUploadSessionj).setVideoID(y.video_id).setStartOffset(ca).setEndOffset(da).setPartitionStartOffset(aa).setPartitionEndOffset(ba).setTargetID(this.$VideoUploadSession1).setSource(this.$VideoUploadSession0).setWaterfallID(this.$VideoUploadSessioni).setSupportsChunking(this.$VideoUploadSession4);};w.prototype.$VideoUploadSessionB=function(event,x){"use strict";this.__logEvent(l.EVENT_FAILED_UPLOADING,{error_code:x.error_code,error_description:x.error_description,transport_retries:x.transport_retries});this.__logEvent(l.EVENT_RESIGNED_FLOW);this.$VideoUploadSessionh=false;this.inform('upload-failed',x);};w.prototype.$VideoUploadSessionC=function(event,x){"use strict";if(!x.start_offset&&!x.transport_retries&&!x.server_retries)this.__logEvent(l.EVENT_STARTED_SENDING_BYTES,{total_bytes:this.$VideoUploadSessionj.getSize()});if(this.$VideoUploadSession4)this.__logEvent(l.EVENT_STARTED_SENDING_CHUNK_BYTES,{start_offset:x.start_offset,total_bytes:x.end_offset-x.start_offset,transport_retries:x.transport_retries,server_retries:x.server_retries,upload_speed:x.upload_speed});};w.prototype.$VideoUploadSessionD=function(event,x){"use strict";if(x.start_offset<this.$VideoUploadSessionu){this.$VideoUploadSessions=x.start_offset;this.$VideoUploadSessiont=x.sent_bytes;}else{this.$VideoUploadSessionw=x.start_offset;this.$VideoUploadSessionx=x.sent_bytes;}x.start_offset=this.$VideoUploadSessions;x.sent_bytes=this.$VideoUploadSessiont;if(this.$VideoUploadSessiono){x.start_offset+=(this.$VideoUploadSessionw-this.$VideoUploadSessionv);x.sent_bytes+=this.$VideoUploadSessionx;}this.inform('upload-progressed',x);};w.prototype.$VideoUploadSessionE=function(event,x){"use strict";if(this.$VideoUploadSession4)this.__logEvent(l.EVENT_FINISHED_SENDING_CHUNK_BYTES,{start_offset:x.start_offset,sent_bytes:x.end_offset-x.start_offset,transport_retries:x.transport_retries,server_retries:x.server_retries,upload_speed:x.upload_speed});if(x.start_offset<this.$VideoUploadSessionu){this.$VideoUploadSessionp=(x.end_offset>=this.$VideoUploadSessionu);}else this.$VideoUploadSessionq=(x.end_offset>=this.$VideoUploadSessiony);if(!this.$VideoUploadSession5||(this.$VideoUploadSessionp&&(!this.$VideoUploadSessiono||this.$VideoUploadSessionq))){this.__logEvent(l.EVENT_FINISHED_SENDING_BYTES,{sent_bytes:this.$VideoUploadSessionj.getSize()});this.$VideoUploadSessionn=Date.now()-this.$VideoUploadSessionK;this.inform('upload-finished',x);}};w.prototype.$VideoUploadSessionF=function(event,x){"use strict";this.__logEvent(l.EVENT_FAILED_UPLOADING,{error_code:x.error_code,error_description:x.error_description});this.__logEvent(l.EVENT_RESIGNED_FLOW);this.$VideoUploadSessionh=false;this.inform('upload-failed',x);};w.prototype.$VideoUploadSessionG=function(event,x){"use strict";this.__logEvent(l.EVENT_TIMEOUT_SENDING_CHUNK_BYTES,{start_offset:x.start_offset,sent_bytes:x.end_offset-x.start_offset,transport_retries:x.transport_retries,server_retries:x.server_retries,timeout_retries:x.timeout_retries,upload_speed:x.upload_speed});};w.prototype.$VideoUploadSessionH=function(event,x){"use strict";this.inform('online',x);};w.prototype.$VideoUploadSessionI=function(event,x){"use strict";this.inform('offline',x);};w.prototype.__handlePostRequestFinished=function(event,x){"use strict";if(!x.video_id)x.video_id=this.$VideoUploadSessiong;this.__logEvent(l.EVENT_FINISHED_UPLOADING,{elapsed_time:this.$VideoUploadSessionn,skip_upload:(this.$VideoUploadSessionL)?1:null});this.__logEvent(l.EVENT_FINISHED_FLOW);this.$VideoUploadSessionh=false;this.inform('post-finished',x);};w.prototype.$VideoUploadSessionJ=function(event,x){"use strict";if(this.$VideoUploadSessionh){this.__logEvent(l.EVENT_FAILED_UPLOADING,{error_code:x.error_code,error_description:x.error_description});this.__logEvent(l.EVENT_RESIGNED_FLOW);}this.$VideoUploadSessionh=false;this.inform('post-failed',x);};w.prototype.$VideoUploadSessionm=function(){"use strict";this.$VideoUploadSession9.cancelRequest();this.$VideoUploadSessionb.cancelRequest();if(this.$VideoUploadSessiono)this.$VideoUploadSessiond.cancelRequest();if(this.$VideoUploadSessiong){new h('/ajax/video/actions/delete').setData({fbid:this.$VideoUploadSessiong,redirect:false}).send();this.$VideoUploadSessiong=null;}};w.prototype.__logEvent=function(event,x){"use strict";if(!this.$VideoUploadSessionk)return;x=x||{};if(this.$VideoUploadSessionj){x.file_size=this.$VideoUploadSessionj.getSize();x.file_extension=this.$VideoUploadSessionj.getExtension();}this.$VideoUploadSessionk.logEvent(event,x);};w.prototype.__getVideoUploadStartRequestManager=function(x,y,z,aa,ba){"use strict";return new q(x,y,z,aa,ba);};w.prototype.__getVideoUploadReceiveRequestManager=function(x,y){"use strict";return new o(x,y.max_transport_retries,y.max_server_retries,y.response_timeout_enabled,y.max_response_timeout_retries,y.response_timeout_speed_variation_factor_ppt,y.transport_retry_interval_base,y.server_retry_interval_base,y.receive_errors_force_retry);};w.prototype.__getVideoUploadPostRequestManager=function(x){"use strict";return new n(x);};e.exports=w;},null);
__d("VideoUploader",["ArbiterMixin","VideoUploadSession","arrayContains","mixin"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=j(g);for(var l in k)if(k.hasOwnProperty(l))n[l]=k[l];var m=k===null?null:k.prototype;n.prototype=Object.create(m);n.prototype.constructor=n;n.__superConstructor__=k;function n(o){"use strict";this.$VideoUploader0=o;this.$VideoUploader1=null;}n.prototype.upload=function(o){"use strict";if(this.$VideoUploader1)return;this.$VideoUploader1=this.__getVideoUploadSession(this.$VideoUploader0);this.$VideoUploader1.subscribe(this.__getEventsWhichShouldListenFromSession(),function(event,p){return this.$VideoUploader2(event,p);}.bind(this));this.$VideoUploader1.start(o);};n.prototype.__getVideoUploadSession=function(o){"use strict";return new h(o);};n.prototype.__getEventsWhichShouldListenFromSession=function(){"use strict";return ['upload-requested','upload-started','upload-progressed','upload-finished','upload-failed','post-finished','post-failed','online','offline'];};n.prototype.post=function(o){"use strict";if(!this.$VideoUploader1)return;this.$VideoUploader1.post(o);};n.prototype.cancel=function(){"use strict";if(!this.$VideoUploader1)return;this.$VideoUploader1.cancel();this.$VideoUploader1=null;};n.prototype.abandon=function(){"use strict";if(!this.$VideoUploader1)return;this.$VideoUploader1.abandon();this.$VideoUploader1=null;};n.prototype.reset=function(){"use strict";this.$VideoUploader1=null;};n.prototype.getUploadSession=function(){"use strict";return this.$VideoUploader1;};n.prototype.isPostInProgress=function(){"use strict";return !!this.$VideoUploader1&&this.$VideoUploader1.isPostInProgress();};n.prototype.isSessionInProgress=function(){"use strict";return !!this.$VideoUploader1&&this.$VideoUploader1.isInProgress();};n.prototype.__getSession=function(){"use strict";return this.$VideoUploader1;};n.prototype.__getEventsForWhichSessionShouldBeSetToNull=function(){"use strict";return ['upload-failed','post-finished'];};n.prototype.$VideoUploader2=function(event,o){"use strict";if(i(this.__getEventsForWhichSessionShouldBeSetToNull(),event))this.$VideoUploader1=null;this.__delegateEvent(event,o);};n.prototype.__delegateEvent=function(event,o){"use strict";this.inform(event,o);};e.exports=n;},null);